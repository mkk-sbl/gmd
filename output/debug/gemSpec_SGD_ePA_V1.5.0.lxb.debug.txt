
   =========================
   LXB SERIALIZER DEBUG MODE
   =========================


DOCUMENT _DOCUMENT
  HTML (&93834802601928)
    HEAD (&93834802602112)
      text " "
      STYLE (&93834802602416)
        text "#toc_container {    background: #f9f9f9 none repeat scroll 0 0;    border: 1px solid #aaa;    display: table;    font-size: 95%;    margin-bottom: 1em;    padding: 20px;    width: 100%;}.toc_title {    font-weight: 700;    text-align: center;}#toc_container li, #toc_container ul, #toc_container ul li{    list-style: outside none none !important;}body {  font-family: Arial, Helvetica, sans-serif;  font-size: 14px;}/* ol {  list-style-type: none;  Remove default numbering}ol > li:before {  counter-increment: mycounter;  content: counter(mycounter) ". ";}ol:first-of-type {  counter-reset: mycounter;} */@media print { h1, h2 { break-before: page; } }"
      text " "
      META (&93834802602848)
        attr charset "utf-8"
      text " "
    text " "
    BODY (&93834802603448)
      text " "
      P (&93834802603752)
        attr id "polarion_1"
        text " "
        BR (&93834802604232)
        text " "
      text " "
      P (&93834802604656)
        attr id "polarion_3"
        text " "
        BR (&93834802605136)
        text " "
      text " "
      P (&93834802605560)
        attr id "polarion_4"
        text " "
        BR (&93834802606040)
        text " "
      text " "
      P (&93834802606464)
        attr id "polarion_5"
        text " "
        BR (&93834802606944)
        text " "
      text " "
      P (&93834802607368)
        attr id "polarion_6"
        text " "
        SPAN (&93834802607848)
          attr style "font-weight: bold;text-decoration: underline;font-size: 12pt;line-height: 1.5;"
          text "Elektronische Gesundheitskarte und Telematikinfrastruktur"
        text " "
      text " "
      P (&93834802608568)
        attr id "polarion_7"
        text " "
        BR (&93834802609048)
        text " "
      text " "
      P (&93834802609472)
        attr id "polarion_8"
        text " "
        BR (&93834802609952)
        text " "
      text " "
      P (&93834802610376)
        attr id "polarion_9"
        text " "
        BR (&93834802610856)
        text " "
      text " "
      P (&93834802611280)
        attr id "polarion_10"
        text " "
        BR (&93834802611760)
        text " "
      text " "
      P (&93834802612184)
        attr id "polarion_11"
        attr style "text-align: center;"
        text " "
        SPAN (&93834802612840)
          attr style "font-weight: bold;font-size: 28pt;line-height: 1.2;"
          text "Spezifikation"
        text " "
      text " "
      P (&93834802613560)
        attr id "polarion_12"
        attr style "text-align: center;"
        text " "
        SPAN (&93834802614216)
          attr style "font-weight: bold;font-size: 28pt;line-height: 1.2;"
          text "Schlüsselgenerierungsdienst"
        text " "
      text " "
      P (&93834802614936)
        attr id "polarion_129"
        attr style "text-align: center;"
        text " "
        SPAN (&93834802615592)
          attr style "font-weight: bold;font-size: 28pt;line-height: 1.2;"
          text "ePA"
        text " "
      text " "
      P (&93834802616312)
        attr id "polarion_13"
        text " "
        BR (&93834802616792)
        text " "
      text " "
      P (&93834802617216)
        attr id "polarion_14"
        text " "
        BR (&93834802617696)
        text " "
      text " "
      P (&93834802618120)
        attr id "polarion_15"
        text " "
        BR (&93834802618600)
        text " "
      text " "
      DIV (&93834802619024)
        attr class "polarion-dle-wiki-block"
        attr id "polarion_editor_html_block1"
        text " "
        DIV (&93834802619680)
          attr contenteditable "false"
          attr id "polarion_editor_html_block_content"
        text " "
        PRE (&93834802620336)
          attr class "polarion-dle-wiki-block-source"
          attr contenteditable "false"
          attr id "polarion_editor_html_block_source"
          text " "
          TABLE (&93834802621168)
            text " "
            TBODY (&93834802621472)
              TR (&93834802621656)
                text " "
                TD (&93834802621960)
                  text "Version"
                text " "
                TD (&93834802622384)
                  text "1.5.0"
                text " "
              text " "
              TR (&93834802622928)
                text " "
                TD (&93834802623232)
                  text "Revision"
                text " "
                TD (&93834802623656)
                  text "593404"
                text " "
              text " "
              TR (&93834802624200)
                text " "
                TD (&93834802624504)
                  text "Stand"
                text " "
                TD (&93834802624928)
                  text "31.01.2022"
                text " "
              text " "
              TR (&93834802625472)
                text " "
                TD (&93834802625776)
                  text "Status"
                text " "
                TD (&93834802626200)
                  text "freigegeben"
                text " "
              text " "
              TR (&93834802626744)
                text " "
                TD (&93834802627048)
                  text "Klassifizierung"
                text " "
                TD (&93834802627472)
                  text "öffentlich"
                text " "
              text " "
              TR (&93834802628016)
                text " "
                TD (&93834802628320)
                  text "Referenzierung"
                text " "
                TD (&93834802628744)
                  text "gemSpec_SGD_ePA"
                text " "
              text " "
        text " "
      text " "
      P (&93834802629528)
        attr id "polarion_16"
        text " "
        BR (&93834802630008)
        text " "
      text " "
      H1 (&93834802630432)
        attr id "polarion_wiki macro name=module-workitem;params=id=HighspeedKonnektorPTV1110-2543"
        text "Dokumentinformationen"
      text " "
      P (&93834802631032)
        attr id "polarion_21"
        text " "
        SPAN (&93834802631512)
          attr style "font-weight: bold;"
          text "Änderungen zur Vorversion"
        text " "
      text " "
      P (&93834802632232)
        attr id "polarion_22"
        text "Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen."
      text " "
      P (&93834802632832)
        attr id "polarion_23"
        text " "
        SPAN (&93834802633312)
          attr style "font-style: italic;color: #0000FF;"
          text " "
        text " "
      text " "
      P (&93834802634032)
        attr data-keep-next "true"
        attr id "polarion_24"
        text " "
        SPAN (&93834775007384)
          attr style "font-weight: bold;"
          text "Dokumentenhistorie"
        text " "
      text " "
      TABLE (&93834775008104)
        attr id "polarion_wiki macro name=table;params=width=99.87%|uid=1"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834775008760)
          text " "
          TR (&93834775009064)
            text " "
            TH (&93834775009368)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 53pt;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Version"
            text " "
            TH (&93834775009968)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 44pt;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Stand"
            text " "
            TH (&93834775010568)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 77pt;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Kap./Seite"
            text " "
            TH (&93834775011168)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 280pt;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Grund der Änderung, besondere Hinweise"
            text " "
            TH (&93834775011768)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 70pt;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Bearbeitung"
            text " "
          text " "
          TR (&93834775012488)
            text " "
            TD (&93834775012792)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "0.5.0"
            text " "
            TD (&93834775013392)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "15.03.19"
            text " "
            TD (&93834775013992)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775014472)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "initiale Erstellung"
            text " "
            TD (&93834775015072)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775015792)
            text " "
            TD (&93834775016096)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.0.0"
            text " "
            TD (&93834775016696)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "15.05.19"
            text " "
            TD (&93834775017296)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775017776)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "freigegeben"
            text " "
            TD (&93834775018376)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775019096)
            text " "
            TD (&93834775019400)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.1.0"
            text " "
            TD (&93834775020000)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "28.06.19"
            text " "
            TD (&93834775020600)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775021080)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Einarbeitung P19.1"
            text " "
            TD (&93834775021680)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775022400)
            text " "
            TD (&93834775022704)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.2.0"
            text " "
            TD (&93834775023304)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "02.10.19"
            text " "
            TD (&93834775023904)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775024384)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Einarbeitung P20.1"
            text " "
            TD (&93834775024984)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775025704)
            text " "
            TD (&93834775026008)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.3.0"
            text " "
            TD (&93834775026608)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "02.03.20"
            text " "
            TD (&93834775027208)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775027688)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Einarbeitung P21.1"
            text " "
            TD (&93834775028288)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775029008)
            text " "
            TD (&93834775029312)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.4.0"
            text " "
            TD (&93834775029912)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "22.06.20"
            text " "
            TD (&93834775030512)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775030992)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Einarbeitung P21.3"
            text " "
            TD (&93834775031592)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775032312)
            text " "
            TD (&93834775032616)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.4.1"
            text " "
            TD (&93834775033216)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "05.11.20"
            text " "
            TD (&93834775033816)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834775034296)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Einarbeitung P21.7"
            text " "
            TD (&93834775034896)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775035616)
            text " "
            TD (&93834775035920)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.4.2"
            text " "
            TD (&93834775036520)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "19.02.21"
            text " "
            TD (&93834775037120)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Kap. 8"
            text " "
            TD (&93834775037720)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "redaktionelle Anpassung"
            text " "
            TD (&93834775038320)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
          TR (&93834775039040)
            text " "
            TD (&93834775039344)
              attr style "vertical-align: top;width: 53pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "1.5.0"
            text " "
            TD (&93834775039944)
              attr style "vertical-align: top;width: 44pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "31.01.22"
            text " "
            TD (&93834803296160)
              attr style "vertical-align: top;width: 77pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834803296640)
              attr style "vertical-align: top;width: 280pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "Einarbeitung ePA_Maintenance_21.5"
            text " "
            TD (&93834803297240)
              attr style "vertical-align: top;width: 70pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              text "gematik"
            text " "
          text " "
        text " "
      text " "
      P (&93834803298200)
        attr id "polarion_26"
      text " "
      H1 (&93834803298680)
        attr id "polarion_wiki macro name=module-workitem;params=id=HighspeedKonnektorPTV1110-2544"
        text "Inhaltsverzeichnis"
      text " "
      DIV (&93834803299280)
        attr id "polarion_wiki macro name=toc"
      text " "
      DIV (&93834803299760)
        attr id "toc_container"
        text " "
        P (&93834803300240)
          attr class "toc_title"
        H1 (&93834803300600)
        P (&93834803300784)
        text " "
        LI (&93834803301088)
          A (&93834803301272)
            attr href "#polarion_wiki macro name=module-workitem;params=id=HighspeedKonnektorPTV1110-2543"
            text "Dokumentinformationen"
        text " "
        LI (&93834803301872)
          A (&93834803302056)
            attr href "#polarion_wiki macro name=module-workitem;params=id=HighspeedKonnektorPTV1110-2544"
            text "Inhaltsverzeichnis"
        text " "
        LI (&93834803302656)
          text ":"
          A (&93834803302960)
            attr href "#1"
            text "1 Einordnung des Dokuments"
        text " "
        LI (&93834803303560)
          text ": :"
          A (&93834803303864)
            attr href "#1.1"
            text "1.1 Zielsetzung"
        text " "
        LI (&93834803304464)
          text ": :"
          A (&93834803304768)
            attr href "#1.2"
            text "1.2 Zielgruppe"
        text " "
        LI (&93834803305368)
          text ": :"
          A (&93834803305672)
            attr href "#1.3"
            text "1.3 Geltungsbereich"
        text " "
        LI (&93834803306272)
          text ": :"
          A (&93834803306576)
            attr href "#1.4"
            text "1.4 Abgrenzungen"
        text " "
        LI (&93834803307176)
          text ": :"
          A (&93834803307480)
            attr href "#1.5"
            text "1.5 Methodik"
        text " "
        LI (&93834803308080)
          text ":"
          A (&93834803308384)
            attr href "#2"
            text "2 Überblick"
        text " "
        LI (&93834803308984)
          text ": :"
          A (&93834803309288)
            attr href "#2.1"
            text "2.1 Grundlage und Kernidee"
        text " "
        LI (&93834803309888)
          text ": :"
          A (&93834803310192)
            attr href "#2.2"
            text "2.2 Akteure und Komponenten"
        text " "
        LI (&93834803310792)
          text ": :"
          A (&93834803311096)
            attr href "#2.3"
            text "2.3 Basisablauf Kommunikation SGD-Client und SGD"
        text " "
        LI (&93834803311696)
          text ": :"
          A (&93834803312000)
            attr href "#2.4"
            text "2.4 Initiale Schlüsselableitung für den Kontoinhaber"
        text " "
        LI (&93834803312600)
          text ": :"
          A (&93834803312904)
            attr href "#2.5"
            text "2.5 Schlüsselableitung durch den Kontoinhaber"
        text " "
        LI (&93834803313504)
          text ": :"
          A (&93834803313808)
            attr href "#2.6"
            text "2.6 Schlüsselableitung für einen Berechtigungsempfänger"
        text " "
        LI (&93834803314408)
          text ": :"
          A (&93834803314712)
            attr href "#2.7"
            text "2.7 Schlüsselableitung durch einen Berechtigten"
        text " "
        LI (&93834803315312)
          text ": :"
          A (&93834803315616)
            attr href "#2.8"
            text "2.8 Schlüsselableitung für einen Berechtigungsempfänger durch einen Vertreter"
        text " "
        LI (&93834803316216)
          text ": :"
          A (&93834803316520)
            attr href "#2.9"
            text "2.9 Schlüsselableitung für einen durch einen Vertreter berechtigten Berechtigten"
        text " "
        LI (&93834803317120)
          text ": :"
          A (&93834803317424)
            attr href "#2.10"
            text "2.10 Nichtspeicherung von Versichertendaten"
        text " "
        LI (&93834803318024)
          text ": :"
          A (&93834803318328)
            attr href "#2.11"
            text "2.11 Besondere Rolle SGD-HSM"
        text " "
        LI (&93834803318928)
          text ":"
          A (&93834803319232)
            attr href "#3"
            text "3 Übergreifende Festlegungen"
        text " "
        LI (&93834803319832)
          text ": :"
          A (&93834803320136)
            attr href "#3.1"
            text "3.1 Beziehung zwischen ePA-Aktensystem und SGD"
        text " "
        LI (&93834803320736)
          text ": :"
          A (&93834803321040)
            attr href "#3.2"
            text "3.2 Verfügbarkeit und Performanz"
        text " "
        LI (&93834803321640)
          text ": :"
          A (&93834803321944)
            attr href "#3.3"
            text "3.3 Sichere Betreiberumgebung"
        text " "
        LI (&93834803322544)
          text ": :"
          A (&93834803322848)
            attr href "#3.4"
            text "3.4 Verschiedenes"
        text " "
        LI (&93834803323448)
          text ":"
          A (&93834803323752)
            attr href "#4"
            text "4 Bestandteile eines SGD"
        text " "
        LI (&93834803324352)
          text ": :"
          A (&93834803324656)
            attr href "#4.1"
            text "4.1 Request-Verarbeitung in einem SGD"
        text " "
        LI (&93834803325256)
          text ": : :"
          A (&93834803325560)
            attr href "#4.1.1"
            text "4.1.1 Routing auf die SGD-HSM"
        text " "
        LI (&93834803326160)
          text ": :"
          A (&93834803326464)
            attr href "#4.2"
            text "4.2 SGD-HSM"
        text " "
        LI (&93834803327064)
          text ": :"
          A (&93834803327368)
            attr href "#4.3"
            text "4.3 Schlüssel im SGD-HSM"
        text " "
        LI (&93834803327968)
          text ": :"
          A (&93834803328272)
            attr href "#4.4"
            text "4.4 Pflege der Prüfschlüssel (S2) im SGD-HSM"
        text " "
        LI (&93834799905680)
          text ": : :"
          A (&93834799905984)
            attr href "#4.4.1"
            text "4.4.1 Zuordnung von OCSP-Responder-Zertifikaten zu CA-Zertifikaten (informativ)"
        text " "
        LI (&93834799906584)
          text ": :"
          A (&93834799906888)
            attr href "#4.5"
            text "4.5 Funktionsablauf Firmware-Modul SGD-HSM"
        text " "
        LI (&93834799907488)
          text ": : :"
          A (&93834799907792)
            attr href "#4.5.1"
            text "4.5.1 Zertifikats- und Schlüsselprüfung im SGD-HSM"
        text " "
        LI (&93834799908392)
          text ": : :"
          A (&93834799908696)
            attr href "#4.5.2"
            text "4.5.2 Authentisierungstoken im SGD-HSM"
        text " "
        LI (&93834799909296)
          text ": : :"
          A (&93834799909600)
            attr href "#4.5.3"
            text "4.5.3 Schlüsselableitung im SGD-HSM"
        text " "
        LI (&93834799910200)
          text ": : :"
          A (&93834799910504)
            attr href "#4.5.4"
            text "4.5.4 Kommando-Abarbeitung KeyDerivation im SGD-HSM"
        text " "
        LI (&93834799911104)
          text ": : :"
          A (&93834799911408)
            attr href "#4.5.5"
            text "4.5.5 Betriebsunterstützende Leistungen im SGD-HSM"
        text " "
        LI (&93834799912008)
          text ": :"
          A (&93834799912312)
            attr href "#4.6"
            text "4.6 Betriebsunterstützende Leistungen allgemein"
        text " "
        LI (&93834799912912)
          text ":"
          A (&93834799913216)
            attr href "#5"
            text "5 Kodierung von Schlüsseln und Nachrichten"
        text " "
        LI (&93834799913816)
          text ": :"
          A (&93834799914120)
            attr href "#5.1"
            text "5.1 Kodierung von Schlüsseln"
        text " "
        LI (&93834799914720)
          text ": : :"
          A (&93834799915024)
            attr href "#5.1.1"
            text "5.1.1 ECIES-Schlüssel eines SGD-HSM"
        text " "
        LI (&93834799915624)
          text ": : :"
          A (&93834799915928)
            attr href "#5.1.2"
            text "5.1.2 ECIES-Schlüssel eines Clients"
        text " "
        LI (&93834799916528)
          text ": :"
          A (&93834799916832)
            attr href "#5.2"
            text "5.2 Kodierung von Chiffraten"
        text " "
        LI (&93834799917432)
          text ":"
          A (&93834799917736)
            attr href "#6"
            text "6 Schnittstellen und Operationen"
        text " "
        LI (&93834799918336)
          text ": :"
          A (&93834799918640)
            attr href "#6.1"
            text "6.1 Innenschnittstellen"
        text " "
        LI (&93834799919240)
          text ": :"
          A (&93834799919544)
            attr href "#6.2"
            text "6.2 HTTPS-Schnittstellen und HTTP-Kommunikation"
        text " "
        LI (&93834799920144)
          text ": :"
          A (&93834799920448)
            attr href "#6.3"
            text "6.3 Anforderungen an die JSON-Requests und -Responses"
        text " "
        LI (&93834799921048)
          text ": :"
          A (&93834799921352)
            attr href "#6.4"
            text "6.4 Operation GetPublicKey"
        text " "
        LI (&93834799921952)
          text ": :"
          A (&93834799922256)
            attr href "#6.5"
            text "6.5 Operation GetAuthenticationToken"
        text " "
        LI (&93834799922856)
          text ": :"
          A (&93834799923160)
            attr href "#6.6"
            text "6.6 Operation KeyDerivation"
        text " "
        LI (&93834799923760)
          text ": :"
          A (&93834799924064)
            attr href "#6.7"
            text "6.7 Fehlermeldungen"
        text " "
        LI (&93834799924664)
          text ": : :"
          A (&93834799924968)
            attr href "#6.7.1"
            text "6.7.1 Fehlermeldungen und HTTP-Status-Code (informativ)"
        text " "
        LI (&93834799925568)
          text ":"
          A (&93834799925872)
            attr href "#7"
            text "7 Clientspezifische Festlegungen"
        text " "
        LI (&93834799926472)
          text ": :"
          A (&93834799926776)
            attr href "#7.1"
            text "7.1 Mehrfachableitung"
        text " "
        LI (&93834799927376)
          text ":"
          A (&93834799927680)
            attr href "#8"
            text "8 Interoperables Austauschformat"
        text " "
        LI (&93834799928280)
          text ":"
          A (&93834799928584)
            attr href "#9"
            text "9 Datenkanal zwischen Client und SGD (informativ)"
        text " "
        LI (&93834799929184)
          text ": :"
          A (&93834799929488)
            attr href "#9.1"
            text "9.1 Ablauf Kommunikation zwischen Client und SGD-HSM"
        text " "
        LI (&93834799930088)
          text ": :"
          A (&93834799930392)
            attr href "#9.2"
            text "9.2 ECIES-Verfahren"
        text " "
        LI (&93834799930992)
          text ":"
          A (&93834799931296)
            attr href "#10"
            text "10 Anhang – Verzeichnisse"
        text " "
        LI (&93834799931896)
          text ": :"
          A (&93834799932200)
            attr href "#10.1"
            text "10.1 Abkürzungen"
        text " "
        LI (&93834799932800)
          text ": :"
          A (&93834799933104)
            attr href "#10.2"
            text "10.2 Glossar"
        text " "
        LI (&93834799933704)
          text ": :"
          A (&93834799934008)
            attr href "#10.3"
            text "10.3 Abbildungsverzeichnis"
        text " "
        LI (&93834799934608)
          text ": :"
          A (&93834799934912)
            attr href "#10.4"
            text "10.4 Tabellenverzeichnis"
        text " "
        LI (&93834799935512)
          text ": :"
          A (&93834799935816)
            attr href "#10.5"
            text "10.5 Referenzierte Dokumente"
        text " "
        LI (&93834799936416)
          text ": : :"
          A (&93834799936720)
            attr href "#10.5.1"
            text "10.5.1 – Dokumente der gematik"
        text " "
        LI (&93834799937320)
          text ": : :"
          A (&93834799937624)
            attr href "#10.5.2"
            text "10.5.2 – Weitere Dokumente"
        text " "
      text " "
      P (&93834802393968)
        attr id "polarion_36"
      text " "
      H2 (&93834802394424)
        attr id "1"
        text "1 Einordnung des Dokuments"
      text " "
      H3 (&93834802395024)
        attr id "1.1"
        text "1.1 Zielsetzung"
      text " "
      P (&93834802395624)
        attr id "polarion_38"
        text "Die vorliegende Spezifikation definiert Anforderungen an den Produkttyp "Schlüsselgenerierungsdienst ePA" (SGD) und beschreibt die Funktionsweise der Schlüsselgenerierung, die die Basis für die Ver- und Entschlüsselung von Akten- und Kontextschlüssel innerhalb eines Clients (ePA-FdV etc.) ist. "
      text " "
      H3 (&93834802396224)
        attr id "1.2"
        text "1.2 Zielgruppe"
      text " "
      P (&93834802396824)
        attr id "polarion_18"
        text "Das Dokument richtet sich an Hersteller und Anbieter des Produkts "Schlüsselgenerierungsdienst ePA" und des Produktes "ePA-Aktensystem". Weiterhin unterstützt das Dokument Hersteller von "ePA-Frontends des Versicherten" und Hersteller eines "Fachmodul ePA" bei der Entwicklung, da diese Produkte mit mehreren SGD kommunizieren müssen."
      text " "
      H3 (&93834802397424)
        attr id "1.3"
        text "1.3 Geltungsbereich"
      text " "
      P (&93834802398024)
        attr id "polarion_53"
        text "Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur des deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungsverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z. B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) festgelegt und bekannt gegeben."
      text " "
      P (&93834802398624)
        attr id "polarion_54"
      text " "
      P (&93834802399104)
        attr data-keep-next "true"
        attr id "polarion_55"
        text " "
        SPAN (&93834802399760)
          attr style "font-weight: bold;"
          text "Wichtiger Schutzrechts-/Patentrechtshinweis"
        text " "
      text " "
      P (&93834802400480)
        attr data-keep-next "true"
        attr id "polarion_56"
        text " "
        SPAN (&93834802401136)
          attr style "font-style: italic;font-size: 10pt;line-height: 1.5;"
          text "Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen."
        text " "
      text " "
      H3 (&93834802401856)
        attr id "1.4"
        text "1.4 Abgrenzungen"
      text " "
      P (&93834802402456)
        attr id "polarion_57"
        text "Es ist keine Abgrenzung gegenüber anderen Spezifikationen/Konzepten oder im Kontext derzeit nicht relevanten Themen erforderlich."
      text " "
      H3 (&93834802403056)
        attr id "1.5"
        text "1.5 Methodik"
      text " "
      P (&93834802403656)
        attr id "polarion_17"
        text "Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID sowie die dem RFC 2119 [RFC2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet."
        BR (&93834802404136)
        text " "
        BR (&93834802404440)
        text "Sie werden im Dokument wie folgt dargestellt:"
        BR (&93834802404744)
        text "<AFO-ID> - <Titel der Afo>"
        BR (&93834802405048)
        text "Text / Beschreibung"
        BR (&93834802405352)
        text "[<=]"
        BR (&93834802405656)
        text " "
        BR (&93834802405960)
        text "Dabei umfasst die Anforderung sämtliche zwischen Afo-ID und der Textmarke [<=] angeführten Inhalte."
        BR (&93834802406264)
        text " "
      text " "
      H2 (&93834802406688)
        attr id "2"
        text "2 Überblick"
      text " "
      P (&93834802407288)
        attr id "polarion_46"
        text "Ein Schlüsselgenerierungsdienst (SGD) generiert AES-256-Bit-Schlüssel für eine Entität, die sich mittels"
      text " "
      UL (&93834802407888)
        attr id "polarion_109"
        text " "
        LI (&93834802408368)
          text "einer eGK,"
        text " "
        LI (&93834802408792)
          text "einer alternativen Versichertenidentität,"
        text " "
        LI (&93834802409216)
          text "einer SMC-B, oder"
        text " "
        LI (&93834802409640)
          text "einer SMC-KTR "
        text " "
      text " "
      P (&93834802410184)
        attr id "polarion_164"
        text "gegenüber dem SGD authentisiert hat. Diese Generierung erfolgt über eine Schlüsselableitung auf Grundlage von geheimen SGD-spezifischen Ableitungsschlüsseln (Masterkeys) und Ableitungsvektoren. Diese Ableitungsvektoren enthalten konstante Merkmale, entweder die KVNR oder die Telematik-ID. Jeweils fließt notwendigerweise solch ein konstantes Merkmal aus der erfolgreichen Authentisierung und dem dabei verwendeten EE-Client-Zertifikat mit in die Ableitung ein. Damit werden nur für Berechtigte (erfolgreich Authentifizierte) diese Schlüssel abgeleitet und die jeweils generierten Schlüssel sind spezifisch – unterschiedliche Ableitungsvektoren erzeugen jeweils unterschiedliche abgeleitete Schlüssel."
      text " "
      P (&93834802410784)
        attr id "polarion_117"
        text "Die Sicherung der medizinischen Daten bei der elektronischen Patientenakte [gemSysL_ePA] ist ein Zusammenspiel aus Zugriffskontrolle und Schlüsselmanagement (Verschlüsselung). Aus diesem Hybridmodell folgt: Auch wenn ein Client über mehrere SGD Schlüssel ableiten lassen kann, heißt dies noch nicht, dass für diese Schlüssel überhaupt ein passendes Chiffrat existiert oder dass ein Client auf solch ein Chiffrat Zugriff besitzt."
      text " "
      P (&93834802411384)
        attr id "polarion_167"
        text "Die Schlüsselableitung wird in einem SGD innerhalb eines HSM mit einem SGD-spezifischen Firmware-Modul durchgeführt (SGD-HSM genannt). Durch technische Maßnahmen wird ausgeschlossen, dass ein Betreiber eines SGD die Schlüsselableitung selbst durchführen kann oder Zugriff auf die unverschlüsselten versichertenindividuellen Schlüssel erhalten kann. Nur das SGD-HSM kann die geheimen Ableitungsschlüssel verwenden. Es prüft dabei zuvor die erfolgreiche Authentisierung des Anfragenden und verwendet u. a. die darin authentisierten Angaben als Ableitungsvektoren. Es gibt aus der Perspektive eines Client (des ePA-Frontend des Versicherten (ePA-FdV), eines Konnektor-Fachmodul ePA (FM ePA) etc.) immer genau zwei SGD, die ein Client aufgrund der verwendeten SGD-HSM-Zertifikate sicher unterscheiden kann. Der Client fordert eine Schlüsselgenerierung jeweils bei den beiden SGD an und erhält damit zwei unabhängige AES-256-Schlüssel. Nach erfolgreicher Authentifizierung und Autorisierung durch das Aktensystem verwendet der Client diese zwei Schlüssel, um das vom ePA-Aktensystem erhaltene Chiffrat im "Zwiebelschalenprinzip" zu entschlüsseln. So erhält der Client den Akten- und den Kontextschlüssel im Klartext. Diese beiden Schlüssel sind dabei bezüglich der Ver- und Entschlüsselung durch eine gemeinsame Datenstruktur (vgl. Abschnitt "
        SPAN (&93834802411864)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94583"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") fest miteinander verbunden. Die zwei SGD sind technisch, organisatorisch und wirtschaftlich unabhängig voneinander (vgl. Abschnitt "
        SPAN (&93834802413224)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94498"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "  ). Ein SGD kommt niemals mit dem Akten- und Kontextschlüssel eines Versicherten in Berührung."
      text " "
      P (&93834802414704)
        attr id "polarion_61"
        text "Verliert der Versicherte seine eGK oder sein mobiles Endgerät mit seiner alternativen Versichertenidentität, kann er sich mit seiner neuen Identität (Folge-eGK oder einer anderen alternativen Versichertenidentität) am ePA-Aktensystem authentisieren. Da die Merkmale für die Schlüsselableitung in der Folgeidentität gleich sind (gleichbleibende KVNR)  und kodiert ist, welcher Ableitungsschlüssel verwendet worden ist, kann ein Client mittels beider SGD die gleichen Schlüssel erhalten und die Entschlüsselung der Akten- und Kontextschlüssel wieder vornehmen. Der Verlust einer eGK eines Versicherten führt also nicht zum Verlust der Akte des Versicherten."
      text " "
      P (&93834802415304)
        attr id "polarion_173"
        text "Analog ist in einer Folge-SMC-B die Telematik-ID konstant. Somit kann eine Leistungserbringerinstitution (LEI) bereits vergebene Berechtigungen und vorher von einem Versicherten für die LEI erzeugte Chiffrate weiterhin nutzen."
      text " "
      H3 (&93834802415904)
        attr id "2.1"
        text "2.1 Grundlage und Kernidee"
      text " "
      P (&93834802416504)
        attr id "polarion_50"
        text "Notwendige Grundlage der Idee der Schlüsselableitung mittels der SGD ist, dass bei einem Kartenwechsel der eGK oder einem Wechsel der alternativen Versichertenidentität die KVNR eines Versicherten in den Zertifikaten der Folgekarte bzw. bei der Folgeidentität korrekt und konstant bleibt. Die Korrektheit der Kartenherausgabeprozesse ist – wie bei nahezu allen digitalen Prozessen in der TI – notwendige Voraussetzung. Analog bleibt bei einem Kartenwechsel einer SMC-B oder einer SMC-KTR die Telematik-ID konstant."
      text " "
      P (&93834802417104)
        attr id "polarion_48"
        text "Es muss sichergestellt sein, dass nur erfolgreich authentifizierte Clients eine Schlüsselableitung durchführen können und dabei notwendigerweise die die Clients identifizierenden (konstanten) Merkmale in die Schlüsselableitung als Ableitungsvektor mit einfließen. Die Authentifizierung durch die SGD-HSMs der beiden SGD erfolgt unabhängig vom Aktensystem."
      text " "
      P (&93834802417704)
        attr id "polarion_59"
        text "Ziele für die Schlüsselableitung:"
      text " "
      OL (&93834802418304)
        attr id "polarion_60"
        text " "
        LI (&93834802418784)
          text "Die Akten- und Kontextschlüssel dürfen sich unverschlüsselt nur in Clients (ePA-FdV, FM ePA etc.) befinden (bzw. der Kontextschlüssel ebenfalls in der VAU). Dort liegen die Schlüssel nur temporär während der Verwendung der Akte vor und werden dort anschließend sicher gelöscht."
        text " "
        LI (&93834802419208)
          text "Die Akten- und Kontextschlüssel dürfen nur durch das Zusammenwirken mehrerer unabhängiger Teilnehmer entschlüsselbar sein."
        text " "
        LI (&93834802419632)
          text "Alle Ver- und Entschlüsselungen dürfen nur authentisierte Daten verwenden."
        text " "
        LI (&93834802420056)
          text "Die Akten- und Kontextschlüssel müssen mit versichertenindividuellen Schlüsseln geschützt sein (Schlüsseldiversifizierung)."
        text " "
        LI (&93834802420480)
          text "Da ausreichend geprüfte symmetrische Verschlüsselungsverfahren (bspw. Finalisten des öffentlichen Auswahlverfahrens für AES) in ihrer Sicherheitseignung deutlich stabiler über längere Zeiträume sind als asymmetrische Verschlüsselungsverfahren (Eignung der Schlüssellängen, vgl. notwendige Anpassung der Schlüssellängen bspw. bei RSA), soll die Lösung möglichst viel auf symmetrischen Verfahren beruhen."
        text " "
        LI (&93834802420904)
          text "Die Verwendung von symmetrischen Verschlüsselungsverfahren ermöglicht eine eventuell zukünftig notwendige Reaktion auf das Thema Quantencomputer-Resistenz."
        text " "
      text " "
      P (&93834802421448)
        attr id "polarion_84"
        text "Wenn die KVNR bzw. die Telematik-ID in einer Folgekarte oder Folgeidentität immer konstant ist, so kann diese (1) als eindeutiges Identifikationsmerkmal bspw. innerhalb einer Authentifizierung und Autorisierung verwendet werden und (2) als Basis für eine eindeutige Schlüsselableitung. Die Schlüsselableitung berechnet aus einem geheimen Ableitungsschlüssel (Mastersecret) und einer KVNR plus anderen Angaben (vgl. Abschnitte"
        SPAN (&93834802421928)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ff) deterministisch einen spezifischen AES-256-Schlüssel. Diese Schlüsselableitung wird in einem HSM mit einem speziellen Firmware-Modul durchgeführt, das verhindert, dass der Betreiber des HSMs (vgl. Abschnitt"
        SPAN (&93834802423288)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94516"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) in den Ableitungsprozess Einblick erhält – er kennt den geheimen Ableitungsschlüssel nicht, und er kann die Authentifizierungs- und Autorisierungsfunktion im HSM nicht beeinflussen. Ein solcher abgeleiteter versicherten- und zugriffsregelindividueller AES-256-Schlüssel wird dem Client über einen beidseitig authentisierten Ende-zu-Ende-verschlüsselten Kanal zwischen SGD-HSM und dem Client zur Verfügung gestellt. Ein Versicherter verwendet solche abgeleiteten versichertenindividuellen AES-256-Schlüssel aus mehreren voneinander unabhängigen SGD. Ein Client (ein ePA-FdV, ein FM ePA etc.) kann die verschiedenen SGD voneinander unterscheiden. Die Erzeugung der abgeleiteten versichertenindividuellen AES-256-Schlüssel kann auf beliebig viele unabhängige SGD verteilt werden. Das Verfahren skaliert linear – es ist technisch leicht möglich, mehrere SGD zu verwenden."
      text " "
      P (&93834802424768)
        attr id "polarion_144"
        text "Die Schlüsselableitungsfunktionalität ePA basiert aktuell auf genau zwei SGD pro Aktensystem (vgl. Abschnitt "
        SPAN (&93834802425248)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94490"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " und Abschnitt "
        SPAN (&93834775373784)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94498"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") gemäß"
        SPAN (&93834775375144)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemKPT_Arch_TIP#4.7 Langfristige Verschlüsselung]"
          attr data-item-id "ML-94626"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " . Im Folgenden wird derjenige SGD, den ein Anbieter eines Fachanwendungsspezifischen Dienstes (FAD) bereitstellen muss, als "SGD 1" bzw. "SGD FAD" bezeichnet. Derjenige SGD, der von einem von SGD 1 unabhängigen Dritten in der TI-Plattform (TIP) betrieben wird, wird im Folgenden als "SGD 2" bzw. "SGD TIP" bezeichnet. Mittels der beiden erhaltenen AES-256-Schlüssel verschlüsselt ein Client den Akten- und Kontextschlüssel (vgl. Abschnitt ""
        SPAN (&93834775376680)
          attr class "polarion-rte-link"
          attr data-item-id "ML-92802"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ") im "Zwiebelschalenprinzip". Das entstandene Chiffrat wird dem ePA-Aktensystem zur Einlagerung übergeben. "
      text " "
      P (&93834775378160)
        attr id "polarion_99"
        text "Nach einer erfolgreichen Anmeldung am Aktensystem kann ein Versicherter Folgendes tun:"
      text " "
      OL (&93834775378760)
        attr id "polarion_134"
        text " "
        LI (&93834775379240)
          text "Der Versicherte authentisiert sich jeweils bei den verschiedenen, unabhängigen Schlüsselableitungsdiensten (beidseitig authentisierter verschlüsselter Datenkanal zwischen SGD-HSM und Client, vgl. Abschnitt "
          SPAN (&93834775379544)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94770"
            attr data-option-id "shortoutline"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text " )."
        text " "
        LI (&93834775381024)
          text "Der Versicherte erhält aufgrund der Konstanz der KVNR  und des im Ableitungsvektor benannten geheimen Ableitungsschlüssel jeweils den gleichen abgeleiteten versichertenindividuellen AES-256-Schlüssel wie zuvor."
        text " "
        LI (&93834775381448)
          text "Der Versicherte kann anschließend im Zwiebelschalenprinzip den Akten- und den Kontextschlüssel entschlüsseln."
        text " "
      text " "
      P (&93834775381992)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_20"
        attr style "text-align: center;"
        text " "
        IMG (&93834775382824)
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0AAAAIfCAYAAABZzLzUAAAgAElEQVR4Aey9D5AU9bn3+10VjiIqZin+qISF2kELWIUQLZk9ceVNQHdRo1IvJ5JbYbVeZ3Oild3Dyd7jLXmTqxcrpjaH7KY0ZsdTCqn3YMJ5UTRhN4q5sOTdwSuHgCxwldkSCOquXDYiIhIwzq2nu38zPTPdPd0zPbPz59tVw/R0//48v0/PDv3086..."
          attr style "width: 582px;height: 380px;"
        text " "
      text " "
      P (&93834775383600)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_27"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834775384432)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "1"
        text ": Überblick Zwiebelschalenprinzip bei der Ver- und Entschlüsselung"
      text " "
      P (&93834775385328)
        attr id "polarion_131"
        text "Ein wichtiger Aspekt: Das   kryptographische Verfahren für die Generierung der spezifischen Schlüssel in den Schlüsselgenerierungsdiensten ist unabhängig von dem aktuell verwendeten Authentisierungsverfahren. Wenn bei der Authentisierung also zukünftig eine elliptische Kurve  mit 512-Bit anstatt aktuell einer elliptischen Kurve mit 256-Bit verwendet werden soll (oder ein Quanten-Computing-resistentes Signatur-Verfahren), so ist dies ist für das grundsätzliche Verfahren nicht entscheidend. Die Schlüsselableitungsfunktionalität ist diesbezüglich unabhängig."
      text " "
      P (&93834775385928)
        attr id "polarion_152"
        text "Der geheime Ableitungsschlüssel eines Schlüsselgenerierungsdienstes (SGD) wird regelmäßig neu erzeugt, so dass auch dort eine Schlüsseldiversifizierung vorhanden ist. Alte Ableitungsschlüssel müssen in den SGD weiter vorgehalten werden, solange sie potentiell benötigt werden. In einem späteren Release wird die (regelmäßige) Umschlüsselung einer ePA-Akte spezifikatorisch bearbeitet. Bei den SGD gibt es dafür jetzt schon vorbereitende Maßnahmen (vgl. Abschnitt "
        SPAN (&93834775386408)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ", RND-Zufallswert). Bei einem Schlüsselwechsel bei der jeweiligen Akte (Umschlüsselung) muss auch eine neue Einlagerung (Schlüsselableitungsfunktionalität) vorgenommen werden (im Normalfall mittels eines neuen Ableitungsschlüssels). Das sichere Löschen von nicht mehr benötigten Ableitungsschlüsseln (Masterkeys) wird dann in diesem späteren Release ebenfalls spezifikatorisch bearbeitet. Die Ableitungsschlüssel besitzen eindeutige Bezeichner ("
        SPAN (&93834775387768)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17920-02"
          attr data-item-id "ML-109460"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ) und sind unterscheidbar."
      text " "
      H3 (&93834775389424)
        attr id "2.2"
        text "2.2 Akteure und Komponenten"
      text " "
      P (&93834775390024)
        attr id "polarion_74"
        text "Die beteiligten Akteure sind:"
      text " "
      P (&93834775390624)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_51"
        text "Tabelle "
        SPAN (&93834775391456)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "1"
        text ": beteiligte Akteure im Kontext Schlüsselableitungsfunktionalität"
      text " "
      TABLE (&93834775392352)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=5"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834775393008)
          text " "
          TR (&93834775393312)
            text " "
            TH (&93834775393616)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 215px;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775393976)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Rolle"
            text " "
            TH (&93834775394576)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 512px;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775394936)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Beschreibung"
            text " "
          text " "
          TR (&93834775395656)
            text " "
            TD (&93834775395960)
              attr style "vertical-align: top;width: 215px;height: 69pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775396320)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "der Versicherte (Kontoinhaber)"
            text " "
            TD (&93834775396920)
              attr style "vertical-align: top;width: 512px;height: 69pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775397280)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Versicherte nutzt das von seiner Krankenkasse für ihn bereitgestellte ePA-Aktensystem. Er ist Kontoinhaber. Er verwendet entweder ein ePA-FdV (s. u.) für den Aktenzugriff oder berechtigt eine LEI (bzw. in einem späteren Release einen LE) via ad-hoc-Autorisierung über ein FM ePA (s. u.). Dabei verwendet er entweder eine eGK- basierte AUT-Identität oder eine alternative Versichertenidentität zur Authentisierung jeweils am Aktensystem, am SGD 1 (s. u.) und am SGD 2 (s. u.)."
            text " "
          text " "
          TR (&93834775398000)
            text " "
            TD (&93834775398304)
              attr style "vertical-align: top;width: 215px;height: 73px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775398664)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ein Vertreter"
            text " "
            TD (&93834775399264)
              attr style "vertical-align: top;width: 512px;height: 73px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775399624)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Ein Vertreter ist ein Versicherter (besitzt also eine eGK oder einen alternative Versichertenidentität) und wurde vom Versicherten (Kontoinhaber) berechtigt, für diesen Handlungen in Bezug auf die ePA vorzunehmen (bspw. LEI im Namen des Kontoinhabers zu berechtigen)."
            text " "
          text " "
          TR (&93834775400344)
            text " "
            TD (&93834775400648)
              attr style "vertical-align: top;width: 215px;height: 83pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775401008)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "eine Leistungserbringerinstitution (LEI)"
            text " "
            TD (&93834775401608)
              attr style "vertical-align: top;width: 512px;height: 83pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775401968)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Eine LEI ist von einem Versicherten berechtigt worden, auf dessen Akte zuzugreifen. Nach Anmeldung am Aktensystem und nach der Prüfung der Autorisierung durch das Aktensystem wird an die LEI ein "doppeltes" Chiffrat übergeben, das den Akten- und Kontextschlüssel der Akte des Versicherten enthält. Durch Zugriff auf die beiden SGD (s. u.) inkl. Authentifizierung der LEI erhält diese jeweils einen AES-256-Schlüssel und kann dann im "Zwiebelschalenprinzip" den Akten- und den Kontextschlüssel entschlüsseln."
            text " "
          text " "
          TR (&93834775402688)
            text " "
            TD (&93834775402992)
              attr style "vertical-align: top;width: 215px;height: 29pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775403352)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ein Kostenträger (KTR)"
            text " "
            TD (&93834775403952)
              attr style "vertical-align: top;width: 512px;height: 29pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775404312)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Ein Kostenträger wird durch einen Versicherten (Kontoinhaber oder Vertreter) berechtigt, auf ein Aktenkonto zuzugreifen."
                BR (&93834775404792)
                text "Nach Anmeldung am Aktensystem und nach der Prüfung der Autorisierung durch das Aktensystem wird an den Client ein "doppeltes" Chiffrat übergeben, das den Akten- und Kontextschlüssel der Akte des Versicherten enthält. Durch Zugriff auf die beiden SGD (s. u.) inkl. Authentifizierung des KTR erhält diese jeweils einen AES-256-Schlüssel und kann dann im "Zwiebelschalenprinzip" den Akten- und den Kontextschlüssel entschlüsseln."
            text " "
          text " "
          TR (&93834775405336)
            text " "
            TD (&93834775405640)
              attr style "vertical-align: top;width: 215px;height: 62px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834775406000)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Anbieter ePA-Aktensystem"
            text " "
            TD (&93834811816528)
              attr style "vertical-align: top;width: 512px;height: 62px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811816888)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Ein Anbieter ePA-Aktensystem bietet ein ePA-Aktensystem im Auftrag einer Krankenversicherung deren Versicherten (Kontoinhaber) an. Der Anbieter verantwortet den sicheren Betrieb und die Verfügbarkeit des von ihm angebotenen ePA-Aktensystems."
            text " "
          text " "
          TR (&93834811817608)
            text " "
            TD (&93834811817912)
              attr style "vertical-align: top;width: 215px;height: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811818272)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Anbieter Schlüsselgenerierungsdienst ePA (SGD)"
            text " "
            TD (&93834811818872)
              attr style "vertical-align: top;width: 512px;height: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811819232)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Ein Anbieter Schlüsselgenerierungsdienst ePA bietet die Nutzung der Schlüsselableitungsfunktionalität an. Für einen Versicherten müssen zwei SGD zur Verfügung stehen: ein SGD, der dem Aktensystem beigestellt ist, und ein SGD außerhalb des Aktensystems. Beide SGD sind technisch, organisatorisch und wirtschaftlich getrennt (Rollenausschluss). Beide SGD sind bis auf die unterschiedlichen jeweils zufällig erzeugten Ableitungsschlüssel technisch identisch, für beide SGD gilt dieselbe Spezifikation."
            text " "
          text " "
        text " "
      text " "
      P (&93834811820192)
        attr id "polarion_127"
        text "Die beteiligten Komponenten und Dienste sind:"
      text " "
      P (&93834811820792)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_258"
        text "Tabelle "
        SPAN (&93834811821448)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "2"
        text ": beteiligte Komponenten und Dienste im Kontext Schlüsselableitungsfunktionalität"
      text " "
      TABLE (&93834811822344)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=6"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834811823000)
          text " "
          TR (&93834811823304)
            text " "
            TH (&93834811823608)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 210px;height: 14pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811823968)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Komponente oder Dienst"
            text " "
            TH (&93834811824568)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 517px;height: 14pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811824928)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Beschreibung"
            text " "
          text " "
          TR (&93834811825648)
            text " "
            TD (&93834811825952)
              attr style "vertical-align: top;width: 210px;height: 125px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811826312)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA-Frontend des Versicherten (ePA-FdV)"
            text " "
            TD (&93834811826912)
              attr style "vertical-align: top;width: 517px;height: 125px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811827272)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das ePA-FdV tritt als Client gegenüber den beiden SGD (s. u.) auf. Von diesen beiden erhält es jeweils einen versichertenindividuellen geheimen Schlüssel (AES-256). Mit diesen beiden Schlüsseln werden nach der initialen zufälligen Erzeugung von Akten- und Kontextschlüssel im Client diese in ein interoperables Austauschformat kodiert und anschließend zwei Mal hintereinander verschlüsselt. Das "doppelte" Chiffrat übergibt das ePA-FdV an das ePA-Aktensystem (Komponente Autorisierung) zur Einlagerung."
            text " "
          text " "
          TR (&93834811827992)
            text " "
            TD (&93834811828296)
              attr style "vertical-align: top;width: 210px;height: 29px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811828656)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Fachmodul ePA (FM ePA) im Konnektor einer LEI oder eines LE"
            text " "
            TD (&93834811829256)
              attr style "vertical-align: top;width: 517px;height: 29px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811829616)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das FM ePA tritt als Client gegenüber den beiden SGD (s. u.) auf."
            text " "
          text " "
          TR (&93834811830336)
            text " "
            TD (&93834811830640)
              attr style "vertical-align: top;width: 210px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811831000)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Fachmodul ePA im KTR-Consumer (FM ePA KTR)"
            text " "
            TD (&93834811831600)
              attr style "vertical-align: top;width: 517px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811831960)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das FM ePA tritt als Client gegenüber den beiden SGD (s. u.) auf."
            text " "
          text " "
          TR (&93834811832680)
            text " "
            TD (&93834811832984)
              attr style "vertical-align: top;width: 210px;height: 10px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811833344)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA-Aktensystem"
            text " "
            TD (&93834811833944)
              attr style "vertical-align: top;width: 517px;height: 10px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811834304)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das ePA-Aktensystem stellt dem Versicherten eine ePA zur Verfügung."
            text " "
          text " "
          TR (&93834811835024)
            text " "
            TD (&93834811835328)
              attr style "vertical-align: top;width: 210px;height: 92px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811835688)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA-Aktensystem, Zugangsgateway des Versicherten (ZGdV)"
            text " "
            TD (&93834811836288)
              attr style "vertical-align: top;width: 517px;height: 92px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811836648)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das ZGdV nimmt Anfragen von ePA-FdV über seine HTTPS-Schnittstelle an und leitet diese Anfragen für bestimmte Pfadnamen, nämlich /SGD1 und /SGD2, im HTTP-Request jeweils an den SGD 1 oder den SGD 2 weiter. Welchen SGD welcher Anbieter verwendet, wird initial bei der Inbetriebnahme des Aktensystems festgelegt (vgl. Abschnitt "
                SPAN (&93834811837128)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94498"
                  attr data-option-id "longoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")."
            text " "
          text " "
          TR (&93834811838728)
            text " "
            TD (&93834811839032)
              attr style "vertical-align: top;width: 210px;height: 50px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811839392)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA-Aktensystem, Komponente Autorisierung"
            text " "
            TD (&93834811839992)
              attr style "vertical-align: top;width: 517px;height: 50px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811840352)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die "Komponente Autorisierung" bewahrt den "doppelt" verschlüsselten Akten- und Kontextschlüssel (AuthorizationKey-Datenstruktur) auf. Sie übergibt diese Datenstruktur nach erfolgreicher Anmeldung eines Client an diesen."
            text " "
          text " "
          TR (&93834811841072)
            text " "
            TD (&93834811841376)
              attr style "vertical-align: top;width: 210px;height: 83pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811841736)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SGD 1"
                BR (&93834811842216)
                text "als FAD"
            text " "
            TD (&93834811842640)
              attr style "vertical-align: top;width: 517px;height: 83pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811843000)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Dem ePA-Aktensystem beigestellt gibt es einen SGD. Dieser ist unter dem Pfadnamen /SGD1 über das ZGdV für alle Clients ansprechbar. Der SGD generiert auf Nutzeranfrage verschiedene versichertenindividuelle AES-256-Schlüssel."
                BR (&93834811843480)
                text " "
                BR (&93834811843784)
                text "Durch technische Maßnahmen wird dabei mit hoher Sicherheit ausgeschlossen, dass ein Betreiber eines SGD diese Schlüssel ermitteln kann."
            text " "
          text " "
          TR (&93834811844328)
            text " "
            TD (&93834811844632)
              attr style "vertical-align: top;width: 210px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811844992)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SGD 2"
                BR (&93834811845472)
                text "der TIP"
            text " "
            TD (&93834811845896)
              attr style "vertical-align: top;width: 517px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834811846256)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Als Teil der zentralen TI ist dieser SGD unter dem Pfadnamen /SGD2 über das ZGdV für alle Clients ansprechbar. Für beide SGD (1 und 2) gilt dieselbe Spezifikation."
            text " "
          text " "
        text " "
      text " "
      P (&93834811847216)
        attr id "polarion_107"
      text " "
      P (&93834811847696)
        attr id "polarion_35"
        text "Die folgende Grafik gibt einen Überblick über die beteiligten Komponenten und Dienste."
      text " "
      P (&93834811848296)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_63"
        attr style "text-align: center;"
        text " "
        IMG (&93834765135080)
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAvkAAAKRCAYAAADOG7ZPAAAgAElEQVR4Aey9DXhV1bnv+1+Iki1+xKoItUi0ScAIEkq1sHJawmn9SFAayz4ROM/ewL63K3pvb7Ok5VTbPAd4Di31YnWl1/vUrN6nkHvuBpu91YiSgO4+hN2ThUeLoNCIWamkpQpSLfGzgMC6zzvmnGvNuT7n+v76z/1krznnGON93/Eb0/LOMd/xDk..."
          attr style "width: 582px;height: 503px;"
        text " "
      text " "
      P (&93834765135856)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_64"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834765136688)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "2"
        text ": beteiligte Komponenten und Dienste im Kontext der Schlüsselableitungsfunktionalität ePA"
      text " "
      P (&93834765137584)
        attr id "polarion_69"
        text "Ein SGD 1 und ein SGD 2 sind fachlich gesehen baugleich – bis auf die eingesetzten geheimen und privaten Schlüssel ("
        SPAN (&93834765138064)
          attr class "polarion-rte-link"
          attr data-custom-label "A17910-01"
          attr data-item-id "ML-109449"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "   (S1), (S3), (S4) und (S5)) und ihre Identität ("
        SPAN (&93834765139600)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17848"
          attr data-item-id "ML-94622"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) unterscheiden sie sich nicht. Insbesondere benötigt ein SGD keine Informationen aus dem ePA-Aktensystem."
      text " "
      H3 (&93834765141256)
        attr id "2.3"
        text "2.3 Basisablauf Kommunikation SGD-Client und SGD"
      text " "
      P (&93834765141856)
        attr id "polarion_105"
        text "Ein Client aus dem Internet (also ein ePA-FdV) erreicht einen SGD über das ZGdV des ePA-Aktensystems (vgl. "
        SPAN (&93834765142336)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Zugangsgateway_Vers#Proxy Schlüsselgenerierungsdienst]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Zugangsgateway_Vers?selection=ML-93876"
          attr id "fake"
        text "). Solch ein Client verwendet die auch für die Kommunikation mit dem Aktensystem verwendete HTTPS-Schnittstelle des ZGdV. Das ZGdV leitet HTTP-Requests mit dem Pfadname /SGD1 an die HTTPS-Schnittstelle des SGD 1 weiter (eigenständige TLS-Verbindung zwischen ZGdV und SGD). Analog tut das ZGdV dies für Requests mit dem Pfadnamen /SGD2 in Bezug auf den SGD 2. Auf Applikationsebene gibt es eine Ende-zu-Ende-Verschlüsselung zwischen den Clients und den SGD-HSMs der SGDs (vgl. Abschnitt"
        SPAN (&93834765143696)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94770"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " )."
      text " "
      P (&93834765145176)
        attr id "polarion_285"
        text "Ein Client aus der TI (FM ePA etc.) spricht die beiden SGD über deren HTTPS-Schnittstellen ("
        SPAN (&93834765145656)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17889"
          attr data-item-id "ML-94687"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") direkt an. Die IP-Adressen erfahren solche Clients über DNS-Service-Discovery. "
      text " "
      P (&93834765147312)
        attr id "polarion_39"
        text "Der grundsätzliche Ablauf einer Anfrage (vgl. Abschnitt "
        SPAN (&93834765147792)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ff) ist in Bezug auf das Kommunikationsmuster bezüglich der beiden SGD immer gleich und wird im Folgenden beschrieben. Zur Vereinfachung der Darstellung ist der Ablauf sequenziell dargestellt. Für eine Performanzsteigerung muss ein Client die Anfragen an die beiden SGD parallelisieren ("
        SPAN (&93834765149152)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17925"
          attr data-item-id "ML-94728"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ), was bis auf Schritt 6 leicht möglich ist. Eine noch detaillierte Erläuterung zu den kryptographischen Grundlagen der Kommunikation befindet sich in Abschnitt ""
        SPAN (&93834765150688)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94770"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ""."
      text " "
      P (&93834765152168)
        attr id "polarion_70"
        text " "
        SPAN (&93834765152648)
          attr style "font-weight: bold;"
          text "Schritt 1:"
        text " "
      text " "
      P (&93834765153368)
        attr id "polarion_119"
        text "Der Client verwendet die HTTPS-Schnittstelle des ZGdV, oder falls er aus Netzwerksicht Teil der TI ist (FM ePA etc.) die HTTPS-Schnittstelle eines SGD direkt, um den aktuellen öffentlichen ECIES-Schlüssel des SGD 1 zu erhalten (Pfadname der URL ist "/SGD1") (vgl. Schnittstelle ""
        SPAN (&93834765153848)
          attr class "polarion-rte-link"
          attr data-item-id "ML-93990"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " "). Das ZGdV leitet den HTTP-Request (HTTPS) an den SGD 1 weiter."
      text " "
      P (&93834765155328)
        attr id "polarion_120"
        text " "
        SPAN (&93834765155808)
          attr style "font-weight: bold;"
          text "Schritt 2:"
        text " "
      text " "
      P (&93834765156528)
        attr id "polarion_121"
        text "Der SGD 1 antwortet mit dem aktuellen authentisierten öffentlichen ECIES-Schlüssel des für den Nutzer (AUT-Zertifikat) avisierten SGD-HSM innerhalb des SGD 1 (vgl. A_17894-01 ). Dieser Schlüssel ändert sich alle 15 Minuten und ist dann jeweils für 30 Minuten für alle anfragenden Clients verwendbar. Der ECIES-Schlüssel des SGD-HSM ist durch das SGD-HSM signiert ("
        SPAN (&93834765157008)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17910-01"
          attr data-item-id "ML-109449"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "   (S1))."
      text " "
      P (&93834765158664)
        attr id "polarion_122"
        text " "
        SPAN (&93834765159144)
          attr style "font-weight: bold;"
          text "Schritt 3:"
        text " "
      text " "
      P (&93834765159864)
        attr id "polarion_201"
        text "Der Client prüft das Zertifikat, die Signatur und den ECIES-Schlüssel des SGD-HSM von SGD 1 ("
        SPAN (&93834765160344)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18024"
          attr data-item-id "ML-96280"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). Er prüft dabei u. a., dass die Antwort von einem SGD-1-SGD-HSM kam."
      text " "
      P (&93834765162000)
        attr id "polarion_305"
        text " "
        SPAN (&93834765162480)
          attr style "font-weight: bold;"
          text "Schritt 4:"
        text " "
      text " "
      P (&93834765163200)
        attr id "polarion_29"
        text "Der Client erfragt analog zu Schritt 1 den aktuellen authentisierten öffentlichen ECIES-Schlüssel von SGD 2 (Pfadname der URL ist "/SGD2")."
      text " "
      P (&93834765163800)
        attr id "polarion_30"
        text " "
        SPAN (&93834765164280)
          attr style "font-weight: bold;"
          text "Schritt 5:"
        text " "
      text " "
      P (&93834765165000)
        attr id "polarion_31"
        text "Der SGD 2 antwortet analog zu Schritt 2 mit dem signierten ECIES-Schlüssel des für den Nutzer vorgesehenen SGD-HSM innerhalb von SGD 2 (vgl. A_17894-01 )."
      text " "
      P (&93834765165600)
        attr id "polarion_32"
        text " "
        SPAN (&93834765166080)
          attr style "font-weight: bold;"
          text "Schritt 6:"
        text " "
      text " "
      P (&93834765166800)
        attr id "polarion_306"
        text "Der Client prüft analog zu Schritt 3 das Zertifikat, die Signatur und den ECIES-Schlüssel des SGD-HSM von SGD 2 ("
        SPAN (&93834765167280)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18024"
          attr data-item-id "ML-96280"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). Er prüft dabei u. a., dass die Antwort von einem SGD-2-SGD-HSM kam."
      text " "
      P (&93834793825888)
        attr id "polarion_308"
        text " "
        SPAN (&93834793826368)
          attr style "font-weight: bold;"
          text "Schritt 7:"
        text " "
      text " "
      P (&93834793827088)
        attr id "polarion_309"
        text "Der Client berechnet die Hashwerte der erhaltenen ECIES-Schlüsselwerte der beiden SGD-HSM aus Schritt 3 und Schritt 6."
      text " "
      P (&93834793827688)
        attr id "polarion_310"
        text " "
        SPAN (&93834793828168)
          attr style "font-weight: bold;"
          text "Schritt 8:"
        text " "
      text " "
      P (&93834793828888)
        attr id "polarion_33"
        text "Der Client erzeugt ein kurzlebiges ECIES-Schlüsselpaar ( [gemSpec_Krypt#"
        SPAN (&93834793829368)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17874"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94671"
          attr id "fake"
        text "]), was der Client später für die Request an SGD 1 und SGD 2 verwenden wird. Der Client führt den öffentlichen Client-ECIES-Schlüssel zusammen mit den Hashwerten aus Schritt 7 in ein Kodierung gemäß "
        SPAN (&93834793830728)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17900"
          attr data-item-id "ML-94700"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "auf und signiert diese Kodierung mittels des AUT-Materials der eGK, der SMC-B, der SMC-KTR oder der alternativen Authentisierung."
      text " "
      P (&93834793832384)
        attr id "polarion_166"
        text " "
        SPAN (&93834793832864)
          attr style "font-weight: bold;"
          text "Schritt 9:"
        text " "
      text " "
      P (&93834793833584)
        attr id "polarion_311"
        text "Der Client verwendet die Operation GetAuthenticationToken bei SGD 1 um ein Authentisierungstoken zu erhalten. Dafür erzeugt der Client einen Zufallswert (Challenge) und sendet diesen verschlüsselt an das für ihn vorgesehene SGD-HSM bei SGD 1."
      text " "
      P (&93834793834184)
        attr id "polarion_312"
        text " "
        SPAN (&93834793834664)
          attr style "font-weight: bold;"
          text "Schritt 10:"
        text " "
      text " "
      P (&93834793835384)
        attr id "polarion_313"
        text "Die RVE innerhalb von SGD 1 prüft das AUT-Zertifikat, die Client-Signatur des Client-ECIES-Schlüssels und den Client-ECIES-Schlüssel. Falls alle Prüfungen ein OK liefern, bereitet die RVE den Request auf (OCSP-Responses, Umkodierung für die Innenschnittstelle zum den SGD-HSM etc.) und übergibt die verschlüsselte Nachricht an das SGD-HSM. Das SGD-HSM prüft ebenfalls das AUT-Zertifikat, die Client-Signatur des Client-ECIES-Schlüssels und den Client-ECIES-Schlüssel und erstellt ein Authentisierungstoken. Das SGD-HSM erstellt eine Nachricht, die die Challenge des Client, einen Hashwert (des Client-Schlüssels und des AUT-Zertifikats) und das erzeugte Authentisierungstoken enthält. Diese Nachricht verschlüsselt das SGD-HSM für den Client-ECIES-Schlüssel und übergibt das Chiffrat an die RVE. Diese kodiert die Nachricht um und antwortet dem Client."
      text " "
      P (&93834793835984)
        attr id "polarion_315"
        text " "
        SPAN (&93834793836464)
          attr style "font-weight: bold;"
          text "Schritt 11:"
        text " "
      text " "
      P (&93834793837184)
        attr id "polarion_316"
        text "Der Client entschlüsselt die Nachricht des SGD-HSM von SGD 1. In der entschlüsselten Nachricht prüft, es ob seine Challenge enthalten ist. Falls ja, kann es davon ausgehen, dass die Antwort wirklich vom SGD-HSM stammt. Es prüft den Hashwert (des Client-Schlüssels und des AUT-Zertifikats) und speichert das Authentisierungstoken für die folgende Verwendung innerhalb der Operation KeyDerivation."
      text " "
      P (&93834793837784)
        attr id "polarion_317"
        text " "
        SPAN (&93834793838264)
          attr style "font-weight: bold;"
          text "Schritt 12:"
        text " "
      text " "
      P (&93834793838984)
        attr id "polarion_318"
        text "Der Client erzeugt zufällig eine Request-ID, anschließend eine Nachricht. Diese enthält das Authentisierungstoken, die Request-ID und die je nach Anwendungsfall (vgl. Abschnitt"
        SPAN (&93834793839464)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ff) unterschiedliche Ableitungsregel. Diese Nachricht verschlüsselt der Client für das SGD-HSM und verwendet die Operation KeyDerivation von SGD 1."
      text " "
      P (&93834793840944)
        attr id "polarion_319"
        text " "
        SPAN (&93834793841424)
          attr style "font-weight: bold;"
          text "Schritt 13:"
        text " "
      text " "
      P (&93834793842144)
        attr id "polarion_320"
        text "Die RVE innerhalb von SGD 1 prüft das AUT-Zertifikat, die Client-Signatur des Client-ECIES-Schlüssels und den Client-ECIES-Schlüssel. (Hinweis: die RVE cacht die Prüfergebnisse ("
        SPAN (&93834793842624)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17896"
          attr data-item-id "ML-94695"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ").) Falls alle Prüfungen ein OK liefern, bereitet die RVE den Request auf (OCSP-Responses, Umkodierung für die Innenschnittstelle zum den SGD-HSM etc.) und übergibt die verschlüsselte Nachricht an das SGD-HSM. Das SGD-HSM entschlüsselt die Nachricht des Client und überprüft, ob das Authentisierungstoken konsistent mit dem Client-ECIES-Schlüssel und dem AUT-Zertifikat des Client ist. Falls ja überprüft es die Ableitungsregel und führt, falls der Client berechtigt ist, die Schlüsselableitung durch. Das Ergebnis verschlüsselt inkl. Authentisierungstoken, Request-ID und Ableitungsvektor das SGD-HSM für den Client. Das Chiffrat übergibt das SGD-HSM an die RVE, die es nach Umkodierung an den Client als Response weiterleitet."
      text " "
      P (&93834793844280)
        attr id "polarion_124"
        text "Die Schritte 14 bis 20 (siehe folgende Tabelle) sind analog zu den Schritten 9 bis 13, nur findet die Kommunikation zwischen Client und SGD 2 statt."
      text " "
      P (&93834793844880)
        attr id "polarion_128"
      text " "
      P (&93834793845360)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_71"
        text "Tabelle "
        SPAN (&93834793846016)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "3"
        text ": Tab_Übersicht_der_Kommunikationsschritte_eines_SGD-Clients"
      text " "
      TABLE (&93834793846912)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=305"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834793847568)
          text " "
          TR (&93834793847872)
            text " "
            TH (&93834793848176)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793848536)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Nr."
            text " "
            TH (&93834793849136)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793849496)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "SDG-Client"
            text " "
            TH (&93834793850096)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793850456)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "SGD 1"
            text " "
            TH (&93834793851056)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793851416)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "SGD 2"
            text " "
          text " "
          TR (&93834793852136)
            text " "
            TD (&93834793852440)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793852800)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "1"
            text " "
            TD (&93834793853400)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793853760)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetPublicKey bei SGD 1 aufrufen"
                BR (&93834793854240)
                text "Eingabe:"
                BR (&93834793854544)
                text "AUT-Zertifikat des Nutzers"
            text " "
            TD (&93834793854968)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834793855448)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834793856048)
            text " "
            TD (&93834793856352)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834793856712)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "2"
            text " "
            TD (&93834802292256)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802292712)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802293072)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetPublicKey"
                BR (&93834802293552)
                text "Aktion:"
                BR (&93834802293856)
                text "Prüfung des AUT-Zertifikats des Nutzers"
                BR (&93834802294160)
                text "Ausgabe:"
                BR (&93834802294464)
                text "aktueller signierter öffentlicher ECIES-Schlüssel des für den Nutzer avisierten SGD-HSM innerhalb des SGD 1"
            text " "
            TD (&93834802294888)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802295488)
            text " "
            TD (&93834802295792)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802296152)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "3"
                BR (&93834802296632)
                text " "
            text " "
            TD (&93834802297056)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802297416)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Prüfung des Zertifikats, der Signatur und des öffentlichen Schlüssels des SGD-HSM von SGD 1"
            text " "
            TD (&93834802298016)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802298496)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802299096)
            text " "
            TD (&93834802299400)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802299760)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "4"
                BR (&93834802300240)
                text " "
            text " "
            TD (&93834802300664)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802301024)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetPublicKey bei SGD 2 aufrufen"
                BR (&93834802301504)
                text "Eingabe:"
                BR (&93834802301808)
                text "AUT-Zertifikat des Nutzers"
            text " "
            TD (&93834802302232)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802302712)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802303312)
            text " "
            TD (&93834802303616)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802303976)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "5"
            text " "
            TD (&93834802304576)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802305056)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802305536)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802305896)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetPublicKey"
                BR (&93834802306376)
                text "Ausgabe:"
                BR (&93834802306680)
                text "aktueller signierter öffentlicher ECIES-Schlüssel des für den Nutzer avisierten SGD-HSM innerhalb des SGD 2"
            text " "
          text " "
          TR (&93834802307224)
            text " "
            TD (&93834802307528)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802307888)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "6"
                BR (&93834802308368)
                text " "
            text " "
            TD (&93834802308792)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802309152)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Prüfung des Zertifikats, der Signatur und des öffentlichen Schlüssels des SGD-HSM von SGD 2"
            text " "
            TD (&93834802309752)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802310232)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802310832)
            text " "
            TD (&93834802311136)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802311496)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "7"
                BR (&93834802311976)
                text " "
            text " "
            TD (&93834802312400)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802312760)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Berechnung der Hashwerte der öffentlichen ECIES-Schlüssel der beiden SGD-HSMs"
            text " "
            TD (&93834802313360)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802313840)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802314440)
            text " "
            TD (&93834802314744)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802315104)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "8"
                BR (&93834802315584)
                text " "
            text " "
            TD (&93834802316008)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802316368)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Erzeugung des Client-ECIES-Schlüsselpaars und Signatur des öffentlichen Schlüssel inkl. der Hashwerte aus Schritt 7 mittels eGK, SMC-B, SMC-KTR oder alternativer Authentisierung."
            text " "
            TD (&93834802316968)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802317448)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802318048)
            text " "
            TD (&93834802318352)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802318712)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "9"
                BR (&93834802319192)
                text " "
            text " "
            TD (&93834802319616)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802319976)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetAuthenticationToken bei SGD 1"
                BR (&93834802320456)
                text "Eingabe:"
                BR (&93834802320760)
                text "für SGD-HSM verschlüsselte Challenge (Zufallswert),"
                BR (&93834802321064)
                text "AUT-Zertifikat, signierte Schlüssel aus Schritt 8"
            text " "
            TD (&93834802321488)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802321968)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834802322568)
            text " "
            TD (&93834802322872)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802323232)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "10"
                BR (&93834802323712)
                text " "
            text " "
            TD (&93834802324136)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834802324616)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769371184)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetAuthenticationToken"
                BR (&93834769371664)
                text "Aktion:"
                BR (&93834769371968)
                text "Prüfung des AUT-Zertifikats,"
                BR (&93834769372272)
                text "Prüfung des Client-Signatur,"
                BR (&93834769372576)
                text "Prüfung des Client-ECIES-Schlüssels,"
                BR (&93834769372880)
                text "Entschlüsselung der Nachricht"
                BR (&93834769373184)
                text "Ausgabe:"
                BR (&93834769373488)
                text "Für den öffentlichen Client-ECIES-Schlüssel verschlüsselte Response."
                BR (&93834769373792)
                text "Innerhalb der Response befinden sich die Challenge des Clients (Zufallswert), das erzeugte Authentisierungstoken und der Hashwert des öffentlichen Client und des AUT-Zertifikats des Client."
            text " "
            TD (&93834769374216)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834769374816)
            text " "
            TD (&93834769375120)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769375480)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "11"
                BR (&93834769375960)
                text " "
            text " "
            TD (&93834769376384)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769376744)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Entschlüsselung der Antwort."
                BR (&93834769377224)
                text "Vergleich Challenge (Zufallswert) mit dem Wert aus der Response,"
                BR (&93834769377528)
                text "Vergleich des Hashwerts mit dem selbst erzeugten Hashwert,"
                BR (&93834769377832)
                text "Authentisierungstoken für SGD 1 lokal für die folgende Operation KeyDerivation zwischenspeichern"
            text " "
            TD (&93834769378256)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769378736)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834769379336)
            text " "
            TD (&93834769379640)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769380000)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "12"
                BR (&93834769380480)
                text " "
            text " "
            TD (&93834769380904)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769381264)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation KeyDerivation bei SGD 1 aufrufen"
                BR (&93834769381744)
                text "Eingabe:"
                BR (&93834769382048)
                text "für SGD-HSM verschlüsselte Nachricht:"
                BR (&93834769382352)
                text "Authentisierungstoken, zufällige Request-ID des Client, Ableitungsregel"
            text " "
            TD (&93834769382776)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769383256)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834769383856)
            text " "
            TD (&93834769384160)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769384520)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "13"
                BR (&93834769385000)
                text " "
            text " "
            TD (&93834769385424)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769385904)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769386264)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation KeyDerivation"
                BR (&93834769386744)
                text "Aktion:"
                BR (&93834769387048)
                text "Prüfung Authentisierungstoken"
                BR (&93834769387352)
                text "Ergebnis der Schlüsselableitung (vgl. Abschnitt"
                SPAN (&93834769387656)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94493"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ff) inkl. Prüfung der Berechtigung für die angeforderte Schlüsselableitung berechnen"
                BR (&93834769389016)
                text "Ausgabe:"
                BR (&93834769389320)
                text "für den öffentlichen Client-ECIES-Schlüssel verschlüsseltes Ergebnis der Schlüsselableitung"
            text " "
            TD (&93834769389744)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834769390344)
            text " "
            TD (&93834769390648)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769391008)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "14"
                BR (&93834769391488)
                text " "
            text " "
            TD (&93834769391912)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769392272)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Entschlüsselung der Antwort."
                BR (&93834769392752)
                text "Vergleich des Authentisierungstokens und der Request-ID in der Antwort mit den Werten aus dem Request,"
                BR (&93834769393056)
                text "Auslesen des abgeleiteten AES-256-Schlüsselwerts der vom SGD-HSM für den Client abgeleitet wurde, ggf. Auslesen des Ableitungsvektors"
            text " "
            TD (&93834769393480)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769393960)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834769394560)
            text " "
            TD (&93834769394864)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769395224)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "15"
                BR (&93834769395704)
                text " "
            text " "
            TD (&93834769396128)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769396488)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetAuthenticationToken bei SGD 2 aufrufen, analog zu Schritt 9"
            text " "
            TD (&93834769397088)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769397568)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834769398168)
            text " "
            TD (&93834769398472)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769398832)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "16"
                BR (&93834769399312)
                text " "
            text " "
            TD (&93834769399736)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769400216)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834769400696)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769401056)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation GetAuthenticationToken"
                BR (&93834769401536)
                text "analog zu Schritt 10 bei SGD 1"
            text " "
          text " "
          TR (&93834769402080)
            text " "
            TD (&93834769402384)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834769402744)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "17"
                BR (&93834769403224)
                text " "
            text " "
            TD (&93834764148136)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764148344)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Entschlüsselung der Antwort."
                BR (&93834764148824)
                text "Prüfungen analog zu Schritt 11"
            text " "
            TD (&93834764149248)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834764149728)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834764150328)
            text " "
            TD (&93834764150632)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764150992)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "18"
                BR (&93834764151472)
                text " "
            text " "
            TD (&93834764151896)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764152256)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation KeyDerivation bei SGD 2 aufrufen"
            text " "
            TD (&93834764152856)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834764153336)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834764153936)
            text " "
            TD (&93834764154240)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764154600)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "19"
                BR (&93834764155080)
                text " "
            text " "
            TD (&93834764155504)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834764155984)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834764156464)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764156824)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Operation KeyDerivation"
                BR (&93834764157304)
                text "analog zu Schritt 13 bei SGD 1"
            text " "
          text " "
          TR (&93834764157848)
            text " "
            TD (&93834764158152)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764158512)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "20"
                BR (&93834764158992)
                text " "
            text " "
            TD (&93834764159416)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834764159776)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Entschlüsselung der Antwort."
                BR (&93834764160256)
                text "Prüfungen analog zu Schritt 14"
            text " "
            TD (&93834764160680)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834764161160)
              attr style "vertical-align: top;height: 9pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
        text " "
      text " "
      P (&93834764162000)
        attr id "polarion_322"
        text "Der Client verwendet die erhaltenen beiden AES-256-Schlüssel je nach Anwendungsfall entweder für die Ver- oder die Entschlüsselung des Akten- und des Kontextschlüssels unter Verwendung des interoperablen Austauschformats nach Abschnitt "
        SPAN (&93834764162480)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94583"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " . Dabei befinden sich die verwendeten Ableitungsvektoren innerhalb der "associated data" (AD), so dass später die ausgeführte Aktion durch einen autorisierten Client reproduzierbar ist."
      text " "
      H3 (&93834764163960)
        attr id "2.4"
        text "2.4 Initiale Schlüsselableitung für den Kontoinhaber"
      text " "
      P (&93834764164560)
        attr id "polarion_158"
        text "Ein Versicherter (Kontoinhaber) eröffnet ein Konto und der verwendete Client (entweder das ePA-FdV oder das FM ePA) erzeugt den Akten- und Kontextschlüssel. Anschließend durchläuft der Client die Schritte 1 bis 20 aus Abschnitt "
        SPAN (&93834764165040)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94491"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " . Als Nachricht (verschlüsselte "EncryptedMessage" in  "
        SPAN (&93834764166400)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17898, Tab_KeyDerivation-Request"
          attr data-item-id "ML-94696"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) an die beiden SGD sendet der Client dabei jeweils eine Nachricht der Form"
      text " "
      P (&93834764168056)
        attr id "polarion_139"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834764168712)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> KeyDerivation r1:<KVNR>"
        text " "
      text " "
      P (&93834764169432)
        attr id "polarion_187"
        text "und erhält jeweils eine Antwort der Form"
      text " "
      P (&93834764170032)
        attr id "polarion_140"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834764170688)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> OK-KeyDerivation <AES-256-Bit-Schlüssel-in-Hexform> r1:<256-Bit-RND-in-Hexform>:<KVNR>:<aktueller Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834764171408)
        attr id "polarion_154"
        text "Die beiden nun erhaltenen AES-256-Schlüssel verwendet der Client zur zweifachen Verschlüsselung des von ihm erzeugten Akten- und Kontextschlüssel im "Zwiebelschalenprinzip" unter Verwendung des interoperablen Austauschformats nach Abschnitt "
        SPAN (&93834764171888)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94583"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " . Dabei verwendet der Client jeweils die beiden von den SGD erhaltenen Teilzeichenketten der Form "
        SPAN (&93834764173248)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text ""r1:<256-Bit-RND-in-Hexform>:<KVNR>:<Ableitungsschlüsselbezeichner>""
        text " als "associated data" (AD) bei der Kodierung. Dieses entsprechend erzeugte und kodierte Chiffrat schickt der Client an die "Komponente Autorisierung" zur Einlagerung im Aktensystem."
      text " "
      P (&93834764173968)
        attr id "polarion_179"
        text "Bei einer Umschlüsselung des Akten- und Kontextschlüssels bei einem späteren ePA-Release (vgl. Ende von Abschnitt"
        SPAN (&93834764174448)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94489"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) wird aufgrund des Einflusses der  jeweils vom SGD gewählten RND-Daten ein anderer Schlüssel generiert. Damit ist ein SGD nach aktueller Spezifikation schon jetzt auf diese Umschlüsselungsfunktionalität in Bezug auf die Client-Schnittstelle vorbereitet."
      text " "
      P (&93834764175928)
        attr id "polarion_243"
        text "Hinweis: in den folgenden Sequenzdiagrammen wird auf die Aufführung des Authentisierungstokens und der Request-ID in der Nachricht (Message) an die SGD verzichtet."
      text " "
      P (&93834764176528)
        attr data-keep-next "true"
        attr id "polarion_244"
        attr style "text-align: center;"
        text " "
        IMG (&93834764177360)
          attr data-keep-next "true"
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAAJHCAIAAAABtPtBAAAgAElEQVR4nOzdeZwT9f0/8Pf4FRaUW63V2iowWTVEqz0QEw9EQZMtsD2MWm3XKs3UM/FYrXaroKtU1yOpeCSidatWTT0iuBkFi3hsoNqfbTWsdTOwUg9qLadYRX10fn/MkTmT7G52Mzv7ej54aHaOz7znk8m85zNJ3mFEUSQAAICaQ0ICAAAn2F36H9..."
          attr style "width: 582px;height: 628px;"
        text " "
      text " "
      P (&93834764178312)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_80"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834764179144)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "3"
        text ": Initiale Schlüsselableitung für den Kontoinhaber"
      text " "
      H3 (&93834764180040)
        attr id "2.5"
        text "2.5 Schlüsselableitung durch den Kontoinhaber"
      text " "
      P (&93834764180640)
        attr id "polarion_210"
        text "Der Versicherte (Kontoinhaber) meldet sich beim Aktensystem an und erhält nach erfolgreicher Authentifizierung und Autorisierung die "AuthorizationKey"-Datenstruktur vom Aktensystem. Darin befindet sich das zweifach verschlüsselte Chiffrat aus Abschnitt "
        SPAN (&93834799830216)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ". Dort kann der Client aus den AD, durch Leerzeichen getrennt, jeweils den Ableitungsvektor für den SGD 1 und für den SGD 2 auslesen. Diese haben jeweils folgende Form:"
      text " "
      P (&93834799831696)
        attr id "polarion_199"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834799832352)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "r1:<256-Bit-RND-in-Hexform>:<KVNR>:<Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834799833072)
        attr id "polarion_268"
        text "Der Client sendet eine Nachricht der Form"
      text " "
      P (&93834799833672)
        attr id "polarion_155"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834799834328)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> KeyDerivation r1:<256-Bit-RND-in-Hexform>:<KVNR>:<Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834799835048)
        attr id "polarion_156"
        text "einmal an den SGD 1 und einmal an den SGD 2, jeweils mit den SGD-spezifischen Ableitungsvektoren. Nach "
        SPAN (&93834799835528)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17925"
          attr data-item-id "ML-94728"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " müssen die Abfragen zur Generierung der beiden Schlüssel durch den Client parallelisiert werden. Das SGD-HSM prüft die Authentizität der Nachricht und verwendet u. a.  die KVNR des Versicherten bei der Schlüsselableitung (versichertenindividuelle Schlüsselableitung). Der Client erhält die beiden gleichen AES-256-Schlüssel, die er wie zuvor in Abschnitt "
        SPAN (&93834799837064)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "erhalten hat. Die Antwort der SGD ist dabei analog zu Abschnitt "
        SPAN (&93834799838424)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94493"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "der folgenden"
      text " "
      P (&93834799839904)
        attr id "polarion_40"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834799840560)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> OK-KeyDerivation <AES-256-Bit-Schlüssel-in-Hexform> r1:<256-Bit-RND-in-Hexform>:<KVNR>:<aktueller Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834799841280)
        attr id "polarion_136"
        text "Nachdem beide Schlüssel (je einer aus SGD 1 und aus SGD 2) vorliegen, entschlüsselt der Client"
        SPAN (&93834799841760)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "(vgl. "
        SPAN (&93834799842240)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Krypt#A_17872]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94669"
          attr id "fake"
        SPAN (&93834799843480)
          attr style "font-size: 10pt;line-height: 1.5;"
          text " )"
        text "das zweifach verschlüsselte Chiffrat im "Zwiebelschalenprinzip" mittels AES-GCM. Dabei prüft es die Authentizität der Chiffrats und der AD (Authenticated Encryption with Associated Data (AEAD)) bzw. damit auch die Authentizität des erhaltenen Klartextes. "
      text " "
      P (&93834799844200)
        attr id "polarion_180"
        text "Im Nicht-Fehlerfall liegen danach der Akten- und Kontext-Schlüssel in der Kodierung nach"
        SPAN (&93834799844680)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17930"
          attr data-item-id "ML-94737"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " vor."
      text " "
      P (&93834799846336)
        attr id "polarion_220"
        text "Dieses Vorgehen funktioniert unabhängig davon, ob der Versicherte seine eGK (oder alternative Versichertenidentität) wie bei der Aktenkontoeröffnung oder eine Folgekarte (oder "Folge"-Identität) verwendet."
      text " "
      P (&93834799846936)
        attr id "polarion_234"
      text " "
      P (&93834799847416)
        attr data-keep-next "true"
        attr id "polarion_235"
        attr style "text-align: center;"
        text " "
        IMG (&93834799848248)
          attr data-keep-next "true"
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhwAAAGlCAIAAAA+sbgLAAAgAElEQVR4nO3de5wT1fk/8Of4FRFdYBe0CloBmWx1jbZqq5h4wQtosgXXqrFadK3QTFU0sbJY7SpQ1+uiJvWaqOh6N94CuBlFpXjZiLZf/VbDajcDC16Kl8ICQnXRX+f3x1wySSbZ7O7sJpn9vF+WZudy5jlnJvPMmUlOmCRJBAAAYAokFQAAMMuu8v..."
          attr style "width: 582px;height: 453px;"
        text " "
      text " "
      P (&93834799849200)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_87"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834799850032)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "4"
        text ": Schlüsselableitung durch den Kontoinhaber"
      text " "
      H3 (&93834799850928)
        attr id "2.6"
        text "2.6 Schlüsselableitung für einen Berechtigungsempfänger"
      text " "
      P (&93834799851528)
        attr id "polarion_37"
        text "Für das Berechtigen eines Vertreters, einer LEI oder eines KTR durch den Kontoinhaber muss der Client des Kontoinhabers den Akten- und Kontextschlüssel für einen Berechtigungsempfänger verschlüsselten im Aktensystem hinterlegen. Hierfür liegen der Akten- und Kontextschlüssel temporär im Client des Kontoinhabers im Klartext vor. Der Client fragt jeweils SGD 1 und SDG 2 für eine für diesen Anwendungsfall spezifische Schlüsselableitung (r2) an."
      text " "
      P (&93834799852128)
        attr id "polarion_115"
        text "Der Client sendet jeweils eine Nachricht der Form"
      text " "
      P (&93834799852728)
        attr id "polarion_213"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834799853384)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> KeyDerivation r2:<KVNR-Vertreter oder Telematik-ID>"
        text " "
      text " "
      P (&93834799854104)
        attr id "polarion_214"
        text "an beide SGD und erhält jeweils eine Antwort der Form"
      text " "
      P (&93834799854704)
        attr id "polarion_219"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834799855360)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> OK-KeyDerivation <AES-256-Bit-Schlüssel-in-Hexform> r2:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter oder Telematik-ID>:<aktueller Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834799856080)
        attr id "polarion_222"
        text "Mit beiden erhaltenen Schlüsseln verschlüsselt der Client den Akten- und Kontextschlüssel und kodiert nach "
        SPAN (&93834799856560)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17930"
          attr data-item-id "ML-94737"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " das zweifach verschlüsselte Chiffrat. Dabei werden die Ableitungsinformationen ebenfalls authentitäts- und integritätsgeschützt (AEAD). Die vom Client erzeugte Datenstruktur wird im Aktensystem für den Berechtigungsempfänger hinterlegt."
      text " "
      P (&93834799858216)
        attr id "polarion_246"
      text " "
      P (&93834799858696)
        attr data-keep-next "true"
        attr id "polarion_247"
        attr style "text-align: center;"
        text " "
        IMG (&93834799859528)
          attr data-keep-next "true"
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjoAAAJ1CAIAAABfJM0uAAAgAElEQVR4nOy9e5wT1fn4/4wfYUG5LKC2YCsCk1Vj9OOtiokKIlCTFdh+q9G2tmuVZj4qmlRdrXarYtfrok0qXhLxslVbjVojdDMIikLdQG0/ttWw1s3AStUP9bos4mXVn/P7Y25nrplkc9lMnvfL0tmZc57znOecnGfOOTPPUDzPA4IgCIKMcNBdIQ..."
          attr style "width: 582px;height: 642px;"
        text " "
      text " "
      P (&93834799860480)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_90"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834799861312)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "5"
        text ": Schlüsselableitung für einen Berechtigungsempfänger"
      text " "
      H3 (&93834799862208)
        attr id "2.7"
        text "2.7 Schlüsselableitung durch einen Berechtigten"
      text " "
      P (&93834810784656)
        attr id "polarion_228"
        text "Ein Vertreter, eine LEI bzw. ein KTR meldet sich am Aktensystem an und erhält die AuthorizationKeys-Datenstruktur. Dort befindet sich das zuvor vom Versicherten hinterlegte zweifach verschlüsselte Chiffrat mit dem verschlüsselten Akten- und Kontextschlüssel. In den AD sind die Ableitungsinformationen enthaltenen, die ein Client für die Anfragen an die beiden SGD benötigt. Der Client sendet jeweils an die SGD eine Nachricht der folgenden Form"
      text " "
      P (&93834810785232)
        attr id "polarion_229"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834810785888)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> KeyDerivation r2:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter oder Telematik-ID>:<Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834810786608)
        attr id "polarion_230"
        text "und erhält jeweils eine Antwort der Form"
      text " "
      P (&93834810787208)
        attr id "polarion_231"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834810787864)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> OK-KeyDerivation <AES-256-Bit-Schlüssel-in-Hexform> r2:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter oder Telematik-ID>:<Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834810788584)
        attr id "polarion_232"
        text "Das SGD-HSM prüft, ob im vierten Feld der Ableitungsinformationen ""
        SPAN (&93834810789064)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "<KVNR-Vertreter oder Telematik-ID>"
        text "" zu den authentischen Angaben passt, die im Zertifikat der Anfrage stehen (plus Signaturprüfung, Sperrstatus u. v. m.). Bei erfolgreicher Prüfung führt das SGD-HSM die Ableitung durch und übergibt dem Client die generierten Schlüssel über den verschlüsselten und beidseitig authentisierten Datenkanal zwischen Client und SGD-HSM."
      text " "
      P (&93834810789784)
        attr id "polarion_233"
        text "Der Client kann nun das zweifach verschlüsselte Chiffrat entschlüsseln und ihm stehen der Akten- und der Kontextschlüssel zur Verfügung."
      text " "
      P (&93834810790384)
        attr id "polarion_249"
      text " "
      P (&93834810790864)
        attr data-keep-next "true"
        attr id "polarion_250"
        attr style "text-align: center;"
        text " "
        IMG (&93834810791696)
          attr data-keep-next "true"
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhwAAAISCAIAAAAIloFbAAAgAElEQVR4nOyde5wT1dn4n2OFBVz2AmiFUhCYbDVGXy+tQoICCmiyBeNbjbZV1wrNvCqaeFmsuirqel20Sb0mgnW9VI2XBuhmEBAB3UBtq60NS90MLIgWb7CAKK76c35/zCUzmUk2uztJJpPn+6E2O+ec5zznmZPzzHMm8wzhOA4QBEEQRBfQqSAIgi..."
          attr style "width: 582px;height: 574px;"
        text " "
      text " "
      P (&93834810792648)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_91"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834810793480)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "6"
        text ": Schlüsselableitung durch einen Berechtigten"
      text " "
      H3 (&93834810794376)
        attr id "2.8"
        text "2.8 Schlüsselableitung für einen Berechtigungsempfänger durch einen Vertreter"
      text " "
      P (&93834810794976)
        attr id "polarion_223"
        text "Der Vertreter ist am Aktensystem angemeldet und möchte im Rahmen seiner Vertretungstätigkeit im Aktensystem eine LEI oder einen KTR berechtigen. Dafür muss der Client des Vertreters den Akten- und den Kontextschlüssel der Akte des Kontoinhabers für den Berechtigungsempfänger verschlüsselt hinterlegen."
      text " "
      P (&93834810795576)
        attr id "polarion_236"
        text "Der Client sendet jeweils die Nachricht"
      text " "
      P (&93834810796176)
        attr id "polarion_224"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834810796832)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> KeyDerivation r3:<Telematik-ID>:<KVNR-Kontoinhaber>"
        text " "
      text " "
      P (&93834810797552)
        attr id "polarion_225"
        text "und erhält jeweils eine Antwort der Form"
      text " "
      P (&93834810798152)
        attr id "polarion_226"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834810798808)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> OK-KeyDerivation <AES-256-Bit-Schlüssel-in-Hexform> r3:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter>:<Telematik-ID>:<aktueller Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834810799528)
        attr id "polarion_227"
        text "Mit den beiden von den SGD erhaltenen Schlüsseln verschlüsselt der Client den Akten- und Kontextschlüssel und bildet eine Datenstruktur gemäß "
        SPAN (&93834810800008)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17930"
          attr data-item-id "ML-94737"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ". Diese wird für den Berechtigungsempfänger im Aktensystem hinterlegt."
      text " "
      P (&93834810801664)
        attr id "polarion_252"
      text " "
      P (&93834810802144)
        attr data-keep-next "true"
        attr id "polarion_253"
        attr style "text-align: center;"
        text " "
        IMG (&93834810802976)
          attr data-keep-next "true"
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkoAAAKgCAIAAADrnsUqAAAgAElEQVR4nOy9e5wT1fn4/4wfYUG5LHhpQVsEJqvGaL3VQoICCtRkC2y/1ai9rRea+ahoUnW12q3XtVYXbVLxkojWrVo11Rqhm0FQFOoGPtaPbTXEuhlYqfqhXnBZxMuqP+f3x9zOXDPJZjfJ5Hm/LM3OnPOc5zznzDzznJl5huJ5HhAEQRDEYaB7Qx..."
          attr style "width: 582px;height: 668px;"
        text " "
      text " "
      P (&93834810803928)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_92"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834810804760)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "7"
        text ": Schlüsselableitung für einen Berechtigungsempfänger durch einen Vertreter"
      text " "
      H3 (&93834810805656)
        attr id "2.9"
        text "2.9 Schlüsselableitung für einen durch einen Vertreter berechtigten Berechtigten"
      text " "
      P (&93834810806256)
        attr id "polarion_157"
        text "Analog zu Abschnitt"
        SPAN (&93834810806736)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94739"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " verwendet der Client der LEI die AuthorizationKeys-Datenstruktur und die darin befindlichen AD. Der Client verwendet die Ableitungsvektoren aus den AD (diese werden mit "r3:" beginnen). Mit diesen beiden Ableitungsvektoren fragt der Client parallel jeweils SGD  1 und SGD 2 an, jeweils mit einer Nachricht der Form"
      text " "
      P (&93834810808216)
        attr id "polarion_2"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834810808872)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> KeyDerivation r3:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter>:<Telematik-ID>:<aktueller Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834810809592)
        attr id "polarion_76"
        text "und erhält jeweils eine Antwort der Form"
      text " "
      P (&93834810810192)
        attr id "polarion_111"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834810810848)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "AT<256-Bit-Authentisierungstokenwert-in-Hexform> <Request-ID> OK-KeyDerivation <AES-256-Bit-Schlüssel-in-Hexform> r3:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter>:<Telematik-ID>:<aktueller Ableitungsschlüsselbezeichner>"
        text " "
      text " "
      P (&93834810811568)
        attr id "polarion_237"
        text "Dabei prüft das SGD-HSM innerhalb eines SGD zuvor, ob das Datenfeld"
        SPAN (&93834810812048)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text ""<Telematik-ID>""
        text "in den Ableitungsinformationen zu den authentischen Angaben passt, die im Zertifikat der Anfrage stehen (plus Signaturprüfung, Sperrstatus u. v. m.). Bei erfolgreicher Prüfung führt das SGD-HSM die Ableitung durch und übergibt dem Client die generierten Schlüssel über den verschlüsselten und beidseitig authentisierten Datenkanal."
      text " "
      P (&93834810812768)
        attr id "polarion_241"
        text "Der Client kann nun das zweifach verschlüsselte Chiffrat entschlüsseln und ihm stehen der Akten- und der Kontextschlüssel zur Verfügung."
      text " "
      P (&93834810813368)
        attr id "polarion_255"
      text " "
      P (&93834810813848)
        attr data-keep-next "true"
        attr id "polarion_256"
        attr style "text-align: center;"
        text " "
        IMG (&93834810814680)
          attr data-keep-next "true"
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAigAAAIMCAIAAABQUsDyAAAgAElEQVR4nOydeZwTRfbAX/mTGcBhDsADluXszEqI/rxWIUEBOTSZBeKuRtdrXGG7fyqaeAyuOgroeA5q4p0IruOxajw2wk4aARHQCazrquuGYZ00jHixHjAwojjqx/790Ue6051MksnkfN/PiJ2uqlevXlfqdVV3XhGe5wFBEARBsgY6HgRBECSbHC..."
          attr style "width: 582px;height: 552px;"
        text " "
      text " "
      P (&93834810815632)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_96"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834810816464)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "8"
        text ": Schlüsselableitung für einen durch einen Vertreter berechtigten Berechtigten"
      text " "
      P (&93834810817440)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_110"
      text " "
      H3 (&93834810818072)
        attr id "2.10"
        text "2.10 Nichtspeicherung von Versichertendaten"
      text " "
      P (&93834810818672)
        attr id "polarion_159"
        text "Ein SGD speichert keine versichertenspezifischen Daten. Die Berechnung der versichertenindividuellen Schlüssel ist eine kryptographische Berechnung (Schlüsselableitung) auf Grundlage des jeweiligen SGD-spezifischen Ableitungsschlüssels und vom Client authentisiert übergebener Ableitungsvektoren. Ein solcher versichertenindividueller Schlüssel wird nur nach erfolgreicher Authentifizierung eines anfragenden Versicherten berechnet und nach der verschlüsselten Übertragung an den Versicherten sofort wieder im SGD-HSM gelöscht. Für den Aufbau des beidseitig authentisierten verschlüsselten Datenkanals zwischen SGD-HSM und Client wird das AUT-Zertifikat des Nutzes (bspw. des Versicherten) kurzzeitig benötigt. Dieses Zertifikat wird vom SGD nicht persistent gespeichert ("
        SPAN (&93834810819152)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17965"
          attr data-item-id "ML-94843"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " )."
      text " "
      H3 (&93834810820808)
        attr id "2.11"
        text "2.11 Besondere Rolle SGD-HSM"
      text " "
      P (&93834810821408)
        attr id "polarion_185"
        text "Das SGD-HSM mit seinem speziellen HSM-Firmware-Modul und den begleitenden technischen und organisatorischen Prozessen ermöglicht es mit hoher Sicherheit, eine durch den Betreiber bestimmte Schlüsselableitung innerhalb des SGD auszuschließen. Das SGD-HSM entscheidet, ob eine ausreichende Authentifizierung stattgefunden hat und führt erst danach die Schlüsselableitung durch. Anschließend überträgt es die abgeleiteten spezifischen Schlüssel über einen beidseitig authentisierten und verschlüsselten Datenkanal (Ende-zu-Ende-Sicherheit) zum Client."
      text " "
      P (&93834810822008)
        attr id "polarion_186"
        text "Damit dies möglich wird, muss man auf die Einschränkungen der Embedded-Umgebung, in dem das SGD-HSM-Firmware arbeitet, eingehen:"
      text " "
      OL (&93834810822608)
        attr id "polarion_189"
        text " "
        LI (&93834810823088)
          text "Die Performanzvorgaben verbieten ähnlich wie in einer Chipkarte die Verwendung eines Ende-zu-Ende geführten TLS-Kanals. Bei Chipkarten verwendet man anstatt eines TLS-Kanals ein Secure-Messaging (Anwendung VSDM).  Die Ende-zu-Ende-verschlüsselte Datenverbindung zwischen Client und SGD-HSM verwendet das ECIES-Verfahren (vgl. Abschnitt "
          SPAN (&93834810823392)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94770"
            attr data-option-id "longoutline"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text ") für das es einen kryptographischen Sicherheitsbeweis gibt."
          BR (&93834810824752)
          text "Zusammen mit den alle 15 Minuten wechselnden ECIES-Verbindungsschlüsseln eines SGD-HSM ermöglicht dieses Vorgehen die in Bezug auf die Clients zustandslose Abarbeitung von Requests innerhalb des SGD-HSMs."
        text " "
        LI (&93834810825176)
          text "Ähnlich wie die Zertifikatsprüfung in einer Chipkarte kann die Zertifikatsprüfung im SGD-HSM nicht auf der relativ komplexen TSL-Auswertung basieren. Anstatt der TSL-Auswertung wird u. a. die Rückführbarkeit zur X.509-Root der TI und weiteren im SGD-HSM sicher gespeicherten CA-Zertifikaten der TI bei der Zertifikatsprüfung verwendet (vgl. Abschnitt"
          SPAN (&93834810825480)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94534"
            attr data-option-id "longoutline"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text " )."
        text " "
      text " "
      H2 (&93834810827080)
        attr id "3"
        text "3 Übergreifende Festlegungen"
      text " "
      H3 (&93834810827680)
        attr id "3.1"
        text "3.1 Beziehung zwischen ePA-Aktensystem und SGD"
      text " "
      P (&93834810828280)
        attr id "polarion_67"
        text "Für einen Versicherten müssen zwei unabhängige SGD-Instanzen zur parallelen Nutzung für die zweifache Schlüsselgenerierung zur Verfügung stehen. Beide SGD müssen dabei technisch, organisatorisch und wirtschaftlich unabhängig sein. Um dies sicherzustellen, gibt es einen SGD, den alle Aktensysteme als SGD 2 verwenden ("
        SPAN (&93834810828760)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17881"
          attr data-item-id "ML-94679"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). "
      text " "
      DIV (&93834810830416)
        attr id "A_17881"
        text " "
        P (&93834810830896)
          B (&93834810831080)
            text "A_17881 - Anbieter SGD - Rollenausschluss für Anbieter des SGD der zentralen TI-Plattform"
        text " "
        P (&93834810831504)
          text "Der Anbieter des Schlüsselgenerierungsdienstes der zentralen TI-Plattform MUSS unabhängig von Anbietern von ePA-Aktensystemen sein, d. h. es sind mindestens jeweils eigenständige Rechtspersönlichkeiten mit eigenständigen operativen Geschäfts- und Betriebsführungen und es ist eine strikte Vermeidung von Personenidentitäten bzw. Doppelrollen in den Funktionen Geschäftsführung, leitende Mitarbeiter und Zugangsberechtigte zum Betriebsort des Schlüsselgenerierungsdienstes bzw. ePA-Aktensystems gewährleistet."
          B (&93834810831808)
            text "[<=]"
        text " "
      text " "
      DIV (&93834810832352)
        attr id "A_17883"
        text " "
        P (&93834810832832)
          B (&93834810833016)
            text "A_17883 - Weiterführung der Schlüsselableitungsfunktionalität bei SGD-Instanzwechsel"
        text " "
        P (&93834810833440)
          text "Ein Anbieter eines ePA-Aktensystems und ein Anbieter eines SGD ePA MÜSSEN beim Wechsel ihrer jeweiligen SGD-Instanz die Weiterführung der Schlüsselableitungsfunktionalität ePA sicherstellen."
          B (&93834810833744)
            text "[<=]"
        text " "
      text " "
      DIV (&93834810834288)
        attr id "A_17884"
        text " "
        P (&93834810834768)
          B (&93834810834952)
            text "A_17884 - Migrationskonzept bei SGD-Instanzwechsel"
        text " "
        P (&93834810835376)
          text "Ein Anbieter eines ePA-Aktensystems und Anbieter eines SGD ePA MÜSSEN ein Migrationskonzept erstellen und pflegen, worin festgelegt wird, wie beim Wechsel ihrer SGD-Instanz die für deren Kunden verwendeten Ableitungsschlüssel sicher an die SGD-Folgeinstanz übergeben werden."
          B (&93834810835680)
            text "[<=]"
        text " "
      text " "
      DIV (&93834810836224)
        attr id "A_17885"
        text " "
        P (&93834810836704)
          B (&93834810836888)
            text "A_17885 - ePA-Aktensystem-spezifische Ableitungsschlüssel eines SGD-Instanz"
        text " "
        P (&93834810837312)
          text "Ein Anbieter eines ePA-Aktensystems MUSS sicherstellen, dass die von ihm verwendete SGD-Instanz (d. h. technisch formuliert "SGD 1") ePA-Aktensystemanbieter-spezifische Ableitungsschlüssel (Schlüsselableitungsfunktionalität ePA) verwendet."
          B (&93834810837616)
            text "[<=]"
        text " "
      text " "
      DIV (&93834810838160)
        attr id "A_17886"
        text " "
        P (&93834810838640)
          B (&93834810838824)
            text "A_17886 - Migration SGD-Instanz"
        text " "
        P (&93834810839248)
          text "Ein Anbieter eines ePA-Aktensystems MUSS beim Wechsel der SGD-Instanz (vgl."
          SPAN (&93834810839552)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17884"
            attr data-item-id "ML-94682"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text "alle Ableitungsschlüssel sicher an die SGD-Folgeinstanz übergeben und anschließend sicher in der alten SGD-Instanz löschen."
          B (&93834810840912)
            text "[<=]"
        text " "
      text " "
      H3 (&93834810841456)
        attr id "3.2"
        text "3.2 Verfügbarkeit und Performanz"
      text " "
      P (&93834810842056)
        attr id "polarion_42"
        text "Verfügbarkeits- und Performanzanforderungen für einen SGD befinden sich in"
        SPAN (&93834810842536)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Perf#Produkttyp Schlüsselgenerierungsdienst]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Perf?selection=ML-94477"
          attr id "fake"
        text " und sind dem Produkttypsteckbrief SGD zugewiesen."
      text " "
      H3 (&93834810844016)
        attr id "3.3"
        text "3.3 Sichere Betreiberumgebung"
      text " "
      P (&93834810844616)
        attr id "polarion_94"
        text "Ähnlich wie einem TSP werden an den Betreiber eines SGD ePA Anforderungen u. a. an die sichere Betreiberumgebung aus [gemSpec_DS_Anbieter] gestellt (vgl. Zuordnung im Produkttypsteckbrief). Die zugeordneten Module sind "Basis-IS", "Basis-ISMS", "Erweitertes ISMS", "TI-Sicherheitsbericht" und "„Erweiterter TI-Sicherheitsbericht“."
      text " "
      DIV (&93834810845216)
        attr id "A_18956"
        text " "
        P (&93834810845696)
          B (&93834810845880)
            text "A_18956 - Sicherer Betrieb des Produkts nach Handbuch"
        text " "
        P (&93834810846304)
          text "Der Anbieter eines Schlüsselgenerierungsdiensts MUSS die im Handbuch des eingesetzten Schlüsselgenerierungsdienstes beschriebenen Voraussetzungen für den sicheren Betrieb des Produktes gewährleisten."
          B (&93834810846608)
            text "[<=]"
        text " "
      text " "
      DIV (&93834810847152)
        attr id "A_18955"
        text " "
        P (&93834810847632)
          B (&93834810847816)
            text "A_18955 - Darstellen der Voraussetzungen für sicheren Betrieb des Produkts im Handbuch"
        text " "
        P (&93834810848240)
          text "Der Hersteller des Schlüsselgenerierungsdienstes MUSS für sein Produkt im dazugehörigen Handbuch leicht ersichtlich darstellen, welche Voraussetzungen vom Betreiber und der Betriebsumgebung erfüllt werden müssen, damit ein sicherer Betrieb des Produktes gewährleistet werden kann."
          B (&93834810848544)
            text "[<=]"
        text " "
      text " "
      H3 (&93834810849088)
        attr id "3.4"
        text "3.4 Verschiedenes"
      text " "
      DIV (&93834810849688)
        attr id "A_17880"
        text " "
        P (&93834772229424)
          B (&93834772229608)
            text "A_17880 - Zeitsynchronität mit der TI"
        text " "
        P (&93834772230032)
          text "Ein SGD ePA MUSS mit den Stratum-1-NTP-Servern der TI synchronisieren."
          B (&93834772230336)
            text "[<=]"
        text " "
      text " "
      P (&93834772230880)
        attr id "polarion_245"
        text "Eine korrekte Zeit ist im SGD an drei Stellen wichtig: "
      text " "
      OL (&93834772231456)
        attr id "polarion_248"
        text " "
        LI (&93834772231936)
          text "für die EE-Zertifikatsprüfung in der RVE (ist der aktueller Prüfzeitpunkt innerhalb der Gültigkeitsdauer des zu prüfenden EE-Zertifikats),"
        text " "
        LI (&93834772232360)
          text "für die EE-Zertifikatsprüfung in den SGD-HSM, und"
        text " "
        LI (&93834772232784)
          text "für Zeitstempel bei Logdaten, die für die Fehleranalyse im SGD erhoben werden können."
        text " "
      text " "
      P (&93834772233328)
        attr id "polarion_251"
        text "Keiner dieser Anwendungszwecke verlangt, dass die Zeit in den o. g. Teilkomponenten im einstelligen Millisekundenbereich korrekt ist. "
      text " "
      P (&93834772233928)
        attr id "polarion_259"
        text "Eine Zeitdrift von weniger als 5 Minuten innerhalb des SGD (RVE, SGD-HSM) ist aus Sicherheitssicht akzeptabel."
      text " "
      P (&93834772234528)
        attr id "polarion_283"
        text "Die praktische Erfahrung nach mehr als einen Jahr mit verschiedenen SGDs in der PU zeigt, dass es notwendig ist die Zeit in den SGD-HSM kontinuierlich über NTP zu korrigieren. Die HSMs besitzen je nach Hersteller unterschiedliche Mechanismen, die eine schädliche Auswirkung einer temporärer Fehlfunktion des verwendeten NTP-Servers verhindern (ruckartige Änderungen über in den SGD-HSM konfigurierte Schrankenwerte)."
      text " "
      P (&93834772235128)
        attr id "polarion_291"
        text "Ein weiterer Erfahrungswert ist, dass ein Nachgehen der lokalen Zeit in den SGD-HSM um mehr als 5 Minuten insbesondere die Verfügbarkeit des SGD gefährdet, da dann i. d. R. OCSP-Antworten aus der Zukunft zu kommen scheinen, der akzeptable Schwellwert dafür dann überschritten ist und vom einen SGD-HSM die OCSP-Antworten abgelehnt werden."
      text " "
      DIV (&93834772235728)
        attr id "A_22485"
        text " "
        P (&93834772236208)
          B (&93834772236392)
            text "A_22485 - SGD, verpflichtende automatisierte Zeit-Synchronisation (NTP) SGD-HSM"
        text " "
        P (&93834772236816)
          text "Der Anbieter eines SGD ePA MUSS sicherstellen, dass die SGD-HSM in dessen SGD per NTP synchronisiert werden. Die dabei zu verwendenden Schwellwerte (HSM-Hersteller-spezifische Mechanismen in den HSM, um die schädliche Auswirkung von temporären Fehlfunktionen des verwendeten NTP-Servers zu verhindern) werden während der Erst-Initialisierung zusammen mit der gematik in den SGD-HSM festgelegt."
          SPAN (&93834772237120)
            attr style "background-color: #FFFF99;"
          text " "
          B (&93834772237600)
            text "[<=]"
        text " "
      text " "
      P (&93834772238144)
        attr id "polarion_254"
        text "Ebenfalls ist ein betriebliches Monitoring der Zeit in den SGD-HSM notwendig."
      text " "
      DIV (&93834772238744)
        attr id "A_22486"
        text " "
        P (&93834772239224)
          B (&93834772239408)
            text "A_22486 - Monitoring Zeit in den SGD-HSM"
        text " "
        P (&93834772239832)
          text "Der Anbieter eines SGD ePA MUSS sicherstellen, dass die Uhrzeit in den SGD-HSM in dessen SGD mindestens täglich automatisiert überwacht wird und bei substanziellen Abweichungen (bspw. mehr als +- 15 Sekunden) eine automatische Alarmierung an die SGD-HSM-Administration erfolgt. Die SGD-HSM-Administration MUSS bei Alarmierung dann Schritte zur Korrektur der Uhrzeit in den SGD-HSM ergreifen."
          SPAN (&93834772240136)
            attr style "background-color: #FFFF99;"
          text " "
          B (&93834772240616)
            text "[<=]"
        text " "
      text " "
      H2 (&93834772241160)
        attr id "4"
        text "4 Bestandteile eines SGD"
      text " "
      P (&93834772241760)
        attr id "polarion_44"
        text "Ein SGD besteht aus"
      text " "
      OL (&93834772242360)
        attr id "polarion_72"
        text " "
        LI (&93834772242840)
          text "einer HTTPS-Schnittstelle (vgl. "
          SPAN (&93834772243144)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17889"
            attr data-item-id "ML-94687"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "workItem"
            attr id "fake"
          text ") innerhalb der TI,"
        text " "
        LI (&93834772244800)
          text "einer Request verarbeitenden Einheit ("
          SPAN (&93834772245104)
            attr class "polarion-rte-link"
            attr data-custom-label "RVE"
            attr data-item-id "ML-94519"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text ") für die eingehenden HTTP-Requests, und"
        text " "
        LI (&93834772246760)
          text "einem (oder mehreren) HSM (SGD-HSM genannt), das den wesentlichen Teil der Sicherheitsleistung des SGD erbringt."
        text " "
      text " "
      P (&93834772247304)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_118"
        attr style "text-align: center;"
        text " "
        IMG (&93834772248136)
          attr src "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiQAAAGzCAYAAAAfeAwWAAAgAElEQVR4Ae3dDWwe9Z3g8V+6tGVLdzElF+LLhRjW7ma7dYKF4CA+Nli3PkiqC2mi2xJXe4mRGoIUHWA1AoR10DsjiHLnJKtIJFkpdrSqQ1dySCM1L+fTGS9r2oKQSdxts7WXGqLIIZcKd3fbor2qPv1mnnmemXlmnmee55l5nnn5Wor8PPPyf/n8HT..."
          attr style "width: 400px;height: 317px;"
        text " "
      text " "
      P (&93834772248912)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_123"
        attr style "text-align: center;"
        text "Abbildung"
        SPAN (&93834772249744)
          attr class "polarion-rte-caption"
          attr data-sequence "Abbildung"
          text "9"
        text ": Strukturelemente eines SGD"
      text " "
      P (&93834772250640)
        attr id "polarion_97"
      text " "
      H3 (&93834772251120)
        attr id "4.1"
        text "4.1 Request-Verarbeitung in einem SGD"
      text " "
      P (&93834772251720)
        attr id "polarion_112"
        text "Eingehende Requests eines Clients werden von der Request verarbeitenden Einheit (RVE) an der HTTPS-Außenschnittstelle (vgl."
        SPAN (&93834772252200)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17889"
          attr data-item-id "ML-94687"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) entgegengenommen. Dort werden sie entweder direkt beantwortet (Operation GetPublicKey, A_17895-*) oder aufbereitet und danach an das SGD-HSM gesendet. Abhängig von der Antwort des SGD-HSM erzeugt die RVE eine Antwort für den Client ("
        SPAN (&93834772253736)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17908-01"
          attr data-item-id "ML-109359"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ) und sendet diese an ihn. Die RVE hat keinen Einblick in den beidseitig authentisierten und verschlüsselten Datenkanal zwischen Client und SGD-HSM (vgl. Abschnitt "
        SPAN (&93834772255272)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94770"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). Die RVE stellt nur in Bezug auf die Verfügbarkeit (DoS-Gegenmaßnahmen, Einholen von signierten OCSP-Responses, Umkodieren von Requests etc.) des SGD eine kritische Komponente dar. In Bezug auf die Vertraulichkeit der Schlüssel erbringt sie keine Sicherheitsleistung."
      text " "
      P (&93834772256752)
        attr id "polarion_113"
        text "Die Schnittstelle zwischen RVE und SGD-HSM ist eine Innenschnittstelle (vgl. Abschnitt "
        SPAN (&93834772257232)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94070"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") und wird deshalb nicht ausspezifiziert beschrieben. Es werden nur notwendige Festlegungen getroffen."
      text " "
      DIV (&93834772258712)
        attr id "A_17908-01"
        text " "
        P (&93834772259192)
          B (&93834772259376)
            text "A_17908-01 - Request-Verarbeitung in der SGD"
        text " "
        P (&93834772259800)
          text "Die Request verarbeitende Einheit (RVE) eines SGD ePA MUSS alle Informationen, die ein SGD-HSM für die Zertifikatsprüfung nach "
          SPAN (&93834772260104)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17919-01"
            attr data-item-id "ML-109357"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  benötigt, bereitstellen und dem SGD-HSM bei der Weiterleitung des Requests übergeben."
          BR (&93834772261464)
          text "Wenn die RVE erkennt, dass die Informationen dem SGD-HSM nicht ausreichen werden, so MUSS die RVE die Weiterleitung an die SGD-HSM abbrechen (i. S. v. gar nicht erst durchführen) und den Request mit einer Fehlermeldung, so wie in den Außenschnittstellen beschrieben, beantworten."
          BR (&93834772261768)
          text " "
          B (&93834783644872)
            text "[<=]"
        text " "
      text " "
      P (&93834783645416)
        attr id "polarion_197"
        text "Ein SGD-HSM wird auf einen von der RVE weitergeleiteten Request in fünf Weisen antworten:"
      text " "
      OL (&93834783646016)
        attr id "polarion_178"
        text " "
        LI (&93834783646496)
          text "Die Authentizität des Requests ist nicht gegeben (bspw. AES-GCM meldet FAIL oder das Authentisierungstoken ist ungültig), das SGD-HSM meldet FAIL. Die RVE muss, so wie in den Außenschnittstellen beschrieben, eine Fehlermeldung an den Client senden."
        text " "
        LI (&93834783646920)
          text "Die Authentifizierung war erfolgreich und die Schlüsselableitung wurde durchgeführt. Übergeben wird der RVE das Chiffrat für den Client. Die RVE muss die Antwort-Datenstruktur, so wie bei der Operation KeyDerivation ("
          SPAN (&93834783647224)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text " ) beschrieben, kodieren und dem Client diese als Response senden."
        text " "
        LI (&93834783648880)
          text "Die Authentifizierung war erfolgreich und die Schlüsselableitung wurde nicht durchgeführt, weil der Klartext-Request des Client falsch formatiert ist. Das SGD-HSM erzeugt eine entsprechende Fehlermeldung für die RVE und übergibt diese an die RVE. Die RVE muss diese Fehlermeldung in einer Antwort-Datenstruktur, so wie in den Außenschnittstellen beschrieben, kodieren und dem Client diese als Response senden."
          BR (&93834783649184)
          text "Wenn die Fehlformatierung häufig vorkommt, liegt hier evtl. ein systematischer Fehler vor. Der SGD-Betreiber sollte davon wissen und bspw. mit Unterstützung der gematik eine Fehleranalyse unter Verwendung der TI-ITSM-Prozesse starten."
        text " "
        LI (&93834783649608)
          text "Die Authentifizierung war erfolgreich und die Schlüsselableitung wurde nicht durchgeführt, weil kein Ableitungsschlüssel vorhanden war mit dem vom Client übergebenen Ableitungsschlüsselbezeichner. Das SGD-HSM erzeugt ein Chiffrat mit entsprechender Fehlermeldung für den Client. Übergeben wird der RVE (1) das Chiffrat für den Client und (2) die Information über den Fehler. Die RVE muss die Antwort-Datenstruktur, so wie in den Außenschnittstellen beschrieben, kodieren und dem Client diese als Response senden."
          BR (&93834783649912)
          text "Wenn dieser Fehlerfall häufig vorkommt, liegt hier evtl. ein systematischer Fehler vor. Der SGD-Betreiber sollte davon wissen und eine Fehleranalyse starten."
        text " "
        LI (&93834783650336)
          text "Die Zertifikatsprüfung im SGD-HSM ergab FAIL. D. h., die RVE hat die eigene Zertifikatsprüfung ("
          SPAN (&93834783650640)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17908-01"
            attr data-item-id "ML-109359"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "workItem"
            attr id "fake"
          text " ) nicht korrekt ausgeführt. Die RVE muss, so wie in den Außenschnittstellen bzw. in Abschnitt"
          SPAN (&93834783652176)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94577"
            attr data-option-id "longoutline"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text " beschrieben, eine Fehlermeldung an den Client senden."
        text " "
      text " "
      P (&93834783653776)
        attr id "polarion_298"
      text " "
      H4 (&93834783654256)
        attr id "4.1.1"
        text "4.1.1 Routing auf die SGD-HSM"
      text " "
      P (&93834783654856)
        attr id "polarion_304"
        text "Ziel ist es, dass die SGD-HSM in einem SGD von einander unabhängig arbeiten können. D. h., u. a. sollen sie nicht ihre kurzlebigen Schlüssel (S4) und die damit verbundenen Schlüssel (S5) (vgl. jeweils Abschnitt "4.3 Schlüssel im SGD-HSM") untereinander synchronisieren müssen. Daher muss die RVE am Anfang des SGD-Protokoll für einen Client bei Erhalt der Nachricht 1 (vgl. Abschnitt "9.1 Ablauf Kommunikation zwischen Client und SGD-HSM") ein SGD-HSM aus der Menge der im SGD verfügbaren SGD-HSM auswählen. Diese Auswahl nimmt die RVE vor und teilt sie dem Client mit, in dem sie dem Client den aktuellen (S4)-Schlüssel des ausgewählten SGD-HSM bei GetPublicKey (vgl. Abschnitt "6.4 Operation GetPublicKey") als Protokoll-Nachricht 2 sendet. Alle weiteren Nachrichten dieses Client innerhalb dieses Protokollablaufes müssen dann genau das ausgewählte SGD-HSM erreichen. Dies bedeutet: die RVE muss für die folgenden vom Client gesendeten Nachrichten des SGD-Protokolls geeignete Routing-Entscheidungen vornehmen. Eine solche Routing-Entscheidung kann die RVE leicht treffen, denn im "PublicKeyECIES" (vgl. A_17900) ist der Hashwert des Ziel-(S4)-Schlüssels enthalten und der "PublicKeyECIES" ist Bestandteil jeder weiteren Protokoll-Nachricht des Clients."
      text " "
      DIV (&93834783655456)
        attr id "A_22493"
        text " "
        P (&93834783655936)
          B (&93834783656120)
            text "A_22493 - SGD, RVE, Routing der Protokoll-Nachrichten eines SGD-Clients auf die SGD-HSM"
        text " "
        P (&93834783656544)
          text "Die Request verarbeitende Einheit (RVE) eines SGD ePA MUSS folgende Vorgaben umsetzen:"
          BR (&93834783656848)
          text " "
        OL (&93834783657152)
          text " "
          LI (&93834783657456)
            text "Sie MUSS bei der alle 15 Minuten stattfindenden Neuerzeugung des neuen (S4)-Schlüsselpaars eines SGD-HSM den SHA-256-Hashwerts des öffentlichen Schlüssels (welcher sich in der Kodierung nach A_17894-*-PublicKeyECIES befindet) berechnen."
            BR (&93834783657760)
            text "Beispiel aus Abschnitt 5.1.2:"
            BR (&93834783658064)
            text " "
            SPAN (&93834783658368)
              attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
              text ""brainpoolP256r1" + " " + "
            BR (&93834783658848)
            text " "
            SPAN (&93834783659152)
              attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
              text ""0x743cf1b8b5cd4f2eb55f8aa369593ac436ef044166699e37d51a14c2ce13ea0e" + " " +"
            BR (&93834783659632)
            text " "
            SPAN (&93834783659936)
              attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
              text ""0x36ed163337deba9c946fe0bb776529da38df059f69249406892ada097eeb7cd4"
            BR (&93834783660416)
            text "dessen SHA-256-Hashwert ist:"
            BR (&93834783660720)
            text " "
            SPAN (&93834783661024)
              attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
              text "a3a56e51377c1de0bea0522eba3ec6277e3355edb67d48b9852ab7d7e536feb7"
          text " "
          LI (&93834783661624)
            text "Sie MUSS eine Routingtabelle (Associative Array) pflegen auf der sie erkennen kann, welcher Schlüsselhashwert zu welchem SGD-HSM gehört."
            BR (&93834783661928)
            text "(Hinweis: "pflegen" bedeutet insbesondere auch, dass Hashwerte zu alter (ungültiger) (S4)-Schlüssel in der Routingtabelle von der RVE gelöscht werden.)"
          text " "
          LI (&93834783662352)
            text "Bei Eintreffen einer Client-Nachricht GetAuthenticationToken (vgl. Abschnitt 6.5) oder KeyDerivation (vgl. Abschnitt 6.6) MUSS sie im "PublicKeyECIES" (vgl. A_17900) den Hashwert aus dem 4-te oder 5-te Datenfeld für das Routing mittels der Routingtabelle (vgl. Punkt 2.) verwenden. Wenn der SGD ein SGD1 ist, so MUSS die RVE das 4-te Datenfeld verwenden. Ist der SGD ein SGD2, so MUSS die RVE das 5-te Datenfeld verwenden. Findet sich in der Routingtabelle kein entsprechender Eintrag (Client verwendet zu alten (S4)-Schlüssel), so MUSS die RVE dem Client mit einer "restart protocol"-Fehlermeldung (vgl. A_18987) antworten."
          text " "
        text "Die RVE MUSS es erlauben, dass Client-Nachrichten in beliebiger Kombination GetAuthenticationToken- und KeyDerivation senden können und dass diese Nachrichten an die vorgesehen SGD-HSM gelangen. Es ist also explizit nicht Aufgabe der RVE den SGD-Protokoll-Ablauf der 6 Nachrichten sicherzustellen. Ein Client darf beispielsweise folgende Nachrichtenfolgen senden (GetPublicKey, GetAuthenticationToken, KeyDerivation, KeyDerivation, KeyDerivation) oder (GetPublicKey, GetAuthentication, GetAuthentication, KeyDerivation)."
        SPAN (&93834783662896)
          attr style "background-color: #FFFF99;"
        text " "
        B (&93834783663376)
          text "[<=]"
        P (&93834783663680)
        text " "
      text " "
      P (&93834783664104)
        attr id "polarion_307"
        text "Mit A_22493 ist es nun möglich, dass ein SGD-Client bspw. ein KTR-Consumer oder ein ePA-FdV nach einem GetPublicKey und einem GetAuthenticationToken beliebig viele Schlüsselableitungen mittels KeyDerivation durchführen kann, solange der verwendete (S4)-Schlüssel noch gültig ist (also 15 bis fast 30 Minuten). Damit sind für solch einen SGD-Client nicht mehr 6 * (Anzahl der abzuleitenden Schlüssel) SGD-Nachrichten notwendig, sondern nur noch 4 + 2*(Anzahl der abzuleitenden Schlüssel) SGD-Nachrichten. Für einen SGD-Client gibt es in Abschnitt "7.1 Mehrfachableitung" weiterführende Informationen."
      text " "
      H3 (&93834783664704)
        attr id "4.2"
        text "4.2 SGD-HSM"
      text " "
      P (&93834783665304)
        attr id "polarion_192"
        text "Den wesentlichen Teil der Sicherheitsleistung eines SGD erbringt das SGD-HSM. Das SGD-HSM entscheidet, ob eine ausreichende Authentifizierung stattgefunden hat und führt erst danach eine Schlüsselableitung durch. Anschließend überträgt es die abgeleiteten spezifischen Schlüssel über einen beidseitig authentisierten und Ende-zu-Ende-verschlüsselten Datenkanal an den Client."
      text " "
      P (&93834783665904)
        attr id "polarion_198"
        text "Ein SGD-HSM"
      text " "
      OL (&93834783666504)
        attr id "polarion_193"
        text " "
        LI (&93834783666984)
          text "erzeugt mindestens alle 15 Minuten ein neues ECIES-Schlüsselpaar,"
          BR (&93834783667288)
          text "(Ein ECIES-Schlüsselpaar ist 30 Minuten für jeden Client nutzbar und wird danach im SGD-HSM sicher gelöscht)"
        text " "
        LI (&93834783667712)
          text "enthält den privaten Signaturschlüssel ("
          SPAN (&93834783668016)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "workItem"
            attr id "fake"
          text "   (S1)), der für die Signatur (Authentisierung) des jeweils neu erzeugten öffentlichen ECIES-Schlüssels ("
          SPAN (&93834783669552)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "workItem"
            attr id "fake"
          text "   (S4)) notwendig ist,"
        text " "
        LI (&93834783671208)
          text "erzeugt halbjährlich einen neuen Ableitungsschlüssel und hält zuvor erzeugte Ableitungsschlüssel im HSM vor,"
        text " "
        LI (&93834783671632)
          text "prüft bei eingehenden Anfragen für eine Schlüsselableitung das Zertifikat des Anfragenden,"
        text " "
        LI (&93834783672056)
          text "führt bei positivem Prüfergebnis eine Schlüsselableitung entsprechend den Ableitungsregeln durch,"
        text " "
        LI (&93834783672480)
          text "verschlüsselt die abgeleiteten Schlüssel für den Anfragenden."
        text " "
      text " "
      P (&93834783673024)
        attr id "polarion_206"
        text "Das SGD-HSM muss ein besonderes Firmware-Modul enthalten, das diese Funktionalität abbildet. Dieses hat einen sehr begrenzten Funktionsumfang (ECC- und AES-Schlüssel erzeugen, Signaturen prüfen, aus einem AUT-Zertifikat die KVNR bzw. Telematik-ID auslesen, eine Hashfunktion (HKDF) berechnen, ECIES Ver- und Entschlüsselung durchführen und AES-GCM ausführen). Die Mehrzahl der Funktionen sind schon standardmäßig im HSM vorhanden."
      text " "
      DIV (&93834783673624)
        attr id "A_17907"
        text " "
        P (&93834783674104)
          B (&93834783674288)
            text "A_17907 - SGD, Sicherheitsbegutachtung SGD-HSM"
        text " "
        P (&93834783674712)
          text "Ein SGD ePA MUSS Folgendes sicherstellen:"
          BR (&93834783675016)
          text " "
        OL (&93834783675320)
          text " "
          LI (&93834783675624)
            text "Er MUSS mindestens ein HSM, SGD-HSM genannt, einsetzen."
          text " "
          LI (&93834783676048)
            text "Solch ein SGD-HSM MUSS auf einer Plattform (Hardware und Software) basieren, das zuvor bereits erfolgreich eine Zertifizierung nach FIPS 140-2 [FIPS-140-2] mindestens Level 3 durchlaufen hat."
          text " "
          LI (&93834783676472)
            text "Ein solches SGD-HSM MUSS mit spezieller Firmware ausgestattet sein."
          text " "
          LI (&93834783676896)
            text "Diese Firmware MUSS die Ablauflogik aus [gemSpec_SGD_ePA#"
            SPAN (&93834783677200)
              attr class "polarion-rte-link"
              attr data-item-id "ML-94533"
              attr data-option-id "longoutline"
              attr data-type "crossReference"
              attr id "fake"
            text "] ausführen."
          text " "
          LI (&93834772263008)
            text "Im SGD-HSM MÜSSEN, neben dem speziellen Firmware-Modul, ausschließlich Standard-Firmware-Module verwendet werden (also keine anderen speziellen selbstprogrammierten Firmware-Module)."
          text " "
          LI (&93834772263432)
            text "Das Firmware-Modul MUSS eine Sicherheitsbegutachtung durch eine durch die gematik anerkannte unabhängige Instanz (Penetration-Tester etc.) haben. Die gematik nimmt das Gutachten ab und prüft, ob die Anforderung aus dem Produkttypsteckbrief bezogen auf die Schlüsselableitungsfunktionalität ausreichend betrachtet worden sind."
          text " "
          LI (&93834772263856)
            text "Bei der Sicherheitsbegutachtung MUSS sichergestellt sein, dass die unabhängige Instanz aus Punkt 6 mit der gematik Informationen (Frage/Antwort) bezüglich der Sicherheitsbegutachtung austauschen darf."
          text " "
        text " "
        B (&93834772264400)
          text "[<=]"
        P (&93834772264704)
        text " "
      text " "
      P (&93834772265128)
        attr id "polarion_215"
        text "Hinweis zu Punkt 7:"
      text " "
      P (&93834772265728)
        attr id "polarion_218"
        text "Analog zu den CC-Evaluierungen der TI-Komponenten muss es möglich sein, ohne dass Verschwiegenheitsregelungen die Klärung von fachlichen Punkten während der Sicherheitsbegutachtung behindern, die notwendige Dauer der Sicherheitsbegutachtung zu minimieren."
      text " "
      H3 (&93834772266328)
        attr id "4.3"
        text "4.3 Schlüssel im SGD-HSM"
      text " "
      P (&93834772266928)
        attr id "polarion_43"
        text "In einem SGD müssen verschiedene Schlüssel verfügbar sein, die durch ein SGD-HSM geschützt werden müssen."
      text " "
      DIV (&93834772267528)
        attr id "A_17910-01"
        text " "
        P (&93834772268008)
          B (&93834772268192)
            text "A_17910-01 - Schlüssel in einem SGD-HSM"
        text " "
        P (&93834772268616)
          text "Ein SGD ePA MUSS sicherstellen, dass in seinem (oder seinen) SGD-HSM folgende Schlüssel existieren und durch das (die) SGD-HSM geschützt werden:"
          BR (&93834772268920)
          text " "
        OL (&93834772269224)
          text " "
          LI (&93834772269528)
            text "Schlüsselbestätigungsschlüsselpaar ECC brainpoolP256r1 (S1),"
          text " "
          LI (&93834772269952)
            text "Eine geordnete Liste von Zertifikatssignaturprüfschlüsseln (darunter der aktuelle öffentliche RSA-Root-Schlüssel der X.509-Root der TI und der aktuelle ECC-Root-Schlüssel der X.509-Root der TI) (S2),"
          text " "
          LI (&93834772270376)
            text "alle aktuell benötigten Ableitungsschlüssel (S3),"
          text " "
          LI (&93834772270800)
            text "zwei mittels des privaten Schlüsselbestätigungsschlüssels (S1) authentisierte (vgl. Signatur in"
            SPAN (&93834772271104)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17894-01"
              attr data-item-id "ML-109378"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " ) kurzlebige ("
            SPAN (&93834772272464)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17914-01"
              attr data-item-id "ML-109450"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " ) ECIES-Schlüsselpaare (S4), und"
          text " "
          LI (&93834772273944)
            text "zwei Ableitungsschlüssel (S5) für die Erstellung der Authentisierungstoken (je ein Ableitungsschlüssel zugeordnet zu genau einem ECIES-Schlüsselpaar (S4))."
          text " "
        text " "
        B (&93834772274488)
          text "[<=]"
        P (&93834772274792)
        text " "
      text " "
      DIV (&93834772275216)
        attr id "A_17911-01"
        text " "
        P (&93834772275696)
          B (&93834772275880)
            text "A_17911-01 - SGD-HSM: Schlüsselerstellung und Veränderung im Mehr-Augen-Prinzip"
        text " "
        P (&93834772276304)
          text "Ein SGD ePA MUSS sicherstellen, dass die Schlüssel (S1) bis (S5) aus"
          SPAN (&93834772276608)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  ausschließlich im Mehr-Augen-Prinzip erstellbar und änderbar sind (bzw. (S4) und (S5) autonom durch das SGD-HSM-Firmware-Modul). "
          SPAN (&93834772277968)
            attr style "font-size: 10pt;line-height: 1.5;"
            text "Ausgenommen davon sind schon über die PKI der TI Intergritäts- und Authentitätsgeschützte Schlüssel (Import von Cross-signierten neuen Root-Schlüsseln, Import von CA-Schlüsseln die über schon im SGD-HSM vorhandene Root-Schlüssel geprüft werden können)."
          text " "
          B (&93834772278568)
            text "[<=]"
        text " "
      text " "
      DIV (&93834772279112)
        attr id "A_17912-01"
        text " "
        P (&93834772279592)
          B (&93834772279776)
            text "A_17912-01 - SGD-HSM: Root-Schlüssel sind Teil des Firmware-Moduls"
        text " "
        P (&93834772280200)
          text "Ein SGD ePA MUSS sicherstellen, dass die Schlüssel (S2) aus"
          SPAN (&93834772280504)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  Teil des SGD-HSM-Firmware-Moduls sind."
          B (&93834772281864)
            text "[<=]"
        text " "
      text " "
      DIV (&93834772282408)
        attr id "A_17913-01"
        text " "
        P (&93834772282888)
          B (&93834772283072)
            text "A_17913-01 - SGD-HSM: Exklusive Nutzungsrechte der Schlüssel für das Firmware-Modul"
        text " "
        P (&93834772283496)
          text "Ein SGD ePA MUSS technisch sicherstellen, dass"
          BR (&93834772283800)
          text "der private Schlüsselbestätigungsschlüssel bei (S1) (vgl. jeweils "
          SPAN (&93834772284104)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text " ),"
          BR (&93834772285464)
          text " "
        OL (&93834772285768)
          text " "
          LI (&93834772286072)
            text "die Ableitungsschlüssel (S3),"
          text " "
          LI (&93834772286496)
            text "die privaten ECIES-Schlüssel (S4), und"
          text " "
          LI (&93834772286920)
            text "die zu den (S4) 1:1-zugeordneten Ableitungsschlüssel (S5) für die Erstellung der Authentisierungstoken"
          text " "
        text "ausschließlich durch das SGD-HSM-Firmware-Modul nutzbar sind."
        BR (&93834772287464)
        text " "
        B (&93834772287768)
          text "[<=]"
        P (&93834772288072)
        text " "
      text " "
      DIV (&93834772288496)
        attr id "A_17914-01"
        text " "
        P (&93834772288976)
          B (&93834772289160)
            text "A_17914-01 - SGD-HSM: kurzlebige ECIES-Schlüssel"
        text " "
        P (&93834772289584)
          text "Ein SGD ePA MUSS Folgendes sicherstellen:"
          BR (&93834772289888)
          text " "
        OL (&93834772290192)
          text " "
          LI (&93834772290496)
            text "Die beiden ECIES-Schlüsselpaare (S4) (vgl.  "
            SPAN (&93834772290800)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17910-01"
              attr data-item-id "ML-109449"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " ), MÜSSEN jeweils 30 Minuten verwendbar sein und MÜSSEN anschließend sicher gelöscht werden."
          text " "
          LI (&93834772292280)
            text "Initial MUSS ein ECIES-Schlüsselpaar erzeugt werden und 15 Minuten später das zweite."
          text " "
          LI (&93834772292704)
            text "Jeweils im 15-Minuten-Intervall MUSS ein neues Paar erzeugt werden."
          text " "
          LI (&93834772293128)
            text "Der öffentliche Schlüssel dieses neu erzeugten Paares MUSS mittels (S1) signiert und Schlüssel mit Signatur nach"
            SPAN (&93834772293432)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17894-01"
              attr data-item-id "ML-109378"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text "  kodiert werden und die erzeugte Kodierung der RVE übergeben werden."
          text " "
        text " "
        B (&93834767978408)
          text "[<=]"
        P (&93834767978712)
        text " "
      text " "
      P (&93834767979136)
        attr id "polarion_58"
        text "Hinweis zu"
        SPAN (&93834767979592)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17914-01"
          attr data-item-id "ML-109450"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  : Alle 15 Minuten wird ein neues ECIES -Schlüsselpaar (vgl. auch [gemSpec_Krypt#"
        SPAN (&93834767981128)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17873"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94670"
          attr id "fake"
        text " ]) erzeugt werden. Wenn kurz zuvor ein Client (ePA-FdV oder FM ePA) jedoch den öffentliche Schlüssel des alten Schlüsselpaares über die Schnittstelle GetPublicKey (A_17895-* ) erhalten hat, kann er das alte Schlüsselpaar maximal 15 Minuten weiter nutzen. Die Lebensdauer eines solchen ECIES-Schlüsselpaars in einem SGD-HSM ist also 30 Minuten."
      text " "
      DIV (&93834767982608)
        attr id "A_18022-02"
        text " "
        P (&93834767983088)
          B (&93834767983272)
            text "A_18022-02 - SGD-HSM: Ableitungsschlüssel Authentisierungstoken (S5) pro ECIES-Schlüssel (S4)"
        text " "
        P (&93834767983696)
          text "Ein SGD ePA MUSS Folgendes sicherstellen:"
          BR (&93834767984000)
          text " "
        OL (&93834767984304)
          text " "
          LI (&93834767984608)
            text "Jedem ECIES-Schlüsselpaar (S4) (vgl.  "
            SPAN (&93834767984912)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17910-01"
              attr data-item-id "ML-109449"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " ), MUSS genau ein Ableitungsschlüssel (S5) für die Erstellung der Authentisierungstoken zugeordnet sein."
          text " "
          LI (&93834767986392)
            text "Wenn ein ECIES-Schlüsselpaar (S4) erzeugt wird (vgl."
            SPAN (&93834767986696)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17914-01"
              attr data-item-id "ML-109450"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " ) MUSS ein Ableitungsschlüssel (S5) gemäß Spiegelstrich 1 erzeugt werden."
          text " "
          LI (&93834767988176)
            text "Wenn ein ECIES-Schlüsselpaar (S4) sicher gelöscht wird (vgl."
            SPAN (&93834767988480)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17914-01"
              attr data-item-id "ML-109450"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " ), so MUSS auch der zugeordnete Ableitungsschlüssel (S5) sicher gelöscht werden."
          text " "
        text " "
        B (&93834767990080)
          text "[<=]"
        P (&93834767990384)
        text " "
      text " "
      DIV (&93834767990808)
        attr id "A_17915-01"
        text " "
        P (&93834767991288)
          B (&93834767991472)
            text "A_17915-01 - SGD: Nicht-Synchronisation der ECIES-Schlüssel (S4) und zugordnete Ableitungsschlüssel (S5)"
        text " "
        P (&93834767991896)
          text "Ein SGD ePA DARF die kurzlebigen privaten ECIES -Schlüssel ( "
          SPAN (&93834767992200)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  (S4)) und die mit diesen 1:1-zugeordneten Ableitungsschlüssel ("
          SPAN (&93834767993560)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17915-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "   (S5)) (Erstellung der Authentisierungstoken) NICHT über mehrere SGD-HSM synchronisieren."
          BR (&93834767994920)
          text " "
          B (&93834767995224)
            text "[<=]"
        text " "
      text " "
      DIV (&93834767995768)
        attr id "A_17916"
        text " "
        P (&93834767996248)
          B (&93834767996432)
            text "A_17916 - Verfügbarkeit der Schlüssel in einem SGD-HSM"
        text " "
        P (&93834767996856)
          text "Ein SGD ePA MUSS technisch sicherstellen, dass der private Schlüsselbestätigungsschlüssel ("
          SPAN (&93834767997160)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text " (S1)) und die geheimen Ableitungsschlüssel ("
          SPAN (&93834767998520)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  (S3)) in dessen SGD-HSM ausschließlich verschlüsselt und im Mehr-Augen-Prinzip importierbar und exportierbar sind (Ziel: Sicherstellung der Verfügbarkeit dieser Schlüssel). Der SGD ePA MUSS technisch sicherstellen, dass beim Import und Export dieser Schlüssel notwendiger Weise ein Mitarbeiter der gematik beteiligt ist."
          BR (&93834767999880)
          text " "
          B (&93834768000184)
            text "[<=]"
        text " "
      text " "
      DIV (&93834768000728)
        attr id "A_17917"
        text " "
        P (&93834768001208)
          B (&93834768001392)
            text "A_17917 - Schutz des SGD-HSM-Firmware-Moduls"
        text " "
        P (&93834768001816)
          text "Ein SGD ePA MUSS durch technische Maßnahmen sicherstellen, dass"
          BR (&93834768002120)
          text " "
        OL (&93834768002424)
          text " "
          LI (&93834768002728)
            text "das Einbringen und das Update des speziellen Firmware-Moduls in ihrem (oder ihren) SGD-HSM nur im Mehr-Augen-Prinzip möglich ist,"
          text " "
          LI (&93834768003152)
            text "ein Mitarbeiter der gematik an diesem Vorgang beteiligt ist (durch das SGD-HSM durchgesetzt)."
          text " "
        text " "
        B (&93834768003696)
          text "[<=]"
        P (&93834768004000)
        text " "
      text " "
      P (&93834768004424)
        attr id "polarion_95"
        text "Verständnishinweis zu"
        SPAN (&93834768004904)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17916"
          attr data-item-id "ML-94719"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " und "
        SPAN (&93834768006440)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17917"
          attr data-item-id "ML-94716"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ": Dies ist analog zu den Vorgaben, wie seit 2014 die CVC-Root der TI betrieben wird. Damit wird der Betreiber eines SGD vom Verdacht befreit es könnte die geheimen Ableitungsschlüssel"
        SPAN (&93834768007976)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17910-01"
          attr data-item-id "ML-109449"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  (S3) missbrauchen. Er ist technisch aufgrund der zwei Anforderungen nicht in der Lage dies zu tun."
      text " "
      P (&93834768009632)
        attr id "polarion_221"
        text "Aufgrund der Bedeutung der Schlüsselbestätigungsschlüssel für die Sicherheitsleistung werden diese innerhalb eines Clients nicht über die üblichen Zertifikatsprüfverfahren überprüft, sondern die Zertifikate, die die Schlüsselbestätigungsschlüssel enthalten, sind direkt (explizit) in der TSL aufgeführt (vgl. "
        SPAN (&93834768010112)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17847"
          attr data-item-id "ML-94621"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " (Prüfung eines SGD-HSM-Zertifikats) und "
        SPAN (&93834768767336)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_PKI#A_17700]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_PKI?selection=ML-94225"
          attr id "fake"
        text "). Dadurch wirken etwaige Probleme bspw. in der Komponenten-PKI nicht auf die Sicherung der Authentizität der Schlüsselbestätigungsschlüssel (risikominimierende Maßnahme)."
      text " "
      DIV (&93834768768816)
        attr id "A_17846-01"
        text " "
        P (&93834768769296)
          B (&93834768769480)
            text "A_17846-01 - Prüfbarkeit des Schlüsselbestätigungsschlüssels eines nicht-zentralen SGD"
        text " "
        P (&93834768769904)
          text "Ein SGD ePA, der nicht der SGD der zentralen TI-Plattform ist, MUSS folgende Vorgaben durchsetzen."
          BR (&93834768770208)
          text "Der öffentlichen Schlüsselbestätigungsschlüssel ("
          SPAN (&93834768770512)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  (S1)) MUSS in einem EE-Zertifikat nach dem Zertifikatsprofil [gemSpec_PKI#Tab_PKI_296] C.SGD-HSM.AUT aufgeführt werden."
          BR (&93834768771872)
          text " "
        OL (&93834768772176)
          text " "
          LI (&93834768772480)
            text "Dabei MUSS das Zertifikat vom ePA-Aktensystem für dessen SGD genau nur die OID oid_sgd1_hsm [gemSpec_OID#3.5.4 OID-Vergabe für technische Rollen] als technische Rolle aufführen."
          text " "
          LI (&93834768772904)
            text "Das Zertifikat MUSS in die TSL(ECC-RSA) der TI gebracht werden und zwar aufgeführt als TSPService mit dem ServiceTypeIdentifier "http://uri.etsi.org/TrstSvc/Svctype/unspecified"."
          text " "
        text " "
        B (&93834768773448)
          text "[<=]"
        P (&93834768773752)
        text " "
      text " "
      P (&93834768774176)
        attr id "polarion_177"
        text "Hinweis: vgl. auch [gemSpec_PKI#Abschnitt "
        SPAN (&93834768774656)
          attr class "polarion-rte-link"
          attr data-custom-label "SGD-HSM – Schlüsselgenerierungsdienst-HSM"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_PKI?selection=ML-94617"
          attr id "fake"
        text "]. "
      text " "
      DIV (&93834768776136)
        attr id "A_17918-01"
        text " "
        P (&93834768776616)
          B (&93834768776800)
            text "A_17918-01 - Prüfbarkeit des Schlüsselbestätigungsschlüssels des SGD der zentralen TI-Plattform"
        text " "
        P (&93834768777224)
          text "Ein SGD ePA der zentralen TI-Plattform MUSS folgende Vorgaben durchsetzen."
          BR (&93834768777528)
          text " "
        OL (&93834768777832)
          text " "
          LI (&93834768778136)
            text "Der öffentlichen Schlüsselbestätigungsschlüssel ("
            SPAN (&93834768778440)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17910-01"
              attr data-item-id "ML-109449"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text "  (S1)) MUSS in einem EE-Zertifikat nach dem Zertifikatsprofil [gemSpec_PKI#Tab_PKI_296] C.SGD-HSM.AUT aufgeführt werden."
          text " "
          LI (&93834768779920)
            text "Dabei MUSS das Zertifikat vom ePA-Aktensystem für dessen SGD genau nur die OID oid_sgd2_hsm [gemSpec_OID#3.5.4 OID-Vergabe für technische Rollen] als technische Rolle aufführen."
          text " "
          LI (&93834768780344)
            text "Das Zertifikat MUSS in die TSL(ECC-RSA) der TI gebracht werden und zwar aufgeführt als TSPService mit dem ServiceTypeIdentifier "http://uri.etsi.org/TrstSvc/Svctype/unspecified"."
          text " "
        text " "
        B (&93834768780888)
          text "[<=]"
        P (&93834768781192)
        text " "
      text " "
      P (&93834768781616)
        attr id "polarion_174"
        text "Hinweis: Die gematik stellt sicher, dass sich in der TSL nur SGD-HSM-Zertifikate nach"
        SPAN (&93834768782096)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17846-01"
          attr data-item-id "ML-109456"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " #(1) und nach"
        SPAN (&93834768783632)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17918-01"
          attr data-item-id "ML-109457"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  #(1) befinden, die zugehörig sind zu SGD-HSMs von zugelassenen SGD. Vergleiche auch  "
        SPAN (&93834768785168)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17847"
          attr data-item-id "ML-94621"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " (Prüfung eines SGD-HSM-Zertifikats)."
      text " "
      H3 (&93834768786824)
        attr id "4.4"
        text "4.4 Pflege der Prüfschlüssel (S2) im SGD-HSM"
      text " "
      P (&93834768787424)
        attr id "polarion_142"
        text "In"
        SPAN (&93834768787904)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17910-01"
          attr data-item-id "ML-109449"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " (Schlüssel in einem SGD-HSM) wird mit (S2) eine geordnete Liste von Zertifikatssignaturprüfschlüsseln eingeführt. Diese Schlüssel bildet die Grundlage für die Zertifikatsprüfung in einem SGD-HSM ("
        SPAN (&93834768789440)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17919-01"
          attr data-item-id "ML-109357"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ). Einerseits handelt es sich um den RSA-Schlüssel der aktuellen X.509-Root-Version (RCA2) und analog den ECC-Schlüssel (RCA3) und andererseits um nicht von der TI-X.509-Root bestätigte X.509-eGK-CA-Zertifikate, die in der TSL der TI aufgeführt sind. Diese Schlüssel sind fester Bestandteil des SGD-HSM-Firmwaremoduls ("
        SPAN (&93834768790976)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17912-01"
          attr data-item-id "ML-109454"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ). Alle zukünftig erzeugten CA-Zertifikate der TI werden durch die X.509-Root bestätigt werden [gemSpec_X.509_TSP#"
        SPAN (&93834768792512)
          attr class "polarion-rte-link"
          attr data-custom-label "TIP1-A_3894"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_X_509_TSP?selection=ML-10037"
          attr id "fake"
        text "]. "
      text " "
      DIV (&93834768793992)
        attr id "A_17952-01"
        text " "
        P (&93834768794472)
          B (&93834768794656)
            text "A_17952-01 - SGD-HSM, geordnete Liste von Signaturprüfschlüsseln"
        text " "
        P (&93834768795080)
          text "Der SGD ePA MUSS Folgendes sicherstellen."
          BR (&93834768795384)
          text " "
        OL (&93834768795688)
          text " "
          LI (&93834768795992)
            text "Die RVE MUSS vom SGD-HSM eine nummerierte Liste von im SGD-HSM gespeicherten (und damit verwendbaren/adressierbaren) Zertifikatssignaturprüfschlüsseln erhalten können (vgl."
            SPAN (&93834768796296)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17910-01"
              attr data-item-id "ML-109449"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " )."
          text " "
          LI (&93834768797776)
            text "In dieser Liste MÜSSEN der RSA-Schlüssel der RCA2 (X.509-Root der TI) und der ECC-Schlüssel der RCA3 enthalten sein."
          text " "
          LI (&93834768798200)
            text "In dieser Liste MÜSSEN die Bestätigungsschlüssel aller (bez. der Gültigkeitszeit noch relevanten) nicht-TI-X.509-Root-signierten eGK-CA-Zertifikate inkl. Gültigkeitszeitinformationen enthalten sein, die sich aktuell in der TSL der TI befinden."
          text " "
          LI (&93834768798624)
            text "Es MUSS der RVE möglich sein, in das SGD-HSM durch CA-Zertifikatsprüfung auf Grundlage der Root-Schlüssel (RCA2, RCA3 etc.) neue eGK-CA-Schlüssel inkl. Gültigkeitszeitinformationen in das SGD-HSM zu importieren und als neue Elemente in die nummerierte Liste aufzunehmen."
          text " "
          LI (&93834768799048)
            text "Es MUSS der RVE möglich sein, durch Übergabe von X.509-Cross-Zertifikaten neue Root-Schlüssel (neue X.509-Root-Versionen der TI) in das SGD-HSM zu importieren."
          text " "
          LI (&93834768799560)
            text "Es MUSS der RVE möglich sein, alle Zertifikatssignaturprüfschlüssel außer den Root-Schlüsseln (RCA2 und RCA3) zu löschen indem dem SGD-HSM eine entsprechende OCSP-Response der X.509-Root der TI präsentiert wird. "
          text " "
          LI (&93834768799984)
            text "Es MUSS der RVE möglich sein OCSP-Signer-Zertifikate in das SGD-HSM zu importieren, wobei diese durch das SGD-HSM beim Import geprüft werden MÜSSEN."
          text " "
          LI (&93834768800408)
            text "Das SGD-HSM MUSS für die Prüfung von Zertifikatssignaturen ausschließlich CA-Schlüssel verwenden."
          text " "
          LI (&93834768800832)
            text "Das SGD-HSM MUSS für die Prüfung von OCSP-Response-Signaturen ausschließlich OCSP-Signer-Schlüssel verwenden."
          text " "
        text " "
        B (&93834768801376)
          text "[<=]"
        P (&93834768801680)
        text " "
      text " "
      P (&93834768802104)
        attr id "polarion_184"
        text "Aus Performanzgründen müssen für die Zertifikatsprüfung die CA-Zertifikate schon geprüft im SGD-HSM vorliegen. Ansatzpunkt der Prüfung von EE-Zertifikaten ist im SGD-HSM immer einen solcher CA-Schlüssel. Die RVE kennt die aktuelle Liste im SGD-HSM ("
        SPAN (&93834768802560)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17952-01"
          attr data-item-id "ML-109458"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  Punkt 1) und teilt dem SGD-HSM bei einer Requestweitergabe mit welcher Prüfschlüssel im SGD-HSM für die Zertifikatsprüfung der Richtige ist (vgl. "
        SPAN (&93834768804096)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17908-01"
          attr data-item-id "ML-109359"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ), also vom SGD-HSM zu verwenden ist. Wie ein SGD-HSM erkennen kann, ob ein importiertes Zertifikat ein CA-Zertifikat oder ein OCSP-Signer-Zertifikat ist, ist in [gemSpec_PKI] definiert."
      text " "
      DIV (&93834768805752)
        attr id "A_17953"
        text " "
        P (&93834768806232)
          B (&93834768806416)
            text "A_17953 - SGD, täglicher Abgleich CA-Zertifikate TSL und Liste im SGD-HSM"
        text " "
        P (&93834768806840)
          text "Der SGD ePA MUSS Folgendes sicherstellen."
          BR (&93834768807144)
          text " "
        OL (&93834768807448)
          text " "
          LI (&93834768807752)
            text "Die RVE MUSS täglich eine aktuelle TSL vom TSL-Download-Punkt (TSL(ECC-RSA)) beziehen."
          text " "
          LI (&93834768808176)
            text "Aus dieser TSL MUSS die RVE eine Liste von CA-Zertifikaten erzeugen, die in TSPService-Einträgen stehen, die eine ServiceInformationExtensions oid_egk_aut, oid_egk_aut_alt oder oid_smc_b_aut beinhalten."
          text " "
          LI (&93834768808600)
            text "Die Schlüssel der CAs aus dieser Liste MUSS die RVE mit der Liste der Zertifikatssignaturprüfschlüssel im SGD-HSM abgleichen."
          text " "
          LI (&93834768809024)
            text "Sofern Schlüssel im SGD-HSM fehlen, so MUSS die RVE diese in das SGD-HSM durch Zertifikatssignaturprüfung auf Basis eines Root-Schlüssels (RCA2, RCA3 etc.) inkl. Gültigkeitszeitinformationen einbringen (vgl. "
            SPAN (&93834768809328)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17952-01"
              attr data-item-id "ML-109458"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text "  )."
          text " "
          LI (&93834768810808)
            text "Falls in der in der Liste CA-Schlüssel enthalten sind, die in der TSL nun nicht mehr enthalten sind, so MUSS die der SGD ePA die CA-Schlüssel gemäß "
            SPAN (&93834768811112)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17952-01"
              attr data-item-id "ML-109458"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text "  Punkt 6 zu entfernen."
          text " "
          LI (&93834768812592)
            text "Analog MUSS die RVE mit OCSP-Zertifikatsschlüsseln in der TSL vorgehen. Diese MUSS die RVE durch Zertifikatssignaturprüfung auf Basis der RCA2 oder RCA3 inkl. Gültigkeitszeitinformationen einbringen. Das SGD-HSM MUSS nach Prüfung des OCSP-Zertifikats ebenfalls die Information speichern, dass es sich um OCSP-Schlüssel handelt und für welche CA Sperrstatusaussagen getroffen werden dürfen über diesen OCSP-Signer-Schlüssel."
          text " "
        text " "
        B (&93834768813136)
          text "[<=]"
        P (&93834768813440)
        text " "
      text " "
      P (&93834768813864)
        attr id "polarion_200"
        text "Wenn bei"
        SPAN (&93834768814344)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17953"
          attr data-item-id "ML-94790"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " Punkt (1) der Download aufgrund eines Fehlers nicht erfolgen kann, so greift das bei einer "Trust-service Status List" (TSL) übliche Standardvorgehen: die am Vortag heruntergeladene TSL hat eine in der TSL kodierte Gültigkeitsdauer (i. d. R. 30 Tage). Diese TSL ist dann im SGD weiterhin verwendbar und auch zu verwenden. Sollte der Download länger als diese Gültigkeitsdauer nicht funktionieren (was aufgrund der SLA des TSL-Dienstes quasi ausgeschlossen ist), so kann die RVE keine EE-Zertifikatsprüfungen mehr durchführen und muss alle Client-Requests (bis auf GetPublicKey) ablehnen, weil sie bspw. "
        SPAN (&93834768815880)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18021"
          attr data-item-id "ML-96275"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " (Zertifikatsprüfung) erfüllen muss ("Falls eine der Prüfungen ein nicht-positives Ergebnis liefert, so MUSS die RVE des SGD mit einer entsprechenden Fehlermeldung [...] die weitere Requestverarbeitung abbrechen"). "
      text " "
      DIV (&93834768817536)
        attr id "A_17954-01"
        text " "
        P (&93834768818016)
          B (&93834768818200)
            text "A_17954-01 - SGD, Aktualisieren von X.509-Root-Schlüsseln"
        text " "
        P (&93834768818624)
          text "Der SGD ePA MUSS wöchentlich überprüfen, ob neue X.509-Root-CA-Versionen existieren und entsprechende Cross-Zertifikate verfügbar sind. Falls dies der Fall ist, so MUSS der SGD ePA diese neue Root-Versionen in seinen SGD-HSMs importieren (vgl.  "
          SPAN (&93834768818928)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17952-01"
            attr data-item-id "ML-109458"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  Punkt 5)."
          BR (&93834768820288)
          text " "
          B (&93834768820592)
            text "[<=]"
        text " "
      text " "
      P (&93834768821136)
        attr id "polarion_286"
        text "Hinweis: Nach der Erzeugung einer neuen Root-Version der X.509-Root-CA der TI werden dessen selbstsigniertes Zertifikat und Crosszertifikate auf den Download-Punkt "
        A (&93834768821616)
          attr class "descriptionLink"
          attr href "https://download.tsl.ti-dienste.de/ECC/ROOT-CA/"
          attr target "_top"
          text "https://download.tsl.ti-dienste.de/ECC/ROOT-CA/"
        text " abgelegt. Automatisiert kann der SGD ePA von dort die Verfügbarkeit neuer Versionen überwachen. Im Regelfall wird alle zwei Jahre eine neue Root-Version erzeugt."
      text " "
      P (&93834768822688)
        attr id "polarion_261"
        text "Ebenfalls kann man"
        A (&93834768823168)
          attr class "descriptionLink"
          attr href "https://download.tsl.ti-dienste.de/ECC/Root-CA/roots.json"
          attr target "_top"
          text "https://download.tsl.ti-dienste.de/ECC/Root-CA/roots.json"
        text " verwenden. Dort werden die aktuellen Root-Zertifikate inkl. deren Crosszertifikate gepflegt. Implementierungshinweis: die Dateigröße der JSON-Datei kann man als Hashfunktion verwenden. Mit dieser Idee kann man bspw. via curl die HTTP-Methode HEAD verwenden, und damit erfahren ob die lokale Kopie der JSON-Datei noch aktuell ist."
      text " "
      P (&93834768824240)
        attr id "polarion_282"
        text "Die JSON-Datei ist ein Array in dem Associative Arrays als Elemente aufgeführt werden. Diese Elemente enthalten je ein Root-Zertifikat inkl. Crosszertifikate für das chronisch vorhergebende und das nachfolgende Root-Zertifikat. D. h.,  kryptographisch gesehen stellt dies eine doppelt verkettet Liste dar. Die Element im Array sind in chronologischer Ordnung sortiert."
      text " "
      P (&93834768824840)
        attr class "MsoNormal"
        attr id "polarion_314"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834768825672)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "["
          BR (&93834768826152)
          text "{ "name" : "RCA1", "CN" : "GEM.RCA1", "cert" : "…base64…", "prev” : "", "next" : "….base64…", "SKI" : "Subject-Key-Identifier als Hexwert" },"
          BR (&93834768826456)
          text "{ "name" : "RCA2", … },"
        text " "
      text " "
      P (&93834768827000)
        attr id "polarion_321"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834768827656)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "{ "name" : "RCA3", … },"
        text " "
      text " "
      P (&93834768828376)
        attr id "polarion_323"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834768829032)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "…"
        text " "
      text " "
      P (&93834768829752)
        attr id "polarion_324"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834768830408)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "]"
        text " "
      text " "
      P (&93834768831128)
        attr class "MsoNormal"
        attr id "polarion_325"
        text " "
      text " "
      H4 (&93834768831904)
        attr id "4.4.1"
        text "4.4.1 Zuordnung von OCSP-Responder-Zertifikaten zu CA-Zertifikaten (informativ)"
      text " "
      P (&93834783468040)
        attr class "MsoNormal"
        attr id "polarion_263"
        text "Der Vertrauensraum der TI (also die PKI der TI) wird so wie der eIDAS-Vertrauensraum technisch über eine „Trust-service Status List“ nach der dem europäischen Standard ETSI TS 102 231 [ETSI_TS_102_231_v3.1.2] abgebildet. Eine TSL führt verschiedene TSP (CA) auf und einige ihrer CA-Zertifikate."
      text " "
      P (&93834783468816)
        attr class "MsoNormal"
        attr id "polarion_265"
        text "Im Zusammenspiel dazu gibt es noch die X.509-Root der TI. Über die Prüfung mittels der X.509-Root kann man für bestimmte Anwendungsfälle äquivalente Prüfaussagen wie über die Prüfung mittels der TSL treffen. Die Prüfung über die X.509-Root ist technisch deutlich einfacher als über die TSL, weswegen dieser Weg auch im SGD-HSM verwendet wird."
      text " "
      P (&93834783469592)
        attr class "MsoNormal"
        attr id "polarion_266"
        text "In der TSL sind neben Metainformationen zu den CA-Zertifikaten ebenfalls OCSP-Responder-Zertifikate aufgeführt. Diese müssen nicht notwendiger Weise per kryptographischer Signaturprüfung auf die CA-Zertifikate rückführbar sein zu den CA über die die Responder Sperrauskünfte geben dürfen. Dies ist ein wichtiger Unterschied im Vergleich zur Prüfung über die X.509-Root."
      text " "
      P (&93834783470368)
        attr class "MsoNormal"
        attr id "polarion_267"
        text "Bei der Zuordnung der OCSP-Responder-Zertifikate zu den CA-Zertifikaten bei der Erstellung der Import-Listen für die Schlüssel (S2) (vgl. A_17910-*) für die SGD-HSM-Initialisierung ist zu beachten, dass nach dem TSL-Modell alle OCSP-Responder die für einen TSP definiert sind für alle CA desselben TSP Sperrauskünfte geben dürfen. Sind also bspw. für einen TSP in der TSL drei CA-Zertifikate angegeben und ein OCSP-Responder-Zertifikat, so kann dieser Responder für alle drei CA Sperraussagen treffen. Sind mehr als ein OCSP-Responder-Zertifikat pro TSP definiert, so drüber alle OCSP-Responder für alle CA desselben TSP Sperraussagen treffen. Es gibt also ein n zu m Zuordnung, sie sich in der Import-Liste widerspiegeln muss."
      text " "
      P (&93834783471144)
        attr class "MsoNormal"
        attr id "polarion_276"
        text "Um die Aufgabe der Initialisierung der SGD-HSM zu unterstützen stellt die gematik auf Anfrage ein Programm zur Verfügung, dass diese Zuordnung aus einer aktuellen TSL automatisch erzeugt. Im Rahmen der Schlüsselzeremonie also der Initialisierung der SGD-HSM muss gemäß A_17916 der Anbieter des SGD und ein Vertreter der gematik die Import-Liste gemeinsam in die SGD-HSM importieren, dafür muss diese Liste zwischen beiden Parteien konsentiert sein – Überprüfung der Korrektheit der Liste im Mehr-Augen-Prinzip."
      text " "
      H3 (&93834783471920)
        attr id "4.5"
        text "4.5 Funktionsablauf Firmware-Modul SGD-HSM"
      text " "
      P (&93834783472520)
        attr id "polarion_79"
        text "In diesem Abschnitt wird die Ablauflogik im speziellen HSM-Firmware-Modul beschrieben. Diese Beschreibung ist Grundlage der für die Zulassung notwendigen Sicherheitsüberprüfung (vgl."
        SPAN (&93834783473000)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17907"
          attr data-item-id "ML-94708"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " )."
      text " "
      H4 (&93834783474656)
        attr id "4.5.1"
        text "4.5.1 Zertifikats- und Schlüsselprüfung im SGD-HSM"
      text " "
      P (&93834783475256)
        attr id "polarion_101"
        text "Damit im SGD-HSM nur für den jeweils Berechtigten eine Schlüsselableitung durchgeführt wird, muss dessen Request auf Authentizität geprüft werden. Dafür muss dessen AUT-Zertifikat innerhalb des SGD-HSMs überprüft werden."
      text " "
      P (&93834783475856)
        attr id "polarion_45"
        text "Eine Standard-TI-Prüfung auf Basis der TSL ist technisch relativ komplex und ist insbesondere in beschränkten  Laufzeitumgebungen wie Chipkarten oder HSM-Firmware-Modulen nur schwer umsetzbar. Damit diese Prüfung technisch praktikabel ist, wird bei der Prüfung des AUT-Zertifikats die Signaturkette auf die X.509-Root der TI geprüft. Es werden ebenfalls OCSP-Antworten notwendigerweise ausgewertet."
      text " "
      DIV (&93834783476456)
        attr id "A_17919-01"
        text " "
        P (&93834783476936)
          B (&93834783477120)
            text "A_17919-01 - Zertifikatsprüfung in einem SGD-HSM"
        text " "
        P (&93834783477544)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen:"
          BR (&93834783477848)
          text " "
        OL (&93834783478152)
          text " "
          LI (&93834783478456)
            text "(K1) Die RVE MUSS dem SGD-HSM mitteilen über welchen Prüfschlüssel ("
            SPAN (&93834783478760)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17952-01"
              attr data-item-id "ML-109458"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " , also CA-Schlüssel) die Zertifikatssignatur prüfbar ist. "
          text " "
          LI (&93834783480240)
            text "(O1) Die RVE MUSS eine OCSP-Response, die nicht älter als 4 Stunden ist, für das zu prüfende AUT-Zertifikat dem SGD-HSM übergeben."
          text " "
          LI (&93834783480664)
            text "(O2) Die RVE MUSS dem SGD-HSM mitteilen über welchen Prüfschlüssel ("
            SPAN (&93834783480968)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17952-01"
              attr data-item-id "ML-109458"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " , also OCSP-Zertifikatsschlüssel) die OCSP-Response-Signatur prüfbar ist. "
          text " "
        text "Im Rahmen der Prüfung eines kurzlebigen öffentlichen ECIES-Schlüssels eines Client MUSS das SGD-HSM das vom Client verwendete AUT-Zertifikat (oder AUT_ALT-Zertifikat bei einer alternativen Versichertenidentität) wie folgt prüfen:"
        BR (&93834783482568)
        text " "
        OL (&93834783482872)
          text " "
          LI (&93834783483176)
            text "Ist das Zertifikat zeitlich gültig, falls nein dann FAIL."
          text " "
          LI (&93834783483600)
            text "Ist die Zertifikatssignatur über den Schlüssel (K1) prüfbar (Signaturprüfung), falls nein dann FAIL."
          text " "
          LI (&93834783484024)
            text "Ist die OCSP-Response (O1)  maximal 4 Stunden alt , falls nein dann FAIL."
          text " "
          LI (&93834783484448)
            text "Ist der Schlüssel (O2) berechtigt Sperraussagen bezüglich über (K1) bestätigte Zertifikate zu tätigen, falls nein dann FAIL."
          text " "
          LI (&93834783484872)
            text "Ist die OCSP-Response (O1) über den Schlüssel (O2) prüfbar (Signaturprüfung), falls nein dann FAIL."
          text " "
          LI (&93834783485296)
            text "Enthält das Zertifikat eine KVNR oder einen Telematik-ID, falls nein dann FAIL. (vgl. [gemSpec_SGD_ePA#Hinweis zu A_17919-01]) "
          text " "
        text " Wenn keine Prüfung aus (1) bis (6) ein FAIL liefert, so MUSS das Prüfergebnis für das AUT-Zertifikat "OK" sein."
        B (&93834783485840)
          text "[<=]"
        P (&93834783486144)
        text " "
      text " "
      P (&93834783486568)
        attr id "polarion_106"
      text " "
      P (&93834783487048)
        attr id "polarion_34"
        text "Hinweis zu "
        SPAN (&93834783487528)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17919-01"
          attr data-item-id "ML-109357"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " :"
      text " "
      P (&93834783489184)
        attr id "polarion_47"
        text "Das SGD-HSM kann davon ausgehen, dass die X.509-Root-CA und alle in der PKI-Hierarchie folgenden CAs korrekt formatierte Zertifikate ausgeben. Es muss also vom SGD-HSM nicht die vollständige Konformität der erhaltenen Zertifikate zu den in [gemSpec_PKI] definierten Zertifikatsprofilen geprüft werden, was technisch in einer beschränkten Laufzeitumgebung schwierig ist."
      text " "
      DIV (&93834783489784)
        attr id "A_18010"
        text " "
        P (&93834783490264)
          B (&93834783490448)
            text "A_18010 - SGD-HSM, Entfernen von abgelaufenen Prüfschlüsseln/Zertifikaten"
        text " "
        P (&93834783490872)
          text "Ein SGD ePA MUSS sicherstellen, dass dessen SGD-HSM mindestens alle 24 Stunden die Schlüssel aus der Prüfschlüsselliste gemäß "
          SPAN (&93834783491176)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17952-01"
            attr data-item-id "ML-109458"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  auf zeitliche Gültigkeit hin überprüft. Ist eine solcher Prüfschlüssel nur noch weniger als 24 Stunden gültig, so MUSS das SGD-HSM diesen Schlüssel aus seiner Prüfschlüsselliste löschen. Ausgenommen davon sind die Root-Schlüssel aus "
          SPAN (&93834783492536)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17952-01"
            attr data-item-id "ML-109458"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  Punkt 2."
          B (&93834783493896)
            text "[<=]"
        text " "
      text " "
      P (&93834783494440)
        attr id "polarion_278"
        text "Die Sonderbehandlung von Root-Schlüsseln im SGD-HSM in A_18010 ist analog definiert worden wie das Verhalten im COS bei G2-Karten. Ein SGD-HSM kann nach A_21274 davon abweichen und die Gültigkeitsdauer auch bei Root-Schlüsseln streng durchsetzen."
      text " "
      DIV (&93834783495040)
        attr id "A_21274"
        text " "
        P (&93834783495520)
          B (&93834783495704)
            text "A_21274 - SGD-HSM, Entfernen von abgelaufenen Root-Schlüsseln"
        text " "
        P (&93834783496128)
          text "Ein SGD ePA KANN bei der Umsetzung von A_18010 auf die Sonderbehandlung von Root-Schlüsseln verzichten, d. h. diese KANN das SGD-HSM analog zu CA-Schlüsseln nach Ablauf der Gültigkeitsdauer im SGD-HSM löschen."
          B (&93834783496432)
            text "[<=]"
        text " "
      text " "
      DIV (&93834783496976)
        attr id "A_18027"
        text " "
        P (&93834783497456)
          B (&93834783497640)
            text "A_18027 - SGD-HSM, Prüfung von Client-ECIES-Schlüssel und Client-ECIES-Schlüssel-Signatur"
        text " "
        P (&93834783498064)
          text "Ein SGD ePA MUSS sicherstellen, dass dessen SGD-HSM den Client-ECIES-Schlüssel und dessen Signatur wie folgt prüft."
          BR (&93834783498368)
          text " "
        OL (&93834783498672)
          text " "
          LI (&93834783498976)
            text "Ist der öffentliche ECIES-Schlüssel des Client nach"
            SPAN (&93834783499280)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17900"
              attr data-item-id "ML-94700"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text "korrekt kodiert?"
          text " "
          LI (&93834783500800)
            text "Ist in der Kodierung ein Hashwert eines aktuellen öffentlichen ECIES-Schlüssels des SGD-HSM nach A_17894-01 vorhanden?"
          text " "
          LI (&93834783501224)
            text "Liegt der öffentliche ECIES-Schlüssel des Clients auf der korrekten Kurve (vgl. "
            SPAN (&93834783501528)
              attr class "polarion-rte-link"
              attr data-custom-label "[gemSpec_Krypt#A_17874]"
              attr data-type "polarion"
              attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94671"
              attr id "fake"
            text ")?"
          text " "
          LI (&93834783502832)
            text "Ist das Zertifikat des Clients gültig nach "
            SPAN (&93834783503136)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17919-01"
              attr data-item-id "ML-109357"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " (Zertifikatsprüfung in einer SGD-HSM)?"
          text " "
          LI (&93834783504616)
            text "Ist die Signatur auf des ECIES-Schlüssels des Client korrekt (valide) in Bezug auf das Zertifikat des Clients (bzw. des dort bestätigten EE-Schlüssels)?"
          text " "
        text "Liefert eine der Prüfungen ein nicht-positives Ergebnis, so MUSS das SGD-HSM die Verarbeitung mit einer entsprechenden Fehlermeldung an die RVE abbrechen."
        B (&93834783505160)
          text "[<=]"
        P (&93834783505464)
        text " "
      text " "
      H4 (&93834783505888)
        attr id "4.5.2"
        text "4.5.2 Authentisierungstoken im SGD-HSM"
      text " "
      DIV (&93834783506488)
        attr id "A_18026-01"
        text " "
        P (&93834783506968)
          B (&93834783507152)
            text "A_18026-01 - SGD-HSM, Ausstellen von Authentisierungstoken für SGD-Clients"
        text " "
        P (&93834783507576)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen:"
          BR (&93834783507880)
          text "Bei der Umsetzung von GetAuthenticationToken ("
          SPAN (&93834783508184)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18021"
            attr data-item-id "ML-96275"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") MUSS die RVE dem SGD-HSM (das für den Client bestimmt ist)"
          BR (&93834783509544)
          text " "
        OL (&93834783509848)
          text " "
          LI (&93834783510152)
            text "das Chiffrat und die für die Entschlüsselung notwendigen Informationen,"
          text " "
          LI (&93834783510576)
            text "und das Client-Zertifikat inkl. der für die Zertifikatsprüfung im SGD-HSM gemäß "
            SPAN (&93834783510880)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17919-01"
              attr data-item-id "ML-109357"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " notwendigen Informationen"
          text " "
        text "übergeben."
        BR (&93834783512480)
        text "Das SGD-HSM MUSS das Client-Zertifikat gemäß "
        SPAN (&93834783512784)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17919-01"
          attr data-item-id "ML-109357"
          attr data-option-id "custom"
          attr data-type "workItem"
          attr id "fake"
        text " prüfen und bei negativen Prüfergebnis abbrechen."
        BR (&93834783514144)
        text "Das SGD-HSM MUSS die Signatur des Client-ECIES-Schlüssel und den ECIES-Schlüssel an sich gemäß"
        SPAN (&93834783514448)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18027"
          attr data-item-id "ML-96284"
          attr data-option-id "custom"
          attr data-type "crossReference"
          attr id "fake"
        text " prüfen und bei negativen Prüfergebnis abbrechen."
        BR (&93834783515808)
        text "Das SGD-HSM MUSS das Chiffrat entschlüsseln und dabei im Fehlerfall abbrechen."
        BR (&93834783516112)
        text "Das SGD-HSM MUSS prüfen, ob der entschlüsselte Klartext der Form"
        BR (&93834783516416)
        text " "
        SPAN (&93834783516720)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "    Challenge <256-Bit-hexadezimal-kodiert> <256-Bit-hexadezimal-kodiert>"
          BR (&93834783517200)
          text " "
          BR (&93834783517504)
          text " "
        text "(Damit muss der Klartext also 9 + 2 + 2*64 = 139 Zeichen lang sein.)"
        SPAN (&93834783517928)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          BR (&93834783518288)
          text " "
        text "(Beispiel:"
        SPAN (&93834783518712)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "  Challenge "
          SPAN (&93834783519192)
            attr style "font-size: 10pt;line-height: 1.5;"
            text "f97cbc538b020d705a960a7e8fa5912c8e202fcf7d6516da3818eff68ce7e00d c4d0613a597826cfdca992d0a02d0ea26667829345033dee158a578cc8524cab"
        BR (&93834783519672)
        text ") ist. Falls nein, dann MUSS das SGD-HSM mit einer entsprechenden Fehlermeldung abbrechen."
        BR (&93834783519976)
        text "Das SGD-HSM MUSS die Zeichenkette A als Aneinanderführung von"
        BR (&93834783520280)
        text " "
        OL (&93834783520584)
          text " "
          LI (&93834783520888)
            text "signierten Client-ECIES-Schlüssel in der Kodierung gemäß "
            SPAN (&93834783521192)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17900"
              attr data-item-id "ML-94700"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text " , und"
          text " "
          LI (&93834783522672)
            text "Client-AUT-Zertifikat"
          text " "
        text "bilden."
        BR (&93834783523216)
        text "Das SGD-HSM MUSS H als SHA-256-Hashwert von A berechnen."
        BR (&93834783523520)
        text "Das SGD-HSM MUSS prüfen, ob der Wert H hexadezimal kodiert gleich dem zweiten 256-Bit hexadezimal kodierten Wert im entschlüsselten Klartext ist. Falls nein, so MUSS das SGD-HSM die Verarbeitung des Request mit einer Fehlermeldung abbrechen."
        BR (&93834783523824)
        text "Anschließend MUSS das SGD-HSM eine Schlüsselableitung mit dem Schlüssel (S5), der mit dem ECIES-SGD-HSM-Schlüssel (S4) verbunden ist, für den die Verschlüsselung durch den Client vorgenommen wurde, und dem erzeugten Ableitungsvektor A (info-Parameter) gemäß [gemSpec_Krypt#"
        SPAN (&93834783524128)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18023"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-96279"
          attr id "fake"
        text "] durchführen."
        BR (&93834783525312)
        text "Aus der Ableitung MUSS das SGD-HSM einen 256-Bit-Wert erhalten und diesen Hexadezimal kodieren und davor die Zeichenkette "AT" setzen. Das Ergebnis ist der Authentisierungstoken."
        BR (&93834783525616)
        text "Beispiel:"
        BR (&93834783525920)
        text " "
        SPAN (&93834783526224)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "    AT1ce627dd5e4c6536ca0dd93f896744d42c6580537953a49fcc5840dd8f8f4efa"
        BR (&93834783526704)
        text " "
        BR (&93834783527008)
        text "Anschließend MUSS das SGD-HSM eine Zeichenkette der folgenden Form bilden:"
        BR (&93834783527312)
        text " "
        SPAN (&93834783527616)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "    Response <vom-Client-erhaltener-hexadezimal-256-Bit-Wert> <H-in-Hexform> <Authentisierungstoken>"
        BR (&93834783528096)
        text "Diese Zeichenkette muss das SGD-HSM mittels des ECIES-Verfahrens gemäß [gemSpec_Krypt#"
        SPAN (&93834783528400)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17875"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
          attr id "fake"
        text "] für den Client-ECIES-Schlüssel verschlüsseln und das Chiffrat an die RVE übergeben."
        BR (&93834783529584)
        text " "
        B (&93834783529888)
          text "[<=]"
        P (&93834783530192)
        text " "
      text " "
      H4 (&93834783530616)
        attr id "4.5.3"
        text "4.5.3 Schlüsselableitung im SGD-HSM"
      text " "
      DIV (&93834783531216)
        attr id "A_17926"
        text " "
        P (&93834783531696)
          B (&93834783531880)
            text "A_17926 - SGD-HSM, Schlüsselableitung im SGD-HSM"
        text " "
        P (&93834783532304)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen:"
          BR (&93834783532608)
          text " "
        OL (&93834783532912)
          text " "
          LI (&93834801521088)
            text "Wenn von einer Schlüsselableitung bei einer Ableitungsregel von der Variable"
            SPAN (&93834801521392)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text "KVNR"
            text "(""
            SPAN (&93834801521968)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text "<KVNR>"
            text "") gesprochen wird, so MUSS der SGD ePA aus dem AUT-Zertifikat einer eGK oder einer alternativen Versichertenidentität nur den Wert  aus den "organizationalUnitName"-Datenfeldern verwenden, der den unveränderlichen Teil der KVNR bezeichnet („annnnnnnnn“) (vgl. [gemSpec_PKI#C.CH.AUT und C.CH.AUT_ALT – Authentisierung eGK]). D. h., die Institutionskennzeichen werden nicht verwendet."
          text " "
          LI (&93834801522688)
            text "Wenn von einer Schlüsselableitung mit einem Ableitungsvektor ""
            SPAN (&93834801522992)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text "<X>"
            text "" gesprochen wird, so MUSS die Zeichenkette mit dem konkreten Wert der Variable"
            SPAN (&93834801523592)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text "X"
            text "als "info"-Parameter nach [RFC-5869] (HKDF) verwendet werden (vgl. "Beispiel zu A_17926")."
          text " "
        text " "
        B (&93834801524432)
          text "[<=]"
        P (&93834801524736)
        text " "
      text " "
      P (&93834801525160)
        attr id "polarion_292"
        text "Beispiel zu A_17926:"
      text " "
      P (&93834801525760)
        attr id "polarion_293"
        text "Sei RND="123" und KVNR="a4b5c6". Wenn im Algorithmus in Tabelle 3 a="r1:<RND>:<KVNR>" gesetzt wird, und a als Ableitungsvektor verwendet werden soll, so müssen die Werte der Variablen RND und KVNR interpoliert werden. Es entsteht damit die Zeichenkette a="r1:123:4a5b6c". Dieser Wert von a muss dann als Wert des Ableitungsvektor bei der Schlüsselableitung verwendet werden."
      text " "
      DIV (&93834801526360)
        attr id "A_17920-02"
        text " "
        P (&93834801526840)
          B (&93834801527024)
            text "A_17920-02 - SGD-HSM, Schlüsselableitungsschlüssel und Schlüsselableitung im SGD-HSM"
        text " "
        P (&93834801527448)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen:"
          BR (&93834801527752)
          text " "
        OL (&93834801528056)
          text " "
          LI (&93834801528360)
            text "Es MUSS initial ein Ableitungsschlüssel (vgl. auch [gemSpec_Krypt#"
            SPAN (&93834801528664)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17876"
              attr data-type "polarion"
              attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
              attr id "fake"
            text "]  und  "
            SPAN (&93834801529848)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17910-01"
              attr data-item-id "ML-109449"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text "  (3)) für die Schlüsselableitung der versichertenindividuellen Schlüssel vorhanden sein."
          text " "
          LI (&93834801531328)
            text "Mindestens halbjährlich MUSS solch ein Ableitungsschlüssel neu erzeugt werden."
          text " "
          LI (&93834801531752)
            text "Jeder Ableitungsschlüssel MUSS einen innerhalb eines SGD eindeutigen Bezeichner besitzen."
            BR (&93834801532056)
            text "Solch ein Ableitungsschlüsselbezeichner MUSS maximal 7 KiB groß sein und auf den PCRE [PCRE]"
            BR (&93834801532360)
            text " "
            SPAN (&93834801532664)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text "^\w[\w -]{1,7167}$"
            BR (&93834801533144)
            text "matchen."
          text " "
          LI (&93834801533568)
            text "Alle Ableitungsschlüssel MÜSSEN in allen SGD-HSM eines SGD zur Verfügung stehen."
          text " "
          LI (&93834801533992)
            text "Es MUSS, sofern kein Ableitungsschlüsselbezeichner beim Aufruf der Operation KeyDerivation (vgl."
            SPAN (&93834801534296)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17898"
              attr data-item-id "ML-94696"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text ") angegeben wurde, immer der jüngste Ableitungsschlüssel bei der Schlüsselableitung der versichertenindividuellen Schlüssel verwendet werden."
          text " "
        text " "
        B (&93834801535896)
          text "[<=]"
        P (&93834801536200)
        text " "
      text " "
      P (&93834801536624)
        attr id "polarion_102"
        text "Hinweis: nach"
        SPAN (&93834801537104)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Krypt#A_17876]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
          attr id "fake"
        text "wird für die Schlüssel als Schlüsselableitungsfunktion die HKDF nach [RFC-5869] auf Basis von SHA-256 verwendet. Ebenso befinden sich in [gemSpec_Krypt#"
        SPAN (&93834801538464)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17876"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
          attr id "fake"
        text "] die Vorgaben zur Mindestentropie."
      text " "
      P (&93834801539944)
        attr id "polarion_114"
        text "Man beachte, dass absichtlich keine Doppelpunkte im Bezeichner zugelassen sind."
      text " "
      P (&93834801540544)
        attr id "polarion_78"
        text "Beispiele für gültige Ableitungsschlüsselbezeichner: "
      text " "
      UL (&93834801541144)
        attr id "polarion_181"
        text " "
        LI (&93834801541624)
          SPAN (&93834801541808)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "ACME 2019-1"
        text " "
        LI (&93834801542408)
          SPAN (&93834801542592)
            attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
            text "AB AbCdEfGhI 12 jklmn"
        text " "
      text " "
      P (&93834801543312)
        attr id "polarion_116"
        text "Testmöglichkeit:"
      text " "
      P (&93834801543912)
        attr id "polarion_149"
        text " "
        SPAN (&93834801544392)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "echo 'Bezeichner 2021-Test 1' | \"
        BR (&93834801544872)
        text " "
        SPAN (&93834801545176)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "perl -ne 'print /^\w[\w -]{1,7167}$/ ? "OK: " : "UNGÜLTIG: ", $_;'"
        text " "
      text " "
      H4 (&93834801545896)
        attr id "4.5.4"
        text "4.5.4 Kommando-Abarbeitung KeyDerivation im SGD-HSM"
      text " "
      DIV (&93834801546496)
        attr id "A_18030"
        text " "
        P (&93834801546976)
          B (&93834801547160)
            text "A_18030 - SGD-HSM, Empfang einer Ableitungsanforderung (KeyDerivation)"
        text " "
        P (&93834801547584)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen:"
          BR (&93834801547888)
          text "Bei der Umsetzung von KeyDerivation ("
          SPAN (&93834801548192)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") MUSS die RVE dem SGD-HSM (das für den"
          SPAN (&93834801549552)
            attr style "text-decoration: line-through;background-color: #FFFF99;"
          text "Client bestimmt ist)"
          BR (&93834801550032)
          text " "
        OL (&93834801550336)
          text " "
          LI (&93834801550640)
            text "das Chiffrat und die für die Entschlüsselung notwendigen Informationen, und"
          text " "
          LI (&93834801551064)
            text "das Client-AUT-Zertifikat"
          text " "
        text "übergeben."
        BR (&93834801551608)
        text "Das SGD-HSM MUSS das Chiffrat mittels des ECIES-Verfahrens gemäß [gemSpec_Krypt#"
        SPAN (&93834801551912)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17875"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
          attr id "fake"
        text "] entschlüsseln und dabei im Fehlerfall abbrechen."
        BR (&93834801553096)
        text "Das SGD-HSM MUSS prüfen, ob der erhaltene Klartext wie folgt beginnt"
        BR (&93834801553400)
        text " "
        SPAN (&93834801553752)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "    "AT<256-Bit-Hexadezimal-kodierter-Wert>" + " " + "<256-Bit-Hexadezimal-kodierte-Zeichenkette (Request-ID)>" + " ""
        BR (&93834801554208)
        text "und falls nein abbricht."
        BR (&93834801554512)
        text " "
        BR (&93834801554816)
        text "Das SGD-HSM MUSS die Zeichenkette A als Aneinanderführung von"
        BR (&93834801555120)
        text " "
        OL (&93834801555424)
          text " "
          LI (&93834801555728)
            text "signierten Client-ECIES-Schlüssel in der Kodierung gemäß "
            SPAN (&93834801556032)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17900"
              attr data-item-id "ML-94700"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text ", und"
          text " "
          LI (&93834801557512)
            text "Client-AUT-Zertifikat"
          text " "
        text "bilden. Anschließend MUSS das SGD-HSM eine Schlüsselableitung mit dem Schlüssel (S5), der mit dem ECIES-SGD-HSM Schlüssel (S4) verbunden ist für den die Verschlüsselung durch den Client vorgenommen wurde, und dem erzeugten Ableitungsvektor A (info-Parameter) gemäß [gemSpec_Krypt#"
        SPAN (&93834801558056)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18023"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-96279"
          attr id "fake"
        text "] durchführen."
        BR (&93834801559240)
        text "Aus der Ableitung MUSS das SGD-HSM einen 256-Bit-Wert erhalten und diesen Hexadezimal kodieren und davor die Zeichenkette "AT" setzen. Das Ergebnis ist das Authentisierungstoken."
        BR (&93834801559544)
        text "Beispiel:"
        BR (&93834801559848)
        text " "
        SPAN (&93834801560152)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "    AT1ce627dd5e4c6536ca0dd93f896744d42c6580537953a49fcc5840dd8f8f4efa"
        BR (&93834801560632)
        text " "
        BR (&93834801560936)
        text "Das SGD-HSM MUSS prüfen, ob der Authentisierungstoken mit dem Anfangswert des Klartextes übereinstimmt."
        BR (&93834801561240)
        text "Falls nein, so MUSS das SGD-HSM mit entsprechender Fehlermeldung abbrechen."
        BR (&93834801561544)
        text " "
        BR (&93834801561848)
        text "Das SGD-HSM MUSS mit der Kommando-Abarbeitung der Operation KeyDerivation gemäß "
        SPAN (&93834801562152)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17922"
          attr data-item-id "ML-94727"
          attr data-option-id "custom"
          attr data-type "crossReference"
          attr id "fake"
        text " fortfahren."
        B (&93834801563512)
          text "[<=]"
        P (&93834801563816)
        text " "
      text " "
      DIV (&93834801564240)
        attr id "A_17922"
        text " "
        P (&93834801564720)
          B (&93834801564904)
            text "A_17922 - SGD-HSM, Kommando-Abarbeitung der Operation KeyDerivation im SGD-HSM"
        text " "
        P (&93834801565328)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen: Nachdem das SGD-HSM erfolgreich die Authentizität der Anfrage mittels "
          SPAN (&93834801565632)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18030"
            attr data-item-id "ML-96287"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " überprüft hat und den Klartext erhalten hat, MUSS es den erhaltenen Klartext analysieren."
          BR (&93834801566992)
          text "Es entfernt den Authentisierungstoken und die Request-ID inkl. folgenden Leerzeichen vom Anfang der Nachricht des Clients und speichert das Authentisierungstoken und die Request-ID für die Erzeugung der Antwort."
          BR (&93834801567296)
          text "(Beispiel:"
          BR (&93834801567600)
          text " "
          SPAN (&93834801567904)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text " "AT1ce627dd5e4c6536ca0dd93f896744d42c6580537953a49fcc5840dd8f8f4efa "
            SPAN (&93834801568384)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "7522d04ca28f2c6d3f5a53b2a31aebe1f91f2cfb75145b35c9a01fae7930340c "
            text "KeyDerivation r2:7f8f77003dbab49c3a4e32f44726f92324d292fa668fde5ebc3424397986be99:107299005A112102647:2-20a1201-001:Bezeichner ACME Q1 2020""
            BR (&93834801568984)
            text " "
          text " "
          SPAN (&93834801569408)
            attr style "font-family: Arial, Helvetica;"
            text "Das Authentisierungstoken ist gleich"
          text " "
          SPAN (&93834801570008)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""AT1c...efa""
          SPAN (&93834801570488)
            attr style "font-family: Arial, Helvetica;"
            text ", die Request-ID ist gleich"
          text " "
          SPAN (&93834801571088)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""7522..340c""
          SPAN (&93834801571568)
            attr style "font-family: Arial, Helvetica;"
            text ". Die restliche Zeichenkette des Klartexts ist die Eingabe für den Algorithmus in [gemSpec_SDG_ePA#Tab_Kommandoabarbeitung_im_SGD-HSM]."
            BR (&93834801572048)
            text ")"
          BR (&93834801572352)
          text "Das SGD-HSM MUSS den in [gemSpec_SDG_ePA#Tab_Kommandoabarbeitung_im_SGD-HSM] aufgeführten Algorithmus implementieren und verwenden. Wenn der Algorithmus mit einem FAIL abbricht, so MUSS das SGD-HSM dies mit einem entsprechender Fehlermeldung an das RVE weitergeben."
          BR (&93834801572656)
          text "Anderenfalls MUSS das SGD-HSM die durch den Algorithmus erzeugte Antwort-Zeichenkette erweitern, indem es das gespeicherte Authentisierungstoken und die Request-ID inkl. folgenden Leerzeichen vor die Antwort-Zeichenkette stellt. Diese erhaltene Zeichenkette ist der Klartext, der den Client erreichen solle. Diesen Klartext MUSS das SGD-HSM gemäß den Vorgaben aus [gemSpec_Krypt#"
          SPAN (&93834801572960)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17875"
            attr data-type "polarion"
            attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
            attr id "fake"
          text "] verschlüsseln (ECIES-Verfahren mit Authenticated Encryption) und mit einer positiven Rückmeldung (OK) an die RVE das erzeugte Chiffrat im Format gemäß "
          SPAN (&93834801574144)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17902"
            attr data-item-id "ML-94703"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " übergeben."
          BR (&93834801575504)
          text " "
          B (&93834801575808)
            text "[<=]"
        text " "
      text " "
      P (&93834801576352)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_132"
        text "Tabelle "
        SPAN (&93834801577184)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "4"
        text ": Tab_Kommandoabarbeitung_im_SGD-HSM"
      text " "
      TABLE (&93834801578080)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=1"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834801578912)
          text " "
          TR (&93834801579216)
            text " "
            TD (&93834801579520)
              attr style "text-align: left;vertical-align: top;width: 748px;height: 560px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834801579880)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Sei mit "Nachricht" die authentifizierte Nachricht des Clients, ohne das Authentisierungstoken und die Request-ID (inkl. folgendem Leerzeichen) am Anfang der Nachricht, bezeichnet. Sei IKM das "input key material" und info das "info"-Feld beides gemäß [RFC-5869]. Mit "<>" sei die Variableninterpolation bezeichnet, bspw. mit a="x1y2z3" und s="a<a>" folgt s gleich "ax1y2z3"."
                BR (&93834801580360)
                text " "
                BR (&93834801580664)
                text "(1) Prüfe ob die Nachricht mit"
                SPAN (&93834801580968)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""KeyDerivation ""
                text "(14 Zeichen) beginnt, ansonsten FAIL."
                BR (&93834801581568)
                text "(2) Sei s gleich die Nachricht ohne die ersten 14 Zeichen (also ohne"
                SPAN (&93834801581872)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""KeyDerivation ""
                text ")."
                BR (&93834801582472)
                text "(3) Prüfe ob s entweder mit"
                SPAN (&93834801582776)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r1""
                text ","
                SPAN (&93834801583376)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r2""
                text "oder mit"
                SPAN (&93834801583976)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r3""
                text "beginnt, ansonsten FAIL."
                BR (&93834801584576)
                text "(4) Sei KVNR die authentifizierte KVNR gemäß "
                SPAN (&93834801584880)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17926"
                  attr data-item-id "ML-94729"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " aus dem geprüften ("
                SPAN (&93834799246808)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17919-01"
                  attr data-item-id "ML-109357"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text " ) AUT-Zertifikat. Falls das AUT-Zertifikat ein nicht-eGK-Zertifikat ist, dann sei KVNR="" (leere Zeichenkette)."
                BR (&93834799248320)
                text "(5) Sei TELEMATIK_ID die authentifizierte Telematik-ID aus dem geprüften ("
                SPAN (&93834799248624)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17919-01"
                  attr data-item-id "ML-109357"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text " ) AUT-Zertifikat. Falls das AUT-Zertifikat ein eGK-Zertifikat ist, dann sei TELEMATIK_ID="
                SPAN (&93834799250160)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text """"
                text "(leere Zeichenkette)."
                BR (&93834799250760)
                text "Hinweis:"
                BR (&93834799251064)
                text "die Prüfung, ob eine Umkodierung der TELEMATIK_ID notwendig ist (vgl. A_18003) erfolgt erst kurz vor dem Gebrauch der Variable in (12.5) oder (14.4). Der Entwickler kann selbst entscheiden, ob er schon hier die Prüfung durchführt."
                BR (&93834799251368)
                text "(6) Sei BEZ der Schlüsselbezeichner ("
                SPAN (&93834799251672)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17920-02"
                  attr data-item-id "ML-109460"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text "  ) des aktuellen (also jüngsten) Ableitungsschlüssel ("
                SPAN (&93834799253208)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17910-01"
                  attr data-item-id "ML-109449"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text " (S3))."
                BR (&93834799254744)
                text "(7) Sei s[0] bis s[n] die Teilzeichenketten von s, die durch ":" getrennt werden."
                BR (&93834799255048)
                text "(8) Wenn n gleich 0, dann FAIL."
                BR (&93834799255352)
                text " "
                BR (&93834799255656)
                text "(Verständnishinweis: vgl. Abschnitt [gemSpec_SGD_ePA#"
                SPAN (&93834799255960)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94493"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "]"
                BR (&93834799257320)
                text " "
                SPAN (&93834799257624)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r1:<KVNR>""
                BR (&93834799258104)
                text ")"
                BR (&93834799258408)
                text "(9) Wenn s[0] gleich"
                SPAN (&93834799258712)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r1""
                text " und n gleich 1 ist:"
                BR (&93834799259312)
                text "(9.1) Wenn KVNR gleich "" (leere Zeichenkette) ist, dann FAIL."
                BR (&93834799259616)
                text "(9.2) Wenn s[1] ungleich KVNR, dann FAIL."
                BR (&93834799259920)
                text "(9.3) Erzeuge RND gleich ein 256 Bit langer Zufallswert in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834799260224)
                text "(9.4) Erzeuge a="
                SPAN (&93834799260528)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r1:<RND>:<KVNR>:<BEZ>""
                text ". "
                BR (&93834799261128)
                text "(9.5) Sei Key die ersten 256 Bits der Schlüsselableitungsfunktion nach [gemSpec_Krypt#"
                SPAN (&93834799261432)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17876"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
                  attr id "fake"
                text "] mit IKM der aktuelle Ableitungsschlüssel und info=a. Sei Key in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834799262792)
                text "(9.6) Die Antwort ist gleich"
                SPAN (&93834799263096)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""OK-KeyDerivation ""
                text "+ Key +"
                SPAN (&93834799263696)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "" ""
                text "+ a. "
                BR (&93834799264296)
                text "(9.7) ENDE"
                BR (&93834799264600)
                text " "
                BR (&93834799264904)
                text " "
            text " "
          text " "
          TR (&93834799265448)
            text " "
            TD (&93834799265752)
              attr style "text-align: left;vertical-align: top;width: 748px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834799266112)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "(Verständnishinweis: vgl. Abschnitt [gemSpec_SGD_ePA#"
                SPAN (&93834799266592)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94492"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "]"
                BR (&93834799267952)
                text " "
                SPAN (&93834799268256)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r1:<256-Bit-RND-in-Hexform>:<KVNR>:<Ableitungsschlüsselbezeichner>""
                BR (&93834799268736)
                text ")"
                BR (&93834799269040)
                text "(10) Wenn s mit"
                SPAN (&93834799269344)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r1:""
                text "beginnt:"
                BR (&93834799269944)
                text "(10.2) Wenn n ungleich 3 ist, dann FAIL."
                BR (&93834799270248)
                text "(10.3) Wenn s[3] keinen im SGD-HSM verfügbaren Ableitungsschlüssel bezeichnet, dann FAIL."
                BR (&93834799270552)
                text "(10.4) Wenn die Länge von s[1] ungleich 64 ist, dann FAIL."
                BR (&93834799270856)
                text "(10.4) Wenn KVNR gleich"
                SPAN (&93834799271160)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text """"
                text "(leere Zeichenkette), dann FAIL."
                BR (&93834799271760)
                text "(10.5) Wenn s[2] ungleich KVNR ist, dann FAIL."
                BR (&93834799272064)
                text "(10.6) Führe die Schlüsselableitung nach [gemSpec_Krypt#"
                SPAN (&93834799272368)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17876"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
                  attr id "fake"
                text "] mit dem durch s[3] bezeichneten Ableitungsschlüssels (IKM) und info gleich s durch. Sei Key der abgeleitete 256-Bit Schlüssel in Hexadezimalschreibweise kodiert (ohne "0x")."
                BR (&93834799273728)
                text "(10.7) Die Antwort ist gleich"
                SPAN (&93834799274032)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""OK-KeyDerivation ""
                text "+ Key +"
                SPAN (&93834799274632)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "" ""
                text "+ s. "
                BR (&93834799275232)
                text "(10.8) ENDE"
                BR (&93834799275536)
                text " "
                BR (&93834799275840)
                text "(Verständnishinweis: vgl. Abschnitt [gemSpec_SGD_ePA#"
                SPAN (&93834799276144)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94494"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "]"
                BR (&93834799277504)
                text " "
                SPAN (&93834799277808)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r2:<KVNR-Vertreter oder Telematik-ID>""
                BR (&93834799278288)
                text ")"
                BR (&93834799278592)
                text "(11) Wenn s[0] gleich"
                SPAN (&93834799278896)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r2""
                text "ist und n gleich 1:"
                BR (&93834800947048)
                text "(11.1) Wenn s[1] gleich "" (leere Zeichenkette), dann FAIL."
                BR (&93834800947352)
                text "(11.2) Wenn KVNR gleich"
                SPAN (&93834800947656)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text """"
                text "(leere Zeichenkette), dann FAIL."
                BR (&93834800948232)
                text "(11.3) Erzeuge RND gleich ein 256 Bit langer Zufallswert in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834800948536)
                text "(11.4) Erzeuge a="
                SPAN (&93834800948840)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r2:<RND>:<KVNR>:""
                text "+ s[1] +"
                SPAN (&93834800949440)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "":<BEZ>""
                BR (&93834800949920)
                text "(11.5) Sei Key die ersten 256 Bits der Schlüsselableitungsfunktion nach [gemSpec_Krypt#"
                SPAN (&93834800950224)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17876"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
                  attr id "fake"
                text "] mit IKM der aktuelle Ableitungsschlüssel und info=a. Sei Key in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834800951584)
                text "(11.6) Die Antwort ist gleich"
                SPAN (&93834800951888)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""OK-KeyDerivation ""
                text " + Key +"
                SPAN (&93834800952488)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "" ""
                text "+ a. "
                BR (&93834800953088)
                text "(11.7) ENDE"
                BR (&93834800953392)
                text " "
                BR (&93834800953696)
                text "(Verständnishinweis: vgl. Abschnitt [gemSpec_SGD_ePA#"
                SPAN (&93834800954000)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94739"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "]"
                BR (&93834800955360)
                text " "
                SPAN (&93834800955664)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r2:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter oder Telematik-ID>:<Ableitungsschlüsselbezeichner>""
                BR (&93834800956144)
                text ")"
                BR (&93834800956448)
                text "(12) Wenn s[0] gleich"
                SPAN (&93834800956752)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r2""
                text "ist:"
                BR (&93834800957352)
                text "(12.1) Wenn n ungleich 4 ist, dann FAIL."
                BR (&93834800957656)
                text "(12.2) Wenn die Länge von s[1] ungleich 64 ist, dann FAIL."
                BR (&93834800957960)
                text "(12.3) Wenn s[2] gleich "" (leere Zeichenkette), dann FAIL."
                BR (&93834800958264)
                text "(12.4) Wenn s[4] keinen im SGD-HSM verfügbaren Ableitungsschlüssel bezeichnet, dann FAIL."
                BR (&93834800958568)
                text "(12.5) Wenn KVNR gleich"
                SPAN (&93834800958872)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text """"
                text "(leere Zeichenkette) und (logisches und) TELEMATIK_ID gleich"
                SPAN (&93834800959472)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text """"
                text "(leere Zeichenkette), dann FAIL."
                BR (&93834800960072)
                text "(12.6) Führe für die Variable TELEMATIK_ID die Prüfung und ggf. Umkodierung nach "
                SPAN (&93834800960376)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18003"
                  attr data-item-id "ML-95024"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " durch."
                BR (&93834800961912)
                text "(12.7) Wenn (s[3] ungleich TELEMATIK_ID) und (logisches und) (s[3] ungleich KVNR), dann FAIL."
                BR (&93834800962216)
                text "(12.8) Führe die Schlüsselableitung nach [gemSpec_Krypt#"
                SPAN (&93834800962520)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17876"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
                  attr id "fake"
                text "] mit dem durch s[4] bezeichneten Ableitungsschlüssels (IKM) und info gleich s durch. Sei Key der abgeleitete 256-Bit Schlüssel in Hexadezimalschreibweise kodiert (ohne "0x")."
                BR (&93834800963880)
                text "(12.9) Die Antwort ist gleich"
                SPAN (&93834800964184)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""OK-KeyDerivation ""
                text "+ Key +"
                SPAN (&93834800964784)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "" ""
                text "+ s. "
                BR (&93834800965384)
                text "(12.10) ENDE"
                BR (&93834800965688)
                text " "
                BR (&93834800965992)
                text "(Verständnishinweis: vgl. Abschnitt [gemSpec_SGD_ePA#"
                SPAN (&93834800966296)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94738"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ]"
                BR (&93834800967656)
                text " "
                SPAN (&93834800967960)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r3:<Telematik-ID>:<KVNR-Kontoinhaber>""
                BR (&93834800968440)
                text ")"
                BR (&93834800968744)
                text "(13) Wenn s[0] gleich"
                SPAN (&93834800969048)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r3""
                text "und n gleich 2:"
                BR (&93834800969648)
                text "(13.1) Wenn KVNR gleich"
                SPAN (&93834800969952)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text """"
                text "(leere Zeichenkette) ist, dann FAIL."
                BR (&93834800970552)
                text "(13.2) Erzeuge RND gleich ein 256 Bit langer Zufallswert in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834800970856)
                text "("
              text "13.3)"
              SPAN (&93834800971280)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Erzeuge a="
                SPAN (&93834800971760)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r3:<RND>:" + s[2] + ":<KVNR>:" + s[1] + ":<BEZ>""
                BR (&93834800972240)
                text "(13.4) Sei Key die ersten 256 Bits der Schlüsselableitungsfunktion nach [gemSpec_Krypt#"
                SPAN (&93834800972544)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17876"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
                  attr id "fake"
                text "] mit IKM gleich der aktuelle Ableitungsschlüssel und info=a. Sei Key in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834800973904)
                text "(13.5) Die Antwort ist gleich"
                SPAN (&93834800974208)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""OK-KeyDerivation ""
                text "+ Key +"
                SPAN (&93834800974808)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "" ""
                text "+ a. "
                BR (&93834800975408)
                text "(13.6) ENDE"
                BR (&93834800975712)
                text " "
                BR (&93834800976016)
                text "(Verständnishinweis: vgl. Abschnitt [gemSpec_SGD_ePA#"
                SPAN (&93834800976320)
                  attr class "polarion-rte-link"
                  attr data-item-id "ML-94741"
                  attr data-option-id "shortoutline"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "]"
                BR (&93834800977680)
                text " "
                SPAN (&93834800977984)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r3:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter>:<Telematik-ID>:<aktueller Ableitungsschlüsselbezeichner>""
                BR (&93834800978464)
                text ")"
                BR (&93834800978768)
                text "(14) Wenn s[0] gleich"
                SPAN (&93834800979072)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""r3""
                text "ist:"
                BR (&93834800979832)
                text "(14.1) Wenn n ungleich 5 ist, dann FAIL."
                BR (&93834800980016)
                text "(14.2) Wenn die Länge von s[1] ungleich 64 ist, dann FAIL."
                BR (&93834800980320)
                text "(14.3) Wenn s[5] keinen im SGD-HSM verfügbaren Ableitungsschlüssel bezeichnet, dann FAIL."
                BR (&93834800980624)
                text "(14.4) Führe für die Variable TELEMATIK_ID die Prüfung und ggf. Umkodierung nach "
                SPAN (&93834800980928)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18003"
                  attr data-item-id "ML-95024"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " durch."
                BR (&93834800982464)
                text "(14.5) Wenn s[4] ungleich TELEMATIK_ID, dann FAIL."
                BR (&93834800982768)
                text "(14.6) Sei Key die ersten 256 Bits der Schlüsselableitungsfunktion nach [gemSpec_Krypt#"
                SPAN (&93834800983072)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17876"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94673"
                  attr id "fake"
                text "] mit IKM gleich der aktuelle Ableitungsschlüssel und info gleich s. Sei Key in Hexadezimalschreibweise kodiert ohne "0x" am Anfang."
                BR (&93834800984432)
                text "(14.7) Die Antwort ist gleich"
                SPAN (&93834800984736)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""OK-KeyDerivation ""
                text "+ Key +"
                SPAN (&93834800985336)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "" ""
                text "+ s. "
                BR (&93834800985936)
                text "(14.8) ENDE"
                BR (&93834800986240)
                text " "
                BR (&93834800986544)
                text "(15) FAIL"
            text " "
          text " "
        text " "
      text " "
      P (&93834800987328)
        attr id "polarion_73"
      text " "
      DIV (&93834800987808)
        attr id "A_17924-01"
        text " "
        P (&93834800988288)
          B (&93834800988472)
            text "A_17924-01 - Anfragen an das SGD-HSM (Client)"
        text " "
        P (&93834800988896)
          text "Ein Client eines SGD ePA MUSS für die Anfragen an das SGD-HSM die Syntax der Kommandos und der Antworten des SGD-HSMs (für die Kommandos im verschlüsselten "EncryptedMessage"-Feld in"
          SPAN (&93834800989200)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " und die Auswertung der entschlüsselten Antwort ("
          SPAN (&93834800990560)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""<Authentisierungstoken> <Request-ID> OK-KeyDerivation ...""
          text ")) gemäß "
          SPAN (&93834800991160)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17922"
            attr data-item-id "ML-94727"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " verwenden und auswerten können."
          B (&93834800992520)
            text "[<=]"
        text " "
      text " "
      H4 (&93834800993064)
        attr id "4.5.5"
        text "4.5.5 Betriebsunterstützende Leistungen im SGD-HSM"
      text " "
      P (&93834800993664)
        attr id "polarion_62"
      text " "
      DIV (&93834800994144)
        attr id "A_20975"
        text " "
        P (&93834800994624)
          B (&93834800994808)
            text "A_20975 - SGD-HSM, Ausgabe der konkreten Schlüsselwerte der Prüfschlüssel (S2)"
        text " "
        P (&93834800995232)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen: Ein SGD-HSM MUSS es ermöglichen die aktuell im SGD-HSM gültigen Zertifikatssignaturprüfschlüssel (S2) (inkl. der Root-Schlüssel) (vgl. A_17910-*) mit ihren konkreten Schlüsselwerten (öffentliche Schlüsselwerte) auszugeben. <="
          B (&93834800995536)
            text "[<=]"
        text " "
      text " "
      DIV (&93834800996080)
        attr id "A_20976"
        text " "
        P (&93834800996560)
          B (&93834800996744)
            text "A_20976 - SGD-HSM, Informationen über die im SGD-HSM vorhandenen Ableitungsschlüssel (S3)"
        text " "
        P (&93834800997168)
          text "Ein SGD ePA MUSS folgende Vorgaben durchsetzen: Ein SGD-HSM MUSS es ermöglichen über alle im SGD-HSM befindlichen Ableitungsschlüssel (S3) (vgl. A_17910-*) zu iterieren und dabei pro Ableitungsschlüssel das Tupel (dessen Ableitungsschlüsselbezeichner (vgl. A_17920-*), dessen Ableitungsschlüsselprüfwert) auszugeben."
          BR (&93834800997472)
          text "Der Ableitungsschlüsselprüfwert eines Ableitungsschlüssels wird erzeugt indem man"
          BR (&93834800997776)
          text " "
        OL (&93834800998080)
          text " "
          LI (&93834800998384)
            text "den Ableitungsschlüssel bei einer Schlüsselableitung gemäß gemSpec_Krypt#A_17876 (also HKDF nach [RFC-5869] auf Basis von SHA-256) verwendet mit dem Ableitungsvektor „Ableitungsschluesselpruefwert-Schluessel-S3“ (”info” Parameter aus [RFC-5869]),"
          text " "
          LI (&93834800998808)
            text "damit einen 256 Bit Wert ableitet (d. h. deterministisch erzeugt), und"
          text " "
          LI (&93834800999232)
            text "diesen Wert hexadezimal kodiert.Dieser 64 Zeichen lange hexadezimal kodierte Wert ist dann der Ableitungsschlüsselprüfwert des betrachteten Ableitungsschlüssels."
          text " "
        text " "
        B (&93834800999776)
          text "[<=]"
        P (&93834801000080)
        text " "
      text " "
      H3 (&93834801000504)
        attr id "4.6"
        text "4.6 Betriebsunterstützende Leistungen allgemein"
      text " "
      DIV (&93834801001104)
        attr id "A_22501"
        text " "
        P (&93834801001584)
          B (&93834801001768)
            text "A_22501 - SGD, Betriebsunterstützende Leistungen allgemein"
        text " "
        P (&93834801002192)
          text "Ein SGD ePA MUSS als Teil des Lieferumfangs SGD-Produkt einem Betreiber des SGD Kommandozeilen-Tools zur Verfügung stellen, die folgende Leistungen ermöglichen."
          BR (&93834801002496)
          text " "
        OL (&93834801002800)
          text " "
          LI (&93834801003104)
            text "Die Leistungen von A_20975-* und A_20976-* MÜSSEN für den Betreiber per Tool erreichbar (ausführbar) und per Kommando-Zeilen-Tool auch automatisiert"
            SPAN (&93834801003408)
              attr id "polarion-comment:398"
            text "ausführbar sein."
          text " "
          LI (&93834801004008)
            text "Neue Prüfschlüssel (S2) (vgl. A_17910-*) also Root-Schlüssel, CA-Schlüssel und OCSP-Schlüssel MÜSSEN für den Betreiber ohne Beteiligung der gematik über die Cross-Zertifizierung und die Prüfung durch das SGD-HSM auf Grundlage von schon im SGD-HSM vorhandenen Schlüssel per Tool importierbar sein."
            BR (&93834801004312)
            text "Dies ist notwendig falls durch Fehlfunktion im SGD diese nicht automatisch durch den SGD in die SGD-HSM importiert wurden (vgl. A_17952-*, A_17953-*, A_17954-*). Dann kann der Betreiber den Import "per Hand" ohne Mitwirkung der gematik durchführen (vgl. auch A_22502-*)."
          text " "
        text " "
        B (&93834801004856)
          text "[<=]"
        P (&93834801005160)
        text " "
      text " "
      P (&93834801005584)
        attr id "polarion_327"
        text " Die RVE ist dafür verantwortlich neu in der TSL aufgeführte Prüfschlüssel automatisch in die SGD-HSM zu importieren (vgl. Abschnitt ""
        SPAN (&93834801006064)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94787"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " "). Die SGD-HSM stellen die Authentiztität der neu importieren Prüfschlüssel über die Signaturprüfung auf Grundlage von schon im SGD-HSM vorhandenen Root- und CA-Schlüsseln sicher. Um im Betrieb zu erkennen, ob dieses Update evtl. fehlerhafter Weise nicht erfolgt ist, wird mit A_22502-* eine automatische Überprüfung (Abgleich Ist-Soll-Stand der Prüfschlüssel in den SGD-HSM) gefordert."
      text " "
      DIV (&93834801007544)
        attr id "A_22502"
        text " "
        P (&93834801008024)
          B (&93834801008208)
            text "A_22502 - SGD, Betrieb, automatisierter Abgleich Ist- und Soll-Wert (S2)-Schlüssel"
        text " "
        P (&93834801008632)
          text "Der Anbieter eines SGD ePA MUSS sicherstellen, dass der SGD mindestens einmal pro Woche die von der gematik veröffentlichte Liste der öffentlichen (S2)-Zertifikatssignaturprüfschlüssel (Soll-Wert) mit den in den SGD-HSM befindlichen (S2)-Zertifikatssignaturprüfschlüssel abgleicht. Falls es beim Abgleich sich eine Differenz ungleich Null ergibt, so MUSS der Anbieter den Änderungsbedarf analysieren und die fehlenden Prüfschlüssel (vgl. A_22501-* Punkt 2) in den SGD-HSM ergänzen."
          B (&93834801008936)
            text "[<=]"
        text " "
      text " "
      P (&93834801009480)
        attr id "polarion_326"
        text "Erläuterung: die URL für den Download der Soll-Wert-Liste erfragt der Anbieter (bzw. der Betreiber) bei der gematik. Das Format der Soll-Wert-Liste ist das aus der gemeinsamen Schlüsselzeremonie Erst-Initialisierung der SGD-HSM (chk_import_list.py)."
      text " "
      P (&93834801010080)
        attr id "polarion_328"
        text "Die Umsetzung des Fehlererkennungsteils von A_22502 ist in nur wenigen Zeilen Bash-Skript möglich."
      text " "
      H2 (&93834801010680)
        attr id "5"
        text "5 Kodierung von Schlüsseln und Nachrichten"
      text " "
      P (&93834801011280)
        attr id "polarion_202"
        text "Im Rahmen des SGD-Protokolls müssen verschiedene Zahlenwerte (Koordinaten von Kurvenpunkten) und Hashwerte (Hashwerte von Schlüsselwerten) kodiert werden. Diese Kodierungen fließen an mehreren Stellen in eine Hashwerterzeugung mit ein. Dabei ist es wichtig, ob bspw. die Zahl 10 als "0xa" oder "0xA" kodiert wird. Analog bei Hashwerten in Hexadezimalform, die in eine Hashwerterzeugung mit einfließen."
      text " "
      DIV (&93834801011880)
        attr id "A_18249"
        text " "
        P (&93834801012360)
          B (&93834776361992)
            text "A_18249 - Groß- und Kleinschreibung von Daten in Hexadezimalform"
        text " "
        P (&93834776362416)
          text "Ein SGD ePA und ein Client eines SGD ePA MÜSSEN sicherstellen, dass, wenn sie Datenfeld in Hexadezimalform kodieren, sie stets kleine Buchstaben bei der Hexadezimal-Kodierung verwenden (a-f und nicht A-F)."
          B (&93834776362720)
            text "[<=]"
        text " "
      text " "
      P (&93834776363264)
        attr id "polarion_170"
        text "Gut-Beispiel (vgl."
        SPAN (&93834776363720)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17900"
          attr data-item-id "ML-94700"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ):"
      text " "
      P (&93834776365376)
        attr id "polarion_175"
        text " "
        SPAN (&93834776365856)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""brainpoolP256r1 " +"
        BR (&93834776366336)
        text " "
        SPAN (&93834776366640)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""0x3672030bace787aa319e21d40645b2999006beec437fd084dd3fc592f5fcd77c" + " " +"
        BR (&93834776367120)
        text " "
        SPAN (&93834776367424)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""0x335b226ce5fac0c36a18ce42e95f43c9eed3e256bdd0c98e55a069595515d15b" + " " +"
        BR (&93834776367904)
        text " "
        SPAN (&93834776368208)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""a3a56e51377c1de0bea0522eba3ec6277e3355edb67d48b9852ab7d7e536feb7" + " " +"
        BR (&93834776368688)
        text " "
        SPAN (&93834776368992)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""8b2405f41cebaf44d10b2c9025484515b005be5ba785d0c898eae0739a67eb5a""
        text " "
      text " "
      DIV (&93834776369712)
        attr id "A_18250"
        text " "
        P (&93834776370192)
          B (&93834776370376)
            text "A_18250 - keine führenden Nullen bei Punktkoordinaten"
        text " "
        P (&93834776370800)
          text "Ein SGD ePA und ein Client eines SGD ePA MÜSSEN sicherstellen, dass wenn sie Koordinaten von Kurvenpunkten in Hexadezimalform kodieren, keine führende(n) Null(en) verwenden:"
          BR (&93834776371104)
          text "OK: "0xa8f217b77338f1d4d6624c3ab4f6cc16d2aa843d0c0fca016b91e2ad25cae39d""
          BR (&93834776371408)
          text "Falsch: "0x0a8f217b77338f1d4d6624c3ab4f6cc16d2aa843d0c0fca016b91e2ad25cae39d""
          BR (&93834776371712)
          text "Falsch: "0x00a8f217b77338f1d4d6624c3ab4f6cc16d2aa843d0c0fca016b91e2ad25cae39d""
          B (&93834776372016)
            text "[<=]"
        text " "
      text " "
      P (&93834776372560)
        attr id "polarion_205"
        text "Bei der Kodierung der ECIES-Schlüssel (vgl."
        SPAN (&93834776373040)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17894-01"
          attr data-item-id "ML-109378"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  und "
        SPAN (&93834776374576)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17900"
          attr data-item-id "ML-94700"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") müssen X- und Y-Koordinaten als Zahlenwerte in Hexadezimalform in einer menschenlesbaren Zeichenkette (string) kodiert werden. Es gibt Kryptographie-Softwarebibliotheken, die falls die Koordinatenwerte mit einer 1 im most-significant Byte beginnen, ein Nullbyte vor den Koordinatenwert setzen. Dies kommt aus einer Konvention aus der ASN.1-Kodierungsweise, die im SGD-Kontext keine Rolle spielt (Ausnahme im DER-kodierten Zertifikat selbst). Beispiel: Die Zahl 128 muss Hexadezimal als "0x80" und nicht als "0x0080" kodiert werden."
      text " "
      H3 (&93834776376232)
        attr id "5.1"
        text "5.1 Kodierung von Schlüsseln"
      text " "
      H4 (&93834776376832)
        attr id "5.1.1"
        text "5.1.1 ECIES-Schlüssel eines SGD-HSM"
      text " "
      P (&93834776377432)
        attr id "polarion_216"
        text "Bei der Operation GetPublicKey (A_17895-*) muss der aktuelle öffentliche ECIES-Schlüssel ("
        SPAN (&93834776377912)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17910-01"
          attr data-item-id "ML-109449"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  (S4)) des SGD-HSMs an einen Client versendet werden."
      text " "
      DIV (&93834776379568)
        attr id "A_17894-01"
        text " "
        P (&93834776380048)
          B (&93834776380232)
            text "A_17894-01 - SGD, Kodierung des öffentlichen ECIES-Schlüssels + Signatur + Zertifikat"
        text " "
        P (&93834776380656)
          text "Ein SGD ePA MUSS sicherstellen, dass der signierte öffentliche ECIES-Schlüssel inkl. Zertifikat eines SGD-HSMs in folgender Kodierung übertragen (vgl. Operation GetPublicKey, A_17895-*) wird."
          BR (&93834776380960)
          text " "
          BR (&93834776381264)
          text " "
          SPAN (&93834776381568)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "{ "PublicKeyECIES" : "<KurvenID> 0x<X-Koordinate> 0x<Y-Koordinate>","
          BR (&93834776382048)
          text " "
          SPAN (&93834776382352)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "  "Signature" : "... Base64-kodierte-ECDSA-Signatur ...","
          BR (&93834776382832)
          text " "
          SPAN (&93834776383136)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "  "Certificate" : "... Base64-kodiertes Zertifikat vgl."
          text " "
          SPAN (&93834776383736)
            attr style "font-size: 10pt;line-height: 1.5;"
            SPAN (&93834776384096)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17846-01"
              attr data-item-id "ML-109456"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " "
          SPAN (&93834776385456)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text " und "
          SPAN (&93834776385936)
            attr style "font-size: 10pt;line-height: 1.5;"
            SPAN (&93834776386296)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17918-01"
              attr data-item-id "ML-109457"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text " "
          SPAN (&93834776387656)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text " ..." }"
          BR (&93834776388136)
          text " "
          SPAN (&93834776388440)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "}"
          BR (&93834776388920)
          text " "
          BR (&93834776389224)
          text " "
          B (&93834776389528)
            text "[<=]"
        text " "
      text " "
      P (&93834776390072)
        attr id "polarion_204"
        text "Hinweis zum besseren Verständnis: Da das Zertifikat im "Certificate"-Datenfeld direkt in der TSL aufgeführt ist (vgl."
        SPAN (&93834776390552)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17847"
          attr data-item-id "ML-94621"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") und die TSL eine Positivliste ist, gibt es keine Aufführung ("
        SPAN (&93834776392088)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17894-01"
          attr data-item-id "ML-109378"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ) oder Einholung von OCSP-Responses."
      text " "
      P (&93834776393744)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_133"
        text "Tabelle "
        SPAN (&93834776394576)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "5"
        text ": Beispiel zu A_17894"
      text " "
      TABLE (&93834776395488)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|uid=2"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834776396320)
          text " "
          TR (&93834776396624)
            text " "
            TD (&93834776396928)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 194px;border: 1px solid #CCCCCC;padding: 5px;"
              SPAN (&93834776397288)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Sei der aktuelle private ECIES-Schlüssel eines SGD-HSM d=2, dann ist der öffentliche Punkt 2*G [RFC-5639] aufgrund von [gemSpec_Krypt#"
                SPAN (&93834776397768)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17694"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94215"
                  attr id "fake"
                text "]. Damit ist das "PubKeyECIES"-Datenfeld nach "
                SPAN (&93834776399128)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17894-01"
                  attr data-item-id "ML-109378"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text "  folgende Zeichenkette:"
              BR (&93834776400664)
              text " "
              SPAN (&93834776400968)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""brainpoolP256r1" + " " + "
              BR (&93834776401448)
              text " "
              SPAN (&93834776401752)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x743cf1b8b5cd4f2eb55f8aa369593ac436ef044166699e37d51a14c2ce13ea0e" + " " +"
              BR (&93834776402232)
              text " "
              SPAN (&93834776402536)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x36ed163337deba9c946fe0bb776529da38df059f69249406892ada097eeb7cd4""
              BR (&93834776403016)
              text " "
              BR (&93834776403320)
              text " "
              SPAN (&93834776403624)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Für die bitgenaue Aufführung wird nachfolgend das Datenfeld auch noch einmal Base64-kodiert angegeben:"
              BR (&93834776404104)
              text " "
              SPAN (&93834776404408)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "YnJhaW5wb29sUDI1NnIxIDB4NzQzY2YxYjhiNWNkNGYyZWI1NWY4YWEzNjk1OTNhYzQzNmVmMDQ0"
              BR (&93834776404888)
              text " "
              SPAN (&93834776405192)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "MTY2Njk5ZTM3ZDUxYTE0YzJjZTEzZWEwZSAweDM2ZWQxNjMzMzdkZWJhOWM5NDZmZTBiYjc3NjUy"
              BR (&93834776405672)
              text " "
              SPAN (&93834776405976)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "OWRhMzhkZjA1OWY2OTI0OTQwNjg5MmFkYTA5N2VlYjdjZDQK"
            text " "
          text " "
        text " "
      text " "
      P (&93834776406936)
        attr id "polarion_209"
      text " "
      DIV (&93834776407416)
        attr id "A_17899"
        text " "
        P (&93834776407896)
          B (&93834776408080)
            text "A_17899 - SGD-Clients, Auswertung der Kodierung des öffentlichen ECIES-Schlüssels eines SGD-HSMs"
        text " "
        P (&93834776408504)
          text "Ein Client eines SGD ePA MUSS als Antwort auf einen GetPublicKey-Request (A_17895-*) die Kodierung nach "
          SPAN (&93834776408808)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17894-01"
            attr data-item-id "ML-109378"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  des öffentlichen ECIES-Schlüssels eines SGD-HSMs auswerten können."
          B (&93834776410168)
            text "[<=]"
        text " "
      text " "
      H4 (&93834776410712)
        attr id "5.1.2"
        text "5.1.2 ECIES-Schlüssel eines Clients"
      text " "
      P (&93834776411312)
        attr id "polarion_207"
        text "Das kurzlebige ECIES-Schlüsselpaar eines Clients (ePA-FdV, FM EPA etc.) muss an die aktuellen öffentlichen ECDH-Schlüssel des nun angefragten SGD-HSM "gebunden" werden. Dies geschieht über die Signatur durch die eGK, die alternative Versichertenidentität, die SMC-B oder eine SMC-KTR."
      text " "
      DIV (&93834776411912)
        attr id "A_17900"
        text " "
        P (&93834776412392)
          B (&93834776412576)
            text "A_17900 - SGD-Clients, Kodierung des eigenen kurzlebigen ECIES-Schlüssels"
        text " "
        P (&93834776413000)
          text "Ein Client eines SGD ePA MUSS für die Kodierung des "PublicKeyECIES"-Feldes folgende Kodierung verwenden (vgl. A_17895-*):"
          BR (&93834776413304)
          text " "
          BR (&93834776413608)
          text """
          SPAN (&93834776413912)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "<KurvenID>" + " " + "0x<X-Koordinate>" + " " + "0x<Y-Koordinate>" + " " + "<SHA-256-Hashwert-PubKey-SGD1-HSM-Hexdump-Form>" + " " + "<SHA-256-Hashwert-PubKey-SGD2-HSM-Hexdump-Form>""
          BR (&93834776414392)
          text "(vgl. [gemSpec_SGD_ePA#Hinweis zu A_17900])."
          B (&93834776414696)
            text "[<=]"
        text " "
      text " "
      P (&93834776415240)
        attr id "polarion_217"
        text "Hinweis zu A_17900: vor den SHA-256-Hashwerten steht kein "0x"-Präfix, weil es sich bei SHA-256-Hashwerten nicht um Zahlen handelt, sondern um 256-Bit große Bitfelder."
      text " "
      P (&93834776415840)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_143"
        text "Tabelle "
        SPAN (&93834776416672)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "6"
        text ": Beispiel zu A_17900"
      text " "
      TABLE (&93834776417568)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=2"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834776418400)
          text " "
          TR (&93834776418704)
            text " "
            TD (&93834776419008)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 96.6667px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834776419368)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Im Beispiel wird zunächst ein ECIES-Schlüssel für SGD 1 erzeugt (Schritt 1) und dann für SGD 2 (Schritt 2)."
              BR (&93834776419848)
              text " "
              SPAN (&93834776420152)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Danach wird ein ECIES-Schlüssel vom Client erzeugt und die Hashwerte der beiden SGD-Schlüssel (aus Schritt 1 und Schritt 2) werden in die Kodierung des öffentlichen Client-Schlüssels mit aufgenommen (Schritt 3)."
              BR (&93834776420632)
              text " "
              BR (&93834776420936)
              text " "
              SPAN (&93834776421240)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Schritt 1, aktueller Schlüssel SGD 1:"
              BR (&93834776421720)
              text " "
            text " "
          text " "
          TR (&93834776422264)
            text " "
            TD (&93834776422568)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 174px;border: 1px solid #CCCCCC;padding: 2px;"
              text "Sei als Beispiel der aktuelle private ECIES-Schlüssel eines SGD-HSM vom SGD 1:"
              BR (&93834776423048)
              text " "
              DIV (&93834776423352)
                attr style "margin-left: 40px;"
                text "d=2."
              text "Dann ist der öffentliche Punkt d*G=2*G [RFC-5639] aufgrund von [gemSpec_Krypt#"
              SPAN (&93834776423952)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17694"
                attr data-scope "Mainline_OPB1"
                attr data-type "polarion"
                attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94215"
                attr id "fake"
              text "]. Somit ist das "PubKeyECIES"-Datenfeld nach "
              SPAN (&93834776425312)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17894-01"
                attr data-item-id "ML-109378"
                attr data-option-id "custom"
                attr data-scope "Mainline_OPB1"
                attr data-type "workItem"
                attr id "fake"
              text "  folgende Zeichenkette:"
              BR (&93834776426848)
              text " "
              SPAN (&93834776427152)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""brainpoolP256r1" + " " + "
              BR (&93834798949232)
              text " "
              SPAN (&93834798949536)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x743cf1b8b5cd4f2eb55f8aa369593ac436ef044166699e37d51a14c2ce13ea0e" + " " +"
              BR (&93834798949992)
              text " "
              SPAN (&93834798950296)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x36ed163337deba9c946fe0bb776529da38df059f69249406892ada097eeb7cd4"
              BR (&93834798950776)
              text "dessen SHA-256-Hashwert ist folglich"
              BR (&93834798951080)
              text " "
              SPAN (&93834798951384)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "a3a56e51377c1de0bea0522eba3ec6277e3355edb67d48b9852ab7d7e536feb7"
              BR (&93834798951864)
              text " "
            text " "
          text " "
          TR (&93834798952408)
            text " "
            TD (&93834798952712)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 18.4444px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834798953072)
                attr style "font-weight: bold;"
                text "Schritt 2, aktueller Schlüssel SGD 2:"
              BR (&93834798953552)
              text " "
            text " "
          text " "
          TR (&93834798954096)
            text " "
            TD (&93834798954400)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 117.111px;border: 1px solid #CCCCCC;padding: 2px;"
              text "Analog der aktuelle Schlüssel des verwendeten SGD-HSM vom SGD 2 mit d=3:"
              BR (&93834798954880)
              text " "
              SPAN (&93834798955184)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""brainpoolP256r1 " +"
              BR (&93834798955664)
              text " "
              SPAN (&93834798955968)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0xa8f217b77338f1d4d6624c3ab4f6cc16d2aa843d0c0fca016b91e2ad25cae39d" + " " +"
              BR (&93834798956448)
              text " "
              SPAN (&93834798956752)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x4b49cafc7dac26bb0aa2a6850a1b40f5fac10e4589348fb77e65cc5602b74f9d""
              BR (&93834798957232)
              text "dessen SHA-256-Hashwert ist damit"
              BR (&93834798957536)
              text " "
              SPAN (&93834798957840)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "8b2405f41cebaf44d10b2c9025484515b005be5ba785d0c898eae0739a67eb5a"
              BR (&93834798958320)
              text " "
            text " "
          text " "
          TR (&93834798958864)
            text " "
            TD (&93834798959168)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 37.1111px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834798959528)
                attr style "font-weight: bold;"
                text "Schritt 3, an die beiden Schlüssel über die Hashwerte und die folgende Signatur gebundener ephemerer ECIES-Schlüsselwert des Clients:"
              BR (&93834798960008)
              text " "
            text " "
          text " "
          TR (&93834798960552)
            text " "
            TD (&93834798960856)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 174.889px;border: 1px solid #CCCCCC;padding: 2px;"
              text "Dessen privater Schlüssel sei als Beispiel d=4. Damit ergibt sich mit den Schritten 1 und 2 zusammen folgende Zeichenkette."
              BR (&93834798961336)
              text " "
              SPAN (&93834798961640)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""brainpoolP256r1 " +"
              BR (&93834798962120)
              text " "
              SPAN (&93834798962424)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x3672030bace787aa319e21d40645b2999006beec437fd084dd3fc592f5fcd77c" + " " +"
              BR (&93834798962904)
              text " "
              SPAN (&93834798963208)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""0x335b226ce5fac0c36a18ce42e95f43c9eed3e256bdd0c98e55a069595515d15b" + " " +"
              BR (&93834798963688)
              text " "
              SPAN (&93834798963992)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""a3a56e51377c1de0bea0522eba3ec6277e3355edb67d48b9852ab7d7e536feb7" + " " +"
              BR (&93834798964472)
              text " "
              SPAN (&93834798964776)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""8b2405f41cebaf44d10b2c9025484515b005be5ba785d0c898eae0739a67eb5a""
              BR (&93834798965256)
              text " "
              BR (&93834798965560)
              text "Diese Zeichenkette würde dann als Wert im Value-Feld beim "PublicKeyECIES"-Feld in einem Request bei "
              SPAN (&93834798965864)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17898 (KeyDerivation)"
                attr data-item-id "ML-94696"
                attr data-option-id "custom"
                attr data-scope "Mainline_OPB1"
                attr data-type "crossReference"
                attr id "fake"
              text " stehen."
              BR (&93834798967400)
              text " "
            text " "
          text " "
        text " "
      text " "
      DIV (&93834798968184)
        attr id "A_17901"
        text " "
        P (&93834798968664)
          B (&93834798968848)
            text "A_17901 - SGD-Clients, Kodierung der Signatur des eigenen ECIES-Schlüssels"
        text " "
        P (&93834798969272)
          text "Ein Client eines SGD ePA MUSS die Kodierung des eigenen kurzlebigen ECIES-Schlüssels nach"
          SPAN (&93834798969576)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17900"
            attr data-item-id "ML-94700"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " signieren (mittels des AUT- oder AUT_ALT-Materials). Diese Signatur MUSS von ihm Base64-kodiert in den Value-Teil des "Signature"-Felds bei der Operation GetAuthenticationToken (A_18025-*) und KeyDerivation "
          SPAN (&93834798970936)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text "  für einen Request eingetragen werden."
          BR (&93834798972296)
          text " "
          B (&93834798972600)
            text "[<=]"
        text " "
      text " "
      H3 (&93834798973144)
        attr id "5.2"
        text "5.2 Kodierung von Chiffraten"
      text " "
      DIV (&93834798973744)
        attr id "A_17902"
        text " "
        P (&93834798974224)
          B (&93834798974408)
            text "A_17902 - Kontext SGD, Chiffrat-Kodierung beim Nachrichtentransport"
        text " "
        P (&93834798974832)
          text "Ein SGD ePA und ein Client eines SGD ePA MÜSSEN sicherstellen, dass die in den "EncryptedMessage"-Feldern bei"
          SPAN (&93834798975136)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17894-01"
            attr data-item-id "ML-109378"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  (GetAuthenticationToken) und bei"
          SPAN (&93834798976496)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898 (KeyDerivation)"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " kodierten Chiffrate (jeweils bei dem Request und bei der Response) folgendes Format aufweisen:"
          BR (&93834798977856)
          text " "
          BR (&93834798978160)
          text "Hilfsdefinitionen:"
          BR (&93834798978464)
          text " "
        OL (&93834798978768)
          text " "
          LI (&93834798979072)
            text "Sei "ECC-Punkt-Empfänger" der öffentliche Empfängerschlüssel in der Kodierung nach ["
            SPAN (&93834798979376)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17894-01"
              attr data-item-id "ML-109378"
              attr data-option-id "custom"
              attr data-type "workItem"
              attr id "fake"
            text "  #"PublicKeyECIES"-Datenfeld] ("
            SPAN (&93834798980736)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text ""<KurvenID> 0x<X-Koordinate> 0x<Y-Koordinate>""
            text ")."
            BR (&93834798981336)
            text " "
          text " "
          LI (&93834798981896)
            text "Sei "ephemer-Sender-ECC-Punkt" der pro ECIES-Verschlüsselung vom Sender ephemer zu erzeugende öffentlichen ECC-Punkt. Dieser ist in der Kodierung"
            SPAN (&93834798982080)
              attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
              text ""0x<X-Koordinate> 0x<Y-Koordinate>""
            text "kodiert."
            BR (&93834798982680)
            text " "
          text " "
          LI (&93834798983104)
            text "Sei "Base64-Ciphertext-AES-GCM" das Base64-kodierte AES-GCM-Chiffrat, wobei das AES-GCM-Chiffrat aus der Aneinanderreihung folgender Bestandteile besteht:"
            BR (&93834798983408)
            text "12 Byte IV + AES-GCM-Ciphertext + 16 Byte AuthTag (ICV). (vgl. auch [gemSpec_Krypt#"
            SPAN (&93834798983712)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17875"
              attr data-type "polarion"
              attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
              attr id "fake"
            text "])"
            BR (&93834798984896)
            text " "
          text " "
        text "Das Format MUSS folgende Form besitzen:"
        BR (&93834798985440)
        text " "
        SPAN (&93834798985744)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text ""<ECC-Punkt-Empfänger> <ephemer-Sender-ECC-Punkt> <Base64-Ciphertext-AES-GCM>""
        BR (&93834798986224)
        text " "
        BR (&93834798986528)
        text "(vgl. auch "Beispiel zu "
        SPAN (&93834798986832)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17902"
          attr data-item-id "ML-94703"
          attr data-option-id "custom"
          attr data-type "crossReference"
          attr id "fake"
        text "")"
        BR (&93834798988192)
        text " "
        B (&93834798988496)
          text "[<=]"
        P (&93834798988800)
        text " "
      text " "
      P (&93834798989224)
        attr id "polarion_141"
        text "Hinweise zu "
        SPAN (&93834798989704)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17902"
          attr data-item-id "ML-94703"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ":"
      text " "
      OL (&93834798991360)
        attr id "polarion_100"
        text " "
        LI (&93834798991840)
          text "Der bei den Requests bei "
          SPAN (&93834798992144)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17894-01"
            attr data-item-id "ML-109378"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "workItem"
            attr id "fake"
          text "  (GetAuthenticationToken) und bei"
          SPAN (&93834798993680)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898 (KeyDerivation)"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text "übergebene ECIES-Schlüssel hat nach"
          SPAN (&93834798995216)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17900"
            attr data-item-id "ML-94700"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text " die beiden Hashwerte der SGD-HSMs Schlüssel von SGD 1 und SGD 2 beigefügt (durch die Signatur des Client mit authentisiert). Beim der Chiffratkodierung nach "
          SPAN (&93834798996752)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17902"
            attr data-item-id "ML-94703"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text " sind die beiden Hashwerte kein Teil des Chiffrats, weil sie dort fachlich nicht notwendig sind."
        text " "
        LI (&93834798998408)
          text "Beim pro ECIES-Verschlüsselung vom Sender zu erzeugende ephemeren ECC-Punkt ("ephemer-Sender-ECC-Punkt") wird der Kurvenidentifikator (KurvenID) nicht mit aufgeführt, da der ECC-Punkt auf der gleichen Kurve wie der Empfänger ECC-Punkt liegen muss (vgl."
          SPAN (&93834798998712)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17903"
            attr data-item-id "ML-94702"
            attr data-option-id "custom"
            attr data-scope "Mainline_OPB1"
            attr data-type "crossReference"
            attr id "fake"
          text ")."
        text " "
      text " "
      P (&93834799000488)
        attr id "polarion_146"
        text "Beispiel zu "
        SPAN (&93834799000968)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17902"
          attr data-item-id "ML-94703"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ":"
      text " "
      P (&93834799002624)
        attr id "polarion_260"
        text "Sei durch den Client folgender Klartext im Rahmen der Operation KeyDerivation ("
        SPAN (&93834799003104)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18029"
          attr data-item-id "ML-96286"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") vom Client an ein SGD-HSM zu übertragen:"
      text " "
      P (&93834799004760)
        attr id "polarion_151"
        text " "
        SPAN (&93834799005240)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""AT1ce627dd5e4c6536ca0dd93f896744d42c6580537953a49fcc5840dd8f8f4efa "
        SPAN (&93834799005720)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "7522d04ca28f2c6d3f5a53b2a31aebe1f91f2cfb75145b35c9a01fae7930340c "
        SPAN (&93834799006200)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "KeyDerivation r2:7f8f77003dbab49c3a4e32f44726f92324d292fa668fde5ebc3424397986be99:107299005A112102647:2-20a1201-001:Bezeichner ACME Q1 2020""
        text " "
      text " "
      P (&93834799006920)
        attr id "polarion_160"
        text "Dann hat das für den Request vom Client zu erzeugende Chiffrat ("EncryptedMessage"-Feld im Request) folgende Form"
      text " "
      P (&93834799007520)
        attr id "polarion_169"
        text " "
        SPAN (&93834799008000)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""brainpoolP256r1" + " " + "
        BR (&93834799008480)
        text " "
        SPAN (&93834799008784)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""0x743cf1b8b5cd4f2eb55f8aa369593ac436ef044166699e37d51a14c2ce13ea0e" + " " +"
        BR (&93834799009264)
        text " "
        SPAN (&93834799009568)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""0x36ed163337deba9c946fe0bb776529da38df059f69249406892ada097eeb7cd4" + " " +"
        BR (&93834799010048)
        text " "
        SPAN (&93834799010352)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""0xa8f217b77338f1d4d6624c3ab4f6cc16d2aa843d0c0fca016b91e2ad25cae39d" + " " +"
        BR (&93834799010832)
        text " "
        SPAN (&93834799011136)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""0x4b49cafc7dac26bb0aa2a6850a1b40f5fac10e4589348fb77e65cc5602b74f9d" + " " +"
        BR (&93834799011616)
        text " "
        SPAN (&93834799011920)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ""pvUazQKriCfuE5wUX74yj5lvnzygbaUgtP/gAY1aPs1NjXCiWseV4GquSKdMozNoYsfIf0LbdpLwKdUSFYz2dySspGLTUBpmalYz/6G/B5M19y6Ce+TyoLJehTB0TzzAD9pwzVSJFsUiYCUG1KU6SohSjAIxHrebyo7+MYuQAd4uPnZ3ZiDukWglDr/7fTUafAEiF5gS0T+LRcaKimfSmPQjtjomgjn6jfl5u9gSyrAwOTCuVkZpSY6yjI1LjEy2jKRpMov4DiYTCMMbY8fLG1PmBp4SDvoLd7p+2ay9cyx1qYU43/zbxQGfK3nzBtFKMggS+73rHJpCL+0FPYoqTRkSAN17vxRUHCBESUfd9aAar3ZrhMrQwSj/QKnyG6Gg43WHYMjT6znsHxA=""
        text " "
      text " "
      DIV (&93834799012640)
        attr id "A_17903"
        text " "
        P (&93834799013120)
          B (&93834799013304)
            text "A_17903 - Kontext SGD, Prüfung der ephemeren ECC-Schlüssel des Senders beim ECIES-Verfahren"
        text " "
        P (&93834799013728)
          text "Ein SGD ePA und ein Client eines SGD-ePA MÜSSEN sicherstellen, dass sie die beim Empfang einer über das ECIES-Verfahren verschlüsselten Nachricht den vom Sender erzeugten ephemeren ECC-Punkt überprüfen:"
          BR (&93834799014032)
          text " "
        OL (&93834799014336)
          text " "
          LI (&93834803121800)
            text "Dieser ECC-Punkt MUSS auf der gleichen elliptischen Kurve wie der Empfänger-ECC-Punkt liegen."
          text " "
        text "(Hinweis: der Punkt im Unendlichen ist ebenfalls ein ungültiger Punkt. Dieser Punkt kann aufgrund des Kodierungsformats aus"
        SPAN (&93834803122344)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17902"
          attr data-item-id "ML-94703"
          attr data-option-id "custom"
          attr data-type "crossReference"
          attr id "fake"
        text " hier nicht auftreten.)"
        BR (&93834803123680)
        text " "
        B (&93834803123984)
          text "[<=]"
        P (&93834803124288)
        text " "
      text " "
      P (&93834803124712)
        attr id "polarion_264"
        text "Verständnishinweis zu "
        SPAN (&93834803125192)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17903"
          attr data-item-id "ML-94702"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " : Da dies ein häufig auftretender sicherheitskritischer Implementierungsfehler ist, wird auf diesen Punkt explizit hingewiesen und damit eine gesonderte Stellungnahme diesbezüglich im Produktsicherheitsgutachten gefordert."
      text " "
      H2 (&93834803126848)
        attr id "6"
        text "6 Schnittstellen und Operationen"
      text " "
      P (&93834803127448)
        attr id "polarion_103"
        text "Der SGD ePA bietet innerhalb der TI eine HTTPS-Schnittstelle als Kommunikationsschnittstelle an."
      text " "
      P (&93834803128048)
        attr id "polarion_104"
        text "Die gematik stellt auf Anfrage eine Beispiel-Implementierung für die Außenschnittstellen eines SGD bereit."
      text " "
      H3 (&93834803128648)
        attr id "6.1"
        text "6.1 Innenschnittstellen"
      text " "
      P (&93834803129248)
        attr id "polarion_148"
        text "Die Innenschnittstellen zwischen der Request verarbeitende Einheit (RVE) für die eingehenden HTTP-Request und dem SGD-HSM sind SGD-intern. Deren Ausgestaltung bleibt dem Betreiber überlassen."
      text " "
      H3 (&93834803129848)
        attr id "6.2"
        text "6.2 HTTPS-Schnittstellen und HTTP-Kommunikation"
      text " "
      DIV (&93834803130448)
        attr id "A_17889"
        text " "
        P (&93834803130928)
          B (&93834803131112)
            text "A_17889 - HTTPS-Schnittstelle SGD"
        text " "
        P (&93834803131536)
          text "Ein SGD ePA MUSS Folgendes sicherstellen:"
          SPAN (&93834803131840)
            attr style "font-size: 10pt;line-height: 1.5;"
            BR (&93834803132200)
          text " "
        OL (&93834803132504)
          text " "
          LI (&93834803132808)
            text "Der SGD MUSS über eine HTTPS-Außenschnittstelle in der TI verfügbar sein"
            SPAN (&93834803133112)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "."
          text " "
          LI (&93834803133712)
            text "Für diese HTTPS-Schnittstelle MUSS der SGD ein TLS-Fachdienst Zertifikat (inkl. privatem Schlüssel) mit dem Profil C.FD.TLS-S (vgl. [gemSpec_PKI#C.FD.TLS-S Server-Authentisierung] und OID "oid_sgd" [gemSpec_OID]) aus der Komponenten-PKI der TI besitzen und verwenden."
            BR (&93834803134016)
          text " "
          LI (&93834803134320)
            text "Der SGD MUSS bei der HTTPS-Schnittstelle HTTP Version 1.1 unterstützen."
          text " "
          LI (&93834803134744)
            text "Über diese HTTPS-Schnittstelle MUSS der SGD HTTP-POST-Request mit dem Content-Type 'application/json' entgegennehmen."
          text " "
          LI (&93834803135168)
            text "Antworten MUSS der SGD auf einen solchen HTTP-POST-Request immer mit einen HTTP-Response mit dem Content-Type 'application/json'."
          text " "
        text " "
        B (&93834803135712)
          text "[<=]"
        P (&93834803136016)
        text " "
      text " "
      P (&93834803136440)
        attr id "polarion_188"
        text "Genaue Vorgaben für die Verwendung des TLS-Protokolls bei der HTTPS-Schnittstelle befinden sich in [gemSpec_Krypt] und die entsprechenden Anforderungen sind den Produkttypen (Produkttypsteckbrief) zugewiesen."
      text " "
      DIV (&93834803137040)
        attr id "A_17890"
        text " "
        P (&93834803137520)
          B (&93834803137704)
            text "A_17890 - HTTPS-Schnittstelle SGD, KANN HTTP/2"
        text " "
        P (&93834803138128)
          text " "
          META (&93834803138432)
            attr content "text/html; charset=UTF-8"
            attr http-equiv "Content-Type"
          text " "
          META (&93834803139088)
            attr content "HTML Tidy for Java (vers. 26 Sep 2004), see www.w3.org"
            attr name "generator"
          TITLE (&93834803139624)
        P (&93834803139816)
          SPAN (&93834803140000)
            text "Ein SGD ePA KANN auf dessen HTTPS-Schnittstelle nach "
          SPAN (&93834803140304)
          SPAN (&93834803140488)
            SPAN (&93834803140672)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17889"
              attr data-item-id "ML-94687"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr linkid "189"
          SPAN (&93834803141912)
          SPAN (&93834803142096)
            attr style "text-decoration: underline;"
          SPAN (&93834803142456)
            attr style "text-decoration: underline;"
          SPAN (&93834803142816)
            text " zusätzlich HTTP "
          SPAN (&93834803143120)
            text "Version 2 (HTTP/2) anbieten."
        text " "
        B (&93834803143544)
          text "[<=]"
        P (&93834803143848)
        text " "
      text " "
      P (&93834803144272)
        attr id "polarion_329"
        text "Es kann nicht ausgeschlossen werden, dass aufgrund von Fehlkonfiguration oder Fehlfunktion eines Clients aus der TI sehr viele TCP-Verbindungen in kurzer Zeit zum SGD aufgebaut werden. Dann muss es dem Betreiber möglich sein, diesen Sender temporär durch Verwerfen der IP-Pakete des Senders am Verbindungsaufbau zu hindern."
      text " "
      DIV (&93834803144872)
        attr id "A_22495"
        text " "
        P (&93834803145352)
          B (&93834803145536)
            text "A_22495 - SGD, Firewall, DoS-Schutz"
        text " "
        P (&93834803145960)
          text "Der Anbieter eines SGD ePA MUSS sicherstellen, dass die Netzwerk-Außenschnittstellen des SGD es erlauben eingehenden Datenverkehr von bestimmten während des Betriebs des SGD konfigurierbaren IP-Adressen zu verwerfen."
          SPAN (&93834803146264)
            attr style "background-color: #FFFF99;"
          text " "
          B (&93834803146744)
            text "[<=]"
        text " "
      text " "
      P (&93834803147288)
        attr id "polarion_330"
        text "Das ZGdV (vgl."
        SPAN (&93834803147768)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Zugangsgateway_Vers#Proxy Schlüsselgenerierungsdienst]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Zugangsgateway_Vers?selection=ML-93876"
          attr id "fake"
        text ") ist im Vergleich zu einem SGD in einer besseren Position, Gegenmaßnahmen gegen DoS-Angriffe aus dem Internet zu ergreifen. Ein SGD kennt nicht die IP-Adresse des Clients – alle Requests kommen von einer IP-Adresse des ZGdV. Deswegen kann ein SGD nur schlecht auf IP-Ebene DoS-Gegenmaßnahmen gegen Clients aus dem Internet ergreifen. Ein SGD kann jedoch die kryptographische Identität des Anfragenden mit hoher Sicherheit schon in der RVE feststellen und bei DoS-Angriffen auf dieser Grundlage Client-spezifische DoS-Gegenmaßnahmen ergreifen."
      text " "
      DIV (&93834803149248)
        attr id "A_17891"
        text " "
        P (&93834803149728)
          B (&93834803149912)
            text "A_17891 - HTTPS-Schnittstelle SGD, DoS-Schutz"
        text " "
        P (&93834803150336)
          text "Ein SGD ePA MUSS bei seiner HTTPS-Schnittstelle in der Request verarbeitenden Einheit (RVE) Maßnahmen gegen DoS-Angriffe auf Applikation-Ebene umsetzen (vgl. [gemSpec_SGD_ePA#Hinweise zu A_17891])."
          B (&93834803150640)
            text "[<=]"
        text " "
      text " "
      P (&93834803151184)
        attr id "polarion_86"
        text "Hinweise zu A_17891:"
      text " "
      P (&93834803151784)
        attr id "polarion_190"
        text "In Bezug auf DoS-Gegenmaßnahmen auf Applikation-Ebene stehen die Operationen GetAuthenticationToken (A_18025-*) und "
        SPAN (&93834803152264)
          attr class "polarion-rte-link"
          attr data-custom-label "KeyDerivation"
          attr data-item-id "ML-94567"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "("
        SPAN (&93834803153800)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17898"
          attr data-item-id "ML-94696"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) im Fokus, also die Operationen, die unmittelbaren Zugriff auf die SGD-HSM verlangen."
      text " "
      P (&93834781741824)
        attr id "polarion_28"
        text "Bei der Operation "
        SPAN (&93834781742304)
          attr class "polarion-rte-link"
          attr data-custom-label "GetPublicKey"
          attr data-item-id "ML-94563"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " (A_17895-*) wird nur eine Datenstruktur nach"
        SPAN (&93834781743840)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17894-01"
          attr data-item-id "ML-109378"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  (aktueller ECIES-Schlüssel des avisierten SGD-HSM) quasi semistatisch zurückgeliefert. Eine RVE muss die ECIES-Schlüssel alle 15 Minuten vom jeweiligen SGD-HSM erfragen und in eine  Datenstruktur nach"
        SPAN (&93834781745376)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17894-01"
          attr data-item-id "ML-109378"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  überführen. Diese Datenstruktur liefert die RVE dann statisch 15 Minuten lang aus. Damit steht dort der DoS-Schutz auf Anwendungsebene nicht im Fokus."
      text " "
      P (&93834781747032)
        attr id "polarion_183"
        text "Bei den Operationen GetAuthenticationToken (A_18025-*) und "
        SPAN (&93834781747512)
          attr class "polarion-rte-link"
          attr data-custom-label "KeyDerivation"
          attr data-item-id "ML-94567"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ("
        SPAN (&93834781749048)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17898"
          attr data-item-id "ML-94696"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) muss die RVE die Signatur und das Zertifikat des Clients prüfen (vgl. bspw."
        SPAN (&93834781750584)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17898"
          attr data-item-id "ML-94696"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ) und bei nicht-positivem Prüfergebnis verwerfen ("
        SPAN (&93834781752120)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17908-01"
          attr data-item-id "ML-109359"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ). Wenn ein Client zu oft Anfragen stellt, so kann die RVE dessen Anfragen herunter priorisieren"
        SPAN (&93834781753656)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "oder den Client mit einem Fehler (vgl. [gemSpec_SGD_ePA#Tabelle Tab_Fehlerfälle_und_Fehlermeldungen]) abweisen. Je nach Art des DoS-Angriffs kann es auch notwendig sein, selektiv gleich auf TCP-Ebene Verbindungsaufbauten abzulehnen."
        text " "
      text " "
      P (&93834781754376)
        attr id "polarion_257"
        text "Ein Herunterpriorisieren oder Ablehnen von Client-Requests auf Applikationsebene kann man effizient bspw. mittels "counting bloom filter" implementieren. Dafür erzeugt der SGD ein ausreichend großes 64-bit-Zählerfeld. Bspw. die letzten 256 Bits der Signatur des AUT-Zertifikats werden beim Eintreffen der schon geprüften Requests über eine (nicht-notwendigerweise kryptographisch sichere, d. h. sehr performante) Hashfunktion auf einen Index des Feldes überführt. Dort wird der Zähler mit dem entsprechenden Index im Feld erhöht. Falls dieser Zählerwert über einem festgelegten Limit ist, wird der Request abgelehnt. Periodisch werden alle Zähler des Zählerfeldes, die größer als Null sind, verringert."
      text " "
      P (&93834781754976)
        attr id "polarion_195"
        text "Bei der Requestverarbeitung (vgl. Abschnitt"
        SPAN (&93834781755456)
          attr class "polarion-rte-link"
          attr data-item-id "ML-93580"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") meldet das SGD-HSM der RVE verschiedene Fehlerfälle. Treten bei Requests mit bestimmten "Certificate"-Inhalten besonders häufig Fehler auf, so kann die RVE solche Requests für eine gewisse Zeit sperren oder ein Rate-Limiting für solche Requests durchsetzen."
      text " "
      P (&93834781756936)
        attr id "polarion_196"
        text "Bei bestimmten Arten von DoS-Angriffen kann nur das ZGdV effektiv Gegenmaßnahmen ergreifen (vgl. Kommentar vor"
        SPAN (&93834781757416)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17891"
          attr data-item-id "ML-94689"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). "
      text " "
      DIV (&93834781759072)
        attr id "A_22505"
        text " "
        P (&93834781759552)
          B (&93834781759736)
            text "A_22505 - SGD, HTTPS-Schnittstelle, DoS-Schutz, Unterscheidung der Identitätsklassen"
        text " "
        P (&93834781760160)
          text "Ein SGD ePA MUS bei der Umsetzung von A_17891-* zwischen drei Nutzergruppen unterscheiden:"
          BR (&93834781760464)
          text " "
        OL (&93834781760768)
          text " "
          LI (&93834781761072)
            text "Versicherte (AUT-Zertifikat mit oid_egk_aut, oid_egk_aut_alt),"
          text " "
          LI (&93834781761496)
            text "LEI (AUT-Zertifikat mit policyIdentifier = oid_smc_b_aut und professionOID != oid_epa_ktr))"
          text " "
          LI (&93834781761920)
            text "KTR-Identitäten (KTR-Consumer) (AUT-Zertifikat mit mit policyIdentifier = oid_smc_b_aut und und professionOID = oid_epa_ktr)."
          text " "
        text "Bei den DoS-Schutzmaßnahmen MÜSSEN für jeder dieser Nutzergruppen unterschiedliche obere Schranken durchsetzbar sein, und durch einen Betreiber im Betrieb konfigurierbar sein."
        BR (&93834781762464)
        text "Der SGD ePA MUSS sicherstellen, dass in Bezug auf den DoS-Schutz das "Certificate"-Feld oder Teilinformationen aus diesem Feld für den DoS-Schutz nur genutzt werden, wenn die Signatur kryptographisch korrekt ist."
        SPAN (&93834781762768)
          attr style "background-color: #FFFF99;"
        text " "
        B (&93834781763248)
          text "[<=]"
        P (&93834781763552)
        text " "
      text " "
      P (&93834781763976)
        attr id "polarion_331"
        text "Implementierungshinweis:"
      text " "
      P (&93834781764576)
        attr id "polarion_332"
        text "Es ist davon auszugehen, das SMC-B-Zertifikat über den VZD semi-öffentlich verfügbar sind. Damit kann man mit dem "Certificate"-Feld alleine nicht sicher auf die Identität des anfragenden Client schließen. Da im öffentlichen Client-Schlüssel der Hashwert des aktuell vom Client verwendeten (S4)-Schlüssels enthalten ist und dieser sich alle 15 Minuten ändert, kann man mit hoher Sicherheit davon ausgehen, dass wenn die Signatur des Client-Schlüssel kryptographisch korrekt ist, der Request tatsächlich vom angegebenen Client (SMC-B-AUT-Zertifikat) kommt."
      text " "
      P (&93834781765176)
        attr id "polarion_333"
        text "Für diese Signaturprüfung ist nach A_22448-* ein Cache zu verwenden. Man kann bei Ankunft eines Requests für GetAuthenticationToken oder KeyDerivation nach einigen Sanity-Check (Signaturfeld leer? Certificate-Feld leer? etc.) den Hashwert von P"
        SPAN (&93834781765656)
          attr style "color: #202020;"
          text "ublicKeyECIES || Signature || Certificate berechnen und den Hashwert als Abfrageschlüssel für den Cache verwenden. Im Cache-Eintrag kann man dann ebenfalls den Zertifikatstyp aufführen. Damit kann man effizient entscheiden welche Nutzergruppe hier vorliegt (welche Datenstruktur jetzt zu befragen ist) und dann das Certificate-Feld oder Teile daraus im weiteren Verlauf in der entsprechenden Datenstruktur (Bloomfilter, Redis-In-Memory-Datenbank etc.) verwenden."
        text " "
      text " "
      P (&93834781766376)
        attr id "polarion_334"
        text "Hinweis zum Mengengerüst: im Normalfall existierte pro Kasse eine KTR-Identität (KTR-Consumer-Zertifikat), also sehr viel weniger (Faktor > 3000) als LEI-Identitäten (Kontext Dimensierung der damit verbundenere Datenstrukturen)."
      text " "
      DIV (&93834781766976)
        attr id "A_22496"
        text " "
        P (&93834781767456)
          B (&93834781767640)
            text "A_22496 - HTTPS-Schnittstelle SGD, DoS-Schutz, SGD-Userpseudonym"
        text " "
        P (&93834781768064)
          text "Ein SGD ePA MUSS bei seiner HTTPS-Schnittstelle in jedem HTTP-Response-Header die folgende HTTP-Variable mit folgendem Wert aufnehmen:"
          BR (&93834781768368)
          text "     "
          SPAN (&93834781768672)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "SGD-Userpseudonym: reserved for future use"
          SPAN (&93834781769152)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;background-color: #FFFF99;"
          text " "
          B (&93834781769632)
            text "[<=]"
        text " "
      text " "
      P (&93834781770176)
        attr id "polarion_335"
        text "Erläuterung: Über den Weg der regelmäßig wechselnden Nutzerpseudonyme im HTTP-Header wird es in einer zukünftigen Ausbaustufe des SGDs einem SGD ermöglicht den DoS-Schutz noch effizienter umzusetzen (analog zu gemSpec_Krypt#A_20162). Vgl. auch A_22494."
      text " "
      H3 (&93834781770776)
        attr id "6.3"
        text "6.3 Anforderungen an die JSON-Requests und -Responses"
      text " "
      DIV (&93834781771376)
        attr id "A_17892"
        text " "
        P (&93834781771856)
          B (&93834781772040)
            text "A_17892 - Aufwärtskompatibilität JSON-Requests und -Responses"
        text " "
        P (&93834781772464)
          text "Alle an einer Kommunikation mit einer SGD beteiligten Parteien (Client, ZGdV, SGD selbst) MÜSSEN sicherstellen, dass die JSON-Datenstrukturen, die bei der Kommunikation übermittelt werden, zusätzliche Key-Value-Paare enthalten können, d. h. ein Beteiligter MUSS ihm unbekannte Key-Value-Paare ignorieren."
          B (&93834781772768)
            text "[<=]"
        text " "
      text " "
      DIV (&93834781773312)
        attr id "A_17893"
        text " "
        P (&93834781773808)
          B (&93834781773992)
            text "A_17893 - Maximale Größe der JSON-Requests und -Responses"
        text " "
        P (&93834781774416)
          text "Ein SGD ePA und ein Client eines SGD ePA MÜSSEN JSON-Requests und -Responses auf den SGD (GetPublicKey, KeyDerivation) ablehnen, wenn diese größer als 2 MiB sind."
          B (&93834781774720)
            text "[<=]"
        text " "
      text " "
      P (&93834781775264)
        attr id "polarion_68"
        text "Hinweis zu A_17893:"
      text " "
      P (&93834781775864)
        attr id "polarion_93"
        text "Bei einer Sicherheitsüberprüfung muss u. a. die Validierung von Daten an der Außenschnittstelle betrachtet werden. Dabei unterstützt "
        SPAN (&93834781776344)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17893"
          attr data-item-id "ML-94690"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ."
      text " "
      H3 (&93834781778000)
        attr id "6.4"
        text "6.4 Operation GetPublicKey"
      text " "
      DIV (&93834781778600)
        attr id "A_17895-02"
        text " "
        P (&93834781779080)
          B (&93834781779264)
            text "A_17895-02 - SGD, Operation GetPublicKey"
        text " "
        P (&93834781779688)
          text "Ein SGD ePA MUSS Folgendes sicherstellen: Wenn über dessen HTTPS-SGD-Schnittstelle (vgl."
          SPAN (&93834781779992)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17889"
            attr data-item-id "ML-94687"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") ein POST-Request mit dem Request-Body nach [gemSpec_SGD_ePA#Tab_GetPublicKey-Request] eintrifft, so MUSS die RVE das Zertifikat im Datenfeld "Certificate" des Requests asynchron prüfen (Prüfung gegen die TSL inkl. Sperrinformationen über OCSP) (vgl. auch [gemSpec_SGD_ePA#Hinweis zu A_17895-*). Unabhängig vom Prüfergebnis MUSS der SGD eines seiner SGD-HSMs auswählen, an das er den zu erwartenden Folgerequest (im Normalfall GetAuthenticationToken) senden möchte. In Bezug auf dieses avisierte SGD-HSM MUSS der SGD den aktuellen signierten öffentlichen ECIES-Schlüssel des SGD-HSMs + Zertifikat nach der in"
          SPAN (&93834781781352)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17894-01"
            attr data-item-id "ML-109378"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text "  angegebenen Kodierung als Antwort senden."
          BR (&93834781782712)
          text " "
          B (&93834781783016)
            text "[<=]"
        text " "
      text " "
      P (&93834781783560)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_145"
        text "Tabelle "
        SPAN (&93834781784392)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "7"
        text ": Tab_GetPublicKey-Request"
      text " "
      TABLE (&93834781785288)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=3"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834781786120)
          text " "
          TR (&93834781786424)
            text " "
            TD (&93834781786728)
              attr style "text-align: left;vertical-align: top;width: 748px;height: 217px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834781787088)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "{ "Command"      : "GetPublicKey","
              BR (&93834781787568)
              text " "
              SPAN (&93834781787872)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "Certificate"  : "... Base64-kodiertes Client-Zertifikat ... ","
              BR (&93834781788352)
              text " "
              SPAN (&93834781788656)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "OCSPResponse" : "... Base64-kodierte OCSP-Response ...""
              BR (&93834781789136)
              text " "
              SPAN (&93834781789440)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "}"
              BR (&93834781789920)
              text " "
              BR (&93834781790224)
              text " "
              SPAN (&93834781790528)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "oder"
              BR (&93834781791008)
              text " "
              BR (&93834781791312)
              text " "
              SPAN (&93834781791616)
                attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                text "{"
              text " "
              SPAN (&93834781792216)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text ""Command"      : "GetPublicKey","
              BR (&93834781792696)
              text " "
              SPAN (&93834781793000)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "Certificate"  : " ... Base64-kodiertes Client-Zertifikat ... ","
              BR (&93834781793480)
              text " "
              SPAN (&93834781793784)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "OCSPResponse" : """
              BR (&93834781794264)
              text " "
              SPAN (&93834781794568)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "}"
              BR (&93834781795048)
              text " "
            text " "
          text " "
        text " "
      text " "
      P (&93834781795832)
        attr id "polarion_126"
      text " "
      P (&93834781796312)
        attr id "polarion_19"
        text "Hinweis zu A_17895-*:"
      text " "
      P (&93834781796912)
        attr id "polarion_25"
        text "In A_17895-*  steht die Zertifikatsprüfung des im Request enthaltenen Zertifikats nicht in Bezug zu einer Signaturprüfung einer Challenge oder eines durch den Client zu authentisierenden Datums. Damit findet hier keine Authentifizierung statt. Das Aufführen des Zertifikats hat die zwei folgenden Ziele:"
      text " "
      OL (&93834781797512)
        attr id "polarion_41"
        text " "
        LI (&93834781797992)
          text "Es wird damit einem SGD ermöglicht, gutartige (nicht-manipulierte) Requests auf mehrere SGD-HSM bspw. in verschiedenen geographischen Orten (Verfügbarkeitsanforderung) zu verteilen. Denn die in den verschiedenen SGD-HSMs erzeugten ECIES-Schlüsselpaare müssen damit nicht synchronisiert werden."
          BR (&93834781798296)
          text "Sollte ein Angreifer ein falsches AUT-Zertifikat schicken, so entsteht dadurch kein Sicherheitsproblem."
        text " "
        LI (&93834781798720)
          text "Es wird außerdem einem SGD ermöglicht, vorab eine Zertifikatsprüfung (Einholen der OCSP-Antworten) durchzuführen (diese OCSP-Antworten werden von dem SGD-HSM benötigt). Diese Zertifikatsprüfung muss die RVE asynchron durchführen, d. h. der SGD darf den Client in Bezug auf die Antwort (der aktuelle signierte ECIES-Schlüssel des für den Client "vorgesehenen" SGD-HSMs) nicht warten lassen."
        text " "
      text " "
      P (&93834781799264)
        attr id "polarion_336"
        text "Für weitere Vorgaben und Hinweise in Bezug auf die Zuweisung eines Clients auf ein SGD-HSM aus der Menge der im SGD verfügbaren SGD-HSM durch die RVE vergleiche Abschnitt ""
        SPAN (&93834781799744)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94519"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ". "
      text " "
      DIV (&93834781801224)
        attr id "A_17896"
        text " "
        P (&93834781801704)
          B (&93834781801888)
            text "A_17896 - SGD: Vorhalten (caching) von Zertifikatsprüfungen in der RVE"
        text " "
        P (&93834781802312)
          text "Eine SGD ePA MUSS das Ergebnis einer Zertifikatsprüfung (inkl. OCSP-Response) innerhalb der RVE 4 Stunden vorhalten (cachen) und, falls ein vorgehaltenes Prüfergebnis vorliegt, dieses anstatt einer neuen Zertifikatsprüfung verwenden. Prüfergebnisse, die älter als 4 Stunden sind, MÜSSEN verworfen und gelöscht werden. Falls der Client eine OCSP-Response mit übergeben hat, so MUSS der SGD zunächst diese nutzen. Wenn die OCSP-Response ungültig oder älter als 4 Stunden ist, so MUSS der SGD selbst eine OCSP-Response einholen."
          B (&93834781802616)
            text "[<=]"
        text " "
      text " "
      P (&93834781803160)
        attr id "polarion_337"
        text "Das in A_17896-* definierte Caching von Sperrinformationen ist die lokale Quelle für die OCSP-Informationen, die die RVE an die SGD-HSM sendet (beim Aufruf von GetAuthenticationToken und KeyDerivation). "
      text " "
      P (&93834781803760)
        attr id "polarion_98"
        text "Wie in Abschnitt"
        SPAN (&93834781804240)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94496"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " beschrieben, benötigt ein SGD in Bezug auf die Schlüsselableitungsfunktionalität das AUT-Zertifikat des Nutzers und eine OCSP-Response für dieses Zertifikat. Dies bildet die Grundlage des beidseitig authentisierten verschlüsselten Datenkanals zwischen SGD-HSM und Client (vgl. Abschnitt"
        SPAN (&93834781805600)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94770"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). Ein SGD darf diese beiden Daten nicht längerfristig speichern ("
        SPAN (&93834781806968)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17965"
          attr data-item-id "ML-94843"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "). Andere personenbezogenen Daten fallen bei einem SGD nicht an. Da ein Versicherter immer über das ZGdV eine Datenverbindung zu den beiden SGD aufbaut, erfahren beide SGD nicht die vom Versicherten verwendete IP-Adresse."
      text " "
      DIV (&93834781808624)
        attr id "A_17965"
        text " "
        P (&93834781809104)
          B (&93834781809288)
            text "A_17965 - SGD: Löschen der Client-AUT-Zertifikate und OCSP-Responses"
        text " "
        P (&93834781809712)
          text "Ein SGD ePA DARF NICHT Client-spezifische Daten (also das Client-AUT-Zertifikat oder OCSP-Responses dafür) persistent (also außerhalb des Zeitraums aus"
          SPAN (&93834781810016)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17896"
            attr data-item-id "ML-94695"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") speichern."
          B (&93834781811376)
            text "[<=]"
        text " "
      text " "
      DIV (&93834781811920)
        attr id "A_17897"
        text " "
        P (&93834781812400)
          B (&93834781812584)
            text "A_17897 - SGD-Client, Anfrage GetPublicKey (Client)"
        text " "
        P (&93834781813008)
          text "Ein Client eines SGD ePA MUSS den aktuellen signierten öffentlichen ECIES-Schlüssel eines SGD-HSMs über die Operation GetPublicKey gemäß A_17895-*  erfragen."
          B (&93834781813312)
            text "[<=]"
        text " "
      text " "
      DIV (&93834781813856)
        attr id "A_18024"
        text " "
        P (&93834781814336)
          B (&93834781814520)
            text "A_18024 - SGD-Client, Prüfung SGD-HSM-ECIES-Schlüssel"
        text " "
        P (&93834781814944)
          text "Ein Client eines SGD ePA MUSS den über die Operation GetPublicKey (A_17895-*) erhaltenen signierten öffentlichen ECIES-Schlüssel eines SGD-HSMs (vgl.A_17894-01) wie folgt prüfen."
          BR (&93834781815248)
          text " "
        OL (&93834781815552)
          text " "
          LI (&93834781815856)
            text "Ist das erhaltene Zertifikat des SGD-HSMs (vgl. A_17894-01)  gemäß "
            SPAN (&93834781816160)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17847"
              attr data-item-id "ML-94621"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text " gültig? Falls nein, dann FAIL."
          text " "
          LI (&93834781817640)
            text "Ist das Zertifikat so wie vom Client erwartet entweder von einem SGD 1 oder von einem SGD 2 gemäß"
            SPAN (&93834781817944)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17848"
              attr data-item-id "ML-94622"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text "? Falls nein, dann FAIL."
          text " "
          LI (&93834781819424)
            text "Ist das erhaltene Zertifikat zeitlich gültig? Falls nein, dann FAIL."
          text " "
          LI (&93834781819848)
            text "Ist die Signatur (vgl. "Signature"-Feld bei Kodierung gemäß A_17894-01) korrekt ("valid"), also eine kryptographisch korrekte Signatur (ECDSA-Signatur gemäß [gemSpec_Krypt#"
            SPAN (&93834781820152)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17873"
              attr data-type "polarion"
              attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94670"
              attr id "fake"
            text "]), die auf den EE-Schlüssel aus dem in (1) bis (3) geprüften Zertifikat rückführbar ist? Falls nein, dann FAIL."
          text " "
        text "Wenn einer der Prüfschritte ein FAIL liefert, so MUSS der Client die Verwendung des erhalten Schlüssel (A_17895-*) abbrechen."
        B (&93834781821576)
          text "[<=]"
        P (&93834781821880)
        text " "
      text " "
      H3 (&93834781822304)
        attr id "6.5"
        text "6.5 Operation GetAuthenticationToken"
      text " "
      DIV (&93834781822904)
        attr id "A_18025-01"
        text " "
        P (&93834781823384)
          B (&93834781823568)
            text "A_18025-01 - SGD-Client, Anfrage GetAuthenticationToken"
        text " "
        P (&93834781823992)
          text "Ein Client eines SGD-ePA MUSS, nachdem er den  jeweiligen aktuellen öffentlichen SGD-HSM-Schlüssel ("
          SPAN (&93834781824296)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17910-01"
            attr data-item-id "ML-109449"
            attr data-option-id "custom"
            attr data-type "workItem"
            attr id "fake"
          text " (S4)) für die Nachrichtenübermittelung mittels des ECIES-Verfahrens (vgl. Abschnitt "
          SPAN (&93834781825656)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94770"
            attr data-option-id "shortoutline"
            attr data-type "crossReference"
            attr id "fake"
          text " ) erfragt ("
          SPAN (&93834781826840)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17897"
            attr data-item-id "ML-94694"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") und geprüft ("
          SPAN (&93834781828200)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18024"
            attr data-item-id "ML-96280"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") hat, ein Authentisierungstoken über die Operation GetAuthenticationToken ("
          SPAN (&93834781829560)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18025"
            attr data-item-id "ML-96275"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") anfordern."
          BR (&93834781830920)
          text " "
          BR (&93834781831224)
          text "Dafür MUSS der Client eine 256-Bit-Zufallszahl als Challenge erzeugen (RND-Client) und in Hexadezimalform kodieren."
          BR (&93834781831528)
          text "Weiterhin MUSS der Client den SHA-256-Wert aus der Aneinanderreihung seines Client-spezifischen ECIES-Schlüssels in der Kodierung nach A_17900 und des für dessen Signatur verwendeten AUT-Zertifikats (DER-kodiert) berechnen. Dieser Hashwert wird hexadezimal kodiert und wird so kodiert als Wert H bezeichnet."
          BR (&93834781831832)
          text "Anschließend MUSS der Client die Zeichenkette "Challenge <RND-Client> <Wert-H>" erzeugen."
          BR (&93834781832136)
          text " "
          BR (&93834781832440)
          text "Beispiel:"
          SPAN (&93834781832744)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "  Challenge "
            SPAN (&93834781833224)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "f97cbc538b020d705a960a7e8fa5912c8e202fcf7d6516da3818eff68ce7e00d c4d0613a597826cfdca992d0a02d0ea26667829345033dee158a578cc8524cab"
              SPAN (&93834781833704)
                attr style "font-size: 11pt;font-family: Arial, Helvetica;line-height: 1.5;"
                BR (&93834781834064)
                text " "
          BR (&93834781834368)
          text "Die Zeichenkette hat damit eine Länge von 9 + 2 + 2*64 = 139 Zeichen. Diese Zeichenkette MUSS der Client über das ECIES-Verfahren gemäß [gemSpec_Krypt#"
          SPAN (&93834781834672)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17875"
            attr data-type "polarion"
            attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
            attr id "fake"
          text "] für das SGD-HSM verschlüsseln. Das erhaltene Chiffrat MUSS der Client gemäß "
          SPAN (&93834781835856)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17902"
            attr data-item-id "ML-94703"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " kodieren und die Kodierung als "EncryptedMessage" bei Operation GetAuthenticationToken (A_18021) verwenden."
          B (&93834781837216)
            text "[<=]"
        text " "
      text " "
      DIV (&93834781837760)
        attr id "A_18021"
        text " "
        P (&93834781838240)
          B (&93834781838424)
            text "A_18021 - SGD, GetAuthenticationToken"
        text " "
        P (&93834781838848)
          text "Ein SGD ePA MUSS Folgendes sicherstellen: Wenn über dessen HTTPS-SGD-Schnittstelle (vgl."
          SPAN (&93834764410520)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17889"
            attr data-item-id "ML-94687"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text ") ein POST-Request mit dem Request-Body nach [gemSpec_SGD_ePA#Tab_GetAuthenticationTolken-Request] eintrifft, so MUSS die RVE des SGD"
          SPAN (&93834764411856)
            attr style "font-family: Arial, Helvetica;"
            BR (&93834764412216)
            text " "
          text " "
        OL (&93834764412640)
          text " "
          LI (&93834764412944)
            SPAN (&93834764413128)
              attr style "font-family: Arial, Helvetica;"
              text "das Zertifikat im Datenfeld "Certificate" gemäß TUC_PKI_018"
            text "(OCSP-Graceperiod=4h, PolicyList={oid_egk_aut, oid_egk_aut_alt, oid_smc_b_aut})"
            SPAN (&93834764413728)
              attr style "font-family: Arial, Helvetica;"
              SPAN (&93834764414088)
                attr style "font-size: 11pt;line-height: 1.5;"
                text " "
              text "prüfen und dabei Ergebnisse nach  "
              SPAN (&93834764414688)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17896"
                attr data-item-id "ML-94695"
                attr data-option-id "custom"
                attr data-type "crossReference"
                attr id "fake"
              text " berücksichtigen."
          text " "
          LI (&93834764416168)
            text "die Kodierung und die Signatur der "PublicKeyECIES" prüfen (vgl. "
            SPAN (&93834764416472)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17900"
              attr data-item-id "ML-94700"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text " und "
            SPAN (&93834764417832)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17901"
              attr data-item-id "ML-94701"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text "). "
          text " "
        text "Falls eine der Prüfungen ein nicht-positives Ergebnis liefert, so MUSS die RVE des SGD mit einer entsprechenden Fehlermeldung aus [gemSpec_SGD_ePA#"
        SPAN (&93834764419432)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94577"
          attr data-option-id "longoutline"
          attr data-type "crossReference"
          attr id "fake"
        text "] dem Client antworten und die weitere Requestverarbeitung abbrechen."
        BR (&93834764420616)
        text "Die RVE des SGD MUSS die Informationen aufbereiten und an das für den Request avisierte SGD-HSM übergeben (vgl. A_18026-*)."
        BR (&93834764420920)
        text "Liefert das SGD-HSM ein OK, so MUSS die SGD die Antwort den HTTP-POST-Request mit folgender Nachricht beantworten:"
        BR (&93834764421224)
        text " "
        SPAN (&93834764421528)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "{"
          BR (&93834764422008)
          text "  "Status" : "OK","
          BR (&93834764422312)
          text "  "EncryptedMessage" : "... Base64-kodiertes Chiffrat gemäß"
          SPAN (&93834764422616)
            attr style "font-size: 10pt;line-height: 1.5;"
            SPAN (&93834764422976)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17902"
              attr data-item-id "ML-94703"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text "...""
          BR (&93834764424336)
          text "}"
          BR (&93834764424640)
          text " "
        text " "
        SPAN (&93834764425064)
          attr style "font-family: Arial, Helvetica;"
          text "Anderenfalls (SGD-HSM meldet einen Fehler) MUSS die RVE des SGD mit einer entsprechenden Fehlermeldung aus [gemSpec_SGD_ePA#"
          SPAN (&93834764425544)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94577"
            attr data-option-id "longoutline"
            attr data-type "crossReference"
            attr id "fake"
          text "]  dem Client antworten."
        text " "
        B (&93834764426848)
          text "[<=]"
        P (&93834764427152)
        text " "
      text " "
      P (&93834764427576)
        attr id "polarion_290"
      text " "
      P (&93834764428056)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_150"
        text "Tabelle "
        SPAN (&93834764428888)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "8"
        text ": Tab_GetAuthenticationToken-Request"
      text " "
      TABLE (&93834764429784)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=4"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834764430616)
          text " "
          TR (&93834764430920)
            text " "
            TD (&93834764431224)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 121.556px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834764431584)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "{"
              SPAN (&93834764432064)
                attr style "font-size: 10pt;line-height: 1.5;"
                SPAN (&93834764432424)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text ""Command"          : "GetAuthenticationToken","
                BR (&93834764432904)
                text " "
                SPAN (&93834764433208)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "  "PublicKeyECIES"   : " ... Kodierung nach "
                SPAN (&93834764433688)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17900"
                  attr data-item-id "ML-94700"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                SPAN (&93834764435104)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "  ...","
                BR (&93834764435584)
                text " "
                SPAN (&93834764435888)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "  "Signature"        : " ... Base64-kodierte Signatur des PublicKeyECIES nach"
                text " "
                SPAN (&93834764436488)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17900"
                  attr data-item-id "ML-94700"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                SPAN (&93834764437904)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text " ...","
                BR (&93834764438384)
                text " "
                SPAN (&93834764438688)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "  "Certificate"      : " ... Base64-kodiertes Client-Zertifikat ... ","
                BR (&93834764439168)
                text " "
                SPAN (&93834764439472)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "  "EncryptedMessage" : " ... Base64-kodiertes Chiffrat nach"
                text " "
                SPAN (&93834764440072)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17902"
                  attr data-item-id "ML-94703"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                SPAN (&93834764441488)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "  ...""
                BR (&93834764441968)
                text " "
                SPAN (&93834764442272)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "}"
                BR (&93834764442752)
                text " "
            text " "
          text " "
        text " "
      text " "
      P (&93834764443544)
        attr id "polarion_108"
      text " "
      DIV (&93834764444024)
        attr id "A_22488"
        text " "
        P (&93834764444504)
          B (&93834764444688)
            text "A_22488 - SGD, RVE, Caching der Signaturprüfung der Client-PublicKeyECIES-Schlüssel"
        text " "
        P (&93834764445112)
          text "Ein SGD ePA (spezifischer: die RVE) muss nach A_18021-* und A_17898-* die Signatur des kurzlebigen Client-Schlüssels "PublicKeyECIES" bei den Operation GetAuthenticationToken und KeyDerivation prüfen. Ein SGD ePA MUSS das Ergebnis der Signaturprüfung cachen. Die "PublicKeyECIES" (vgl. A_17900-*) sind kryptographisch an die kurzlebigen ECIES-Schlüssel (S4) (vgl. Abschnitt"
          SPAN (&93834764445416)
            attr style "font-size: 10pt;line-height: 1.5;"
            text "4.3 Schlüssel im SGD-HSM") gebunden. Das Caching MUSS so lange andauern bis die (S4)-Schlüssel ungültig werden.  Das Caching MUSS Maßnahmen gegen DoS-Angriffe umsetzen (Größenlimitierung des Caches, notfalls Einträge nicht in den Cache aufnehmen). Der Zugriff auf die Caching-Ergebnisse MUSS schneller sein als die Signaturprüfung, die es zu cachen gilt. Es sind die Implementierungshinweise nach A_22488-* zu beachten."
          text " "
          B (&93834764446016)
            text "[<=]"
        text " "
      text " "
      P (&93834764446560)
        attr id "polarion_338"
        text "Implementierungshinweise:"
      text " "
      P (&93834764447160)
        attr id "polarion_339"
        text "In jedem SGD-HSM eines SGD wird alle 15 Minuten ein neues (S4)-Schlüsselpaar erzeugt. Das zuvor erzeugte (S4)-Schlüsselpaar ist noch 15 Minuten gültig. Damit gibt es pro SGD-HSM im Normalbetrieb (d. h. nachdem der SGD schon mindestens 30 Minuten am Stück arbeitet) genau zwei gültige (S4)-Schlüsselpaare. Da die "PublicKeyECIES"-Schlüssel jeweils an einen öffentlichen (S4)-Schlüssel pro SGD kryptographisch gebunden sind (vgl. A_17900-*) -- und damit auch dessen Signaturprüfung, kann der Cache als"
        SPAN (&93834764447640)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Associative Array"
        text "pro (S4)-Schlüsselpaar in der RVE implementiert werden. Verliert ein alter öffentlicher (S4)-Schlüssel nach 30 Minuten seine Gültigkeit, so kann das mit diesen öffentlichen (S4)-Schlüssel verbundene"
        SPAN (&93834764448240)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Associative Array "
        text "komplett verworfen/gelöscht werden. "
      text " "
      P (&93834764448960)
        attr id "polarion_340"
        text "Sollte es der Implementierung dienen, so ist es zulässig, dass der Cache-Mechanismus nach A_22488 pro RZ-Flanke implementiert wird und nicht zwischen den RZ-Flanken synchronisiert wird."
      text " "
      P (&93834764449560)
        attr id "polarion_341"
        text "In der PoC-Implementierung hat das Caching der Signaturprüfung eine Geschwindigkeitssteigerung der Signaturprüfung für A_18021-* und A_17898-* um dem Faktor 1.9 bis 17.1 je nach Verteilung der simulierten Anfragen ergeben. D.h., bei 0% Mehrfachableitungen in der Simulation der Anfragen, war fast eine Verdoppelung der Geschwindigkeit der Signaturprüfung erreicht. Diese Steigerung hatte bei 90% Mehrfachableitungen (bspw. kurzzeitige Last bei Quartalsende KTR-Consumer) den Faktor 17.1."
      text " "
      DIV (&93834764450160)
        attr id "A_18028"
        text " "
        P (&93834764450640)
          B (&93834764450824)
            text "A_18028 - SGD-Client, Auswertung der Anfrage GetAuthenticationToken"
        text " "
        P (&93834764451248)
          text "Ein Client eines SGD-ePA MUSS, nachdem er über die Operation GetAuthenticationToken (A_18025-*) ein Authentisierungstoken angefordert hat, die Antwort in "EncryptedMessage" mittels des ECIES-Verfahrens gemäß [gemSpec_Krypt#"
          SPAN (&93834764451552)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17875"
            attr data-type "polarion"
            attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
            attr id "fake"
          text " ] entschlüsseln."
          BR (&93834764452736)
          text "Der Client MUSS prüfen, ob die Antwort folgender Form entspricht:"
          BR (&93834764453040)
          text " "
          SPAN (&93834764453344)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "    Response <vom-Client-hexadezimal-kodierter-256-Bit-Zufallswert> <256-Bit-Wert-H-in-Hexform> AT<256-Bit-Hexadezimal-kodiert>"
          BR (&93834764453824)
          text "Beispiel:"
          BR (&93834764454128)
          text " "
          SPAN (&93834764454432)
            attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
            text "    Response f97cbc538b020d705a960a7e8fa5912c8e202fcf7d6516da3818eff68ce7e00d c4d0613a597826cfdca992d0a02d0ea26667829345033dee158a578cc8524cab AT1ce627dd5e4c6536ca0dd93f896744d42c6580537953a49fcc5840dd8f8f4efa"
          BR (&93834764454912)
          text " "
          BR (&93834764455216)
          text "Der Client MUSS prüfen, ob der erste Wert (256-Bit Zufallswert aus der Clientanfrage) genau der Wert aus der Anfrage des Client gemäß A_18025-* ist. Falls nein, so MUSS der Client mit einem Fehler abbrechen und ggf. mit dem Protokollablauf neu starten. "
          BR (&93834764455520)
          text " "
          BR (&93834764455824)
          text "Der Client MUSS prüfen, ob der zweite Wert H der SHA-256-Wert aus der Aneinanderreihung seines Client-spezifischen ECIES-Schlüssels in der Kodierung nach "
          SPAN (&93834764456128)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17900"
            attr data-item-id "ML-94700"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " und des für dessen Signatur verwendeten AUT-Zertifikats (DER-kodiert) ist."
          BR (&93834764457488)
          text "Falls nein, so MUSS der Client mit einem Fehler abbrechen und ggf. mit dem Protokollablauf neu starten. "
          BR (&93834764457792)
          text " "
          BR (&93834764458096)
          text "Der Client MUSS den zweiten Wert (das Authentisierungstoken) wie folgt prüfen:"
        OL (&93834764458400)
          text " "
          LI (&93834764458704)
            text "Beginnt das Authentisierungstoken mit der Zeichenkette "AT"? Falls nein, dann FAIL."
          text " "
          LI (&93834764459128)
            text "Ist die Teilzeichenkette des Authentisierungstokens nach "AT" ein 256-Bit Hexadezimal kodierter Wert? Falls nein, dann FAIL."
          text " "
        text "Falls eine der Prüfungen ein FAIL liefert, so MUSS der Client mit einem Fehler abbrechen und ggf. mit dem Protokollablauf neu starten. "
        BR (&93834764459672)
        text "Der Client MUSS den Authentisierungstoken für die im Protokollablauf folgenden Aufruf der Operation KeyDerivation ("
        SPAN (&93834764459976)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17898"
          attr data-item-id "ML-94696"
          attr data-option-id "custom"
          attr data-type "crossReference"
          attr id "fake"
        text " ) speichern."
        BR (&93834764461336)
        text " "
        B (&93834764461640)
          text "[<=]"
        P (&93834764461944)
        text " "
      text " "
      H3 (&93834764462368)
        attr id "6.6"
        text "6.6 Operation KeyDerivation"
      text " "
      DIV (&93834764462968)
        attr id "A_18029"
        text " "
        P (&93834764463448)
          B (&93834764463632)
            text "A_18029 - SGD-Client, Anfrage KeyDerivation"
        text " "
        P (&93834764464056)
          text "Ein Client eines SGD-ePA MUSS, nachdem er über erfolgreich über die Operation GetAuthenticationToken (A_18025-*) ein Authentisierungstoken vom SGD-HSM erhalten hat (vgl. "
          SPAN (&93834764464360)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18028"
            attr data-item-id "ML-96285"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " ), eine Zeichenkette der folgenden Form bilden:"
          BR (&93834764465720)
          text " "
          SPAN (&93834764466024)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "    <Authentisierungstoken> <Request-ID> KeyDerivation <Ableitungsregel>"
            BR (&93834764466504)
            text " "
          BR (&93834764466808)
          text "Die Request-ID MUSS ein 256-Bit Zufallswert in Hexadezimalform sein (ohne führendes "0x"), den der Client pro Request (KeyDerivation) zufällig erzeugen MUSS. Diese Request-ID MUSS der Client zwischenspeichern (vgl. Prüfung in "
          SPAN (&93834764467112)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18031-01"
            attr data-item-id "ML-102757"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text "  )."
          BR (&93834764468472)
          text " "
          BR (&93834764468776)
          text "Die Ableitungsregeln MUSS der Client je nach Anwendungsfall (vgl. [gemSpec_SGD_ePA#Abschnitt"
          SPAN (&93834764469080)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94493"
            attr data-option-id "shortoutline"
            attr data-type "crossReference"
            attr id "fake"
          text " ff]) gemäß "
          SPAN (&93834764470264)
            attr style "font-size: 10pt;line-height: 1.5;"
            SPAN (&93834764470624)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17924-01"
              attr data-item-id "ML-102756"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text " "
          text " erzeugen."
          BR (&93834764472104)
          text " "
          BR (&93834764472408)
          text "Diese erzeugte Zeichenkette MUSS der Client über das ECIES-Verfahren gemäß [gemSpec_Krypt#"
          SPAN (&93834764472712)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17875"
            attr data-type "polarion"
            attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
            attr id "fake"
          text "] für das SGD-HSM verschlüsseln. Das erhaltene Chiffrat MUSS der Client gemäß "
          SPAN (&93834764473896)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17902"
            attr data-item-id "ML-94703"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " kodieren und die Kodierung als "EncryptedMessage" bei Operation KeyDerivation ("
          SPAN (&93834764475256)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " ) verwenden."
          B (&93834764476712)
            text "[<=]"
        text " "
      text " "
      DIV (&93834764477256)
        attr id "A_17898"
        text " "
        P (&93834764477736)
          B (&93834764477920)
            text "A_17898 - SGD, KeyDerivation"
        text " "
        P (&93834764478344)
          text "Ein SGD ePA MUSS Folgendes sicherstellen: Wenn über dessen HTTPS-SGD-Schnittstelle (vgl."
          SPAN (&93834764478648)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17889"
            attr data-item-id "ML-94687"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " ) ein POST-Request mit dem Request-Body nach [gemSpec_SGD_ePA#Tab_KeyDerivation-Request] eintrifft, so MUSS die RVE des SGD"
          SPAN (&93834764480008)
            attr style "font-family: Arial, Helvetica;"
            BR (&93834764480368)
            text " "
          text " "
        OL (&93834764480792)
          text " "
          LI (&93834764481096)
            SPAN (&93834764481280)
              attr style "font-family: Arial, Helvetica;"
              text "das Zertifikat im Datenfeld "Certificate" gemäß TUC_PKI_018"
            text "(OCSP-Graceperiod=4h, PolicyList={oid_egk_aut, oid_egk_aut_alt, oid_smc_b_aut})"
            SPAN (&93834764481880)
              attr style "font-family: Arial, Helvetica;"
              SPAN (&93834764482240)
                attr style "font-size: 11pt;line-height: 1.5;"
                text " "
              text "prüfen und dabei Ergebnisse nach  "
              SPAN (&93834764482840)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17896"
                attr data-item-id "ML-94695"
                attr data-option-id "custom"
                attr data-type "crossReference"
                attr id "fake"
              text " berücksichtigen."
          text " "
          LI (&93834764484320)
            text "die Kodierung und die Signatur der "PublicKeyECIES" prüfen (vgl. "
            SPAN (&93834764484624)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17900"
              attr data-item-id "ML-94700"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text " und "
            SPAN (&93834764485984)
              attr class "polarion-rte-link"
              attr data-custom-label "A_17901"
              attr data-item-id "ML-94701"
              attr data-option-id "custom"
              attr data-type "crossReference"
              attr id "fake"
            text "). "
          text " "
        text "Falls eine der Prüfungen ein nicht-positives Ergebnis liefert, so MUSS die RVE des SGD mit einer entsprechenden Fehlermeldung aus [gemSpec_SGD_ePA#"
        SPAN (&93834764487584)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94577"
          attr data-option-id "longoutline"
          attr data-type "crossReference"
          attr id "fake"
        text "] dem Client antworten und die weitere Requestverarbeitung abbrechen."
        BR (&93834764488768)
        text "Die RVE des SGD MUSS die Informationen aufbereiten und an das für den Request avisierte SGD-HSM übergeben (vgl."
        SPAN (&93834764489072)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18030"
          attr data-item-id "ML-96287"
          attr data-option-id "custom"
          attr data-type "crossReference"
          attr id "fake"
        text "). Liefert das SGD-HSM ein OK, so MUSS die SGD die Antwort den HTTP-POST-Request mit folgender Nachricht beantworten:"
        BR (&93834764490432)
        text " "
        SPAN (&93834764490736)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text "{"
          BR (&93834764491216)
          text "  "Status" : "OK","
          BR (&93834764491520)
          text "  "EncryptedMessage" : "... Base64-kodiertes Chiffrat. Das Chiffrat wurde vom SGD-HSM erzeugt ...""
          BR (&93834764491824)
          text "}"
          BR (&93834764492128)
          text " "
        text " "
        SPAN (&93834764492552)
          attr style "font-family: Arial, Helvetica;"
          text "Anderenfalls (SGD-HSM meldet einen Fehler) MUSS die RVE des SGD mit einer entsprechenden Fehlermeldung aus [gemSpec_SGD_ePA#"
          SPAN (&93834764493032)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94577"
            attr data-option-id "longoutline"
            attr data-type "crossReference"
            attr id "fake"
          text "]  dem Client antworten."
        text " "
        B (&93834764494336)
          text "[<=]"
        P (&93834764494640)
        text " "
      text " "
      P (&93834764495064)
        attr id "polarion_208"
      text " "
      P (&93834764495544)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_153"
        text "Tabelle "
        SPAN (&93834764496376)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "9"
        text ": Tab_KeyDerivation-Request"
      text " "
      TABLE (&93834764497272)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=5"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834764498104)
          text " "
          TR (&93834764498408)
            text " "
            TD (&93834764498712)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 121.556px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834764499072)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "{ "Command"          : "KeyDerivation","
              BR (&93834764499552)
              text " "
              SPAN (&93834764499856)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "PublicKeyECIES"    : " ... Kodierung nach "
              SPAN (&93834764500336)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17900"
                attr data-item-id "ML-94700"
                attr data-option-id "custom"
                attr data-scope "Mainline_OPB1"
                attr data-type "crossReference"
                attr id "fake"
              SPAN (&93834764501752)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  ...","
              BR (&93834764502232)
              text " "
              SPAN (&93834764502536)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "Signature"        : " ... Base64-kodierte Signatur des PublicKeyECIES nach"
              text " "
              SPAN (&93834764503136)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17900"
                attr data-item-id "ML-94700"
                attr data-option-id "custom"
                attr data-scope "Mainline_OPB1"
                attr data-type "crossReference"
                attr id "fake"
              SPAN (&93834764504552)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text " ...","
              BR (&93834764505032)
              text " "
              SPAN (&93834764505336)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "Certificate"      : " ... Base64-kodiertes Client-Zertifikat ... ","
              BR (&93834764505816)
              text " "
              SPAN (&93834764506120)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  "EncryptedMessage" : " ... Base64-kodiertes Chiffrat nach "
              SPAN (&93834764506600)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17902"
                attr data-item-id "ML-94703"
                attr data-option-id "custom"
                attr data-scope "Mainline_OPB1"
                attr data-type "crossReference"
                attr id "fake"
              SPAN (&93834764508016)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "  ...""
              BR (&93834764508496)
              text " "
              SPAN (&93834774889848)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "}"
              BR (&93834774890304)
              text " "
            text " "
          text " "
        text " "
      text " "
      P (&93834774891088)
        attr id "polarion_211"
      text " "
      P (&93834774891568)
        attr id "polarion_342"
        text "Hinweis: für das Caching der Signaturprüfung nach A_17898-* gilt ebenfalls A_22488 aus Abschnitt ""
        SPAN (&93834774892048)
          attr class "polarion-rte-link"
          attr data-item-id "ML-96277"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ""."
      text " "
      DIV (&93834774893528)
        attr id "A_17888"
        text " "
        P (&93834774894008)
          B (&93834774894192)
            text "A_17888 - SGD, KeyDerivation (Client)"
        text " "
        P (&93834774894616)
          text "Ein Client eines SGD ePA MUSS die Operation KeyDerivation gemäß"
          SPAN (&93834774894920)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " umsetzen."
          B (&93834774896280)
            text "[<=]"
        text " "
      text " "
      DIV (&93834774896824)
        attr id "A_18031-01"
        text " "
        P (&93834774897304)
          B (&93834774897488)
            text "A_18031-01 - SGD-Client, Auswertung der Anfrage KeyDerivation (1/2)"
        text " "
        P (&93834774897912)
          text "Ein Client eines SGD-ePA MUSS, nachdem er über die Operation KeyDerivation ( "
          SPAN (&93834774898216)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17898"
            attr data-item-id "ML-94696"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " ) die Durchführung einer Schlüsselableitung angefordert hat, die Antwort in "EncryptedMessage" mittels des ECIES-Verfahrens gemäß [gemSpec_Krypt#"
          SPAN (&93834774899576)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17875"
            attr data-type "polarion"
            attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
            attr id "fake"
          text " ] entschlüsseln."
          BR (&93834774900760)
          text " "
          BR (&93834774901064)
          text "Der Client MUSS prüfen, ob die Antwort folgender Form entspricht:"
          BR (&93834774901368)
          text " "
          SPAN (&93834774901672)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "    <Authentisierungstoken> <Request-ID> OK-KeyDerivation <256-Bit-AES-Schlüssel-in-Hexform> <Ableitungsvektor>"
          BR (&93834774902152)
          text "Beispiel:"
          BR (&93834774902456)
          text " "
          SPAN (&93834774902760)
            attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
            text "    AT1ce627dd5e4c6536ca0dd93f896744d42c6580537953a49fcc5840dd8f8f4efa 7522d04ca28f2c6d3f5a53b2a31aebe1f91f2cfb75145b35c9a01fae7930340c OK-KeyDerivation 4a76068ed4796ac5d513ee05c9ff7d007271499f8bd8e04e8146031af576b4dd r2:7f8f77003dbab49c3a4e32f44726f92324d292fa668fde5ebc3424397986be99:107299005A112102647:2-20a1201-001:Bezeichner ACME Q1 2020"
          BR (&93834774903240)
          text " "
          BR (&93834774903544)
          text "Der Client MUSS prüfen, ob der Authentisierungstoken genau der Token ist, den der Client im Request für KeyDerivation verwendet hat. Falls nein, so MUSS er die erhaltene Antwort verwerfen (i. S. v. er darf insbesondere die erhaltenen Schlüssel nicht nutzen). "
          BR (&93834774903848)
          text " "
          BR (&93834774904152)
          text "Der Client MUSS prüfen, ob die Request-ID genau die ist, die der Client für Request für KeyDerivation verwendet hat (zufällig erzeugt hat vgl."
          SPAN (&93834774904456)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18029"
            attr data-item-id "ML-96286"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text "). Falls nein, so MUSS er die erhaltene Antwort verwerfen (i. S. v. er darf insbesondere die erhaltenen Schlüssel nicht nutzen).  "
          B (&93834774905816)
            text "[<=]"
        text " "
      text " "
      DIV (&93834774906360)
        attr id "A_20977"
        text " "
        P (&93834774906840)
          B (&93834774907024)
            text "A_20977 - SGD-Client, Auswertung der Anfrage KeyDerivation (2/2)"
        text " "
        P (&93834774907448)
          text "Ein"
          SPAN (&93834774907752)
            attr id "polarion-comment:389"
          text "Client eines SGD-ePA MUSS, nachdem er die Prüfungen aus A_18031-* durchgeführt hat, folgendes prüfen."
          BR (&93834774908232)
          text "Er MUSS prüfen, ob die Ableitungsregel im Ableitungsvektor, der in der Antwort des SGD-HSMs angeführt ist, der Ableitungsregel entspricht die der Client erwartet (siehe folgend)."
          BR (&93834774908536)
          text "Falls er nicht den erwarteten Wert in der Antwort des SGD-HSMs vorfindet, so MUSS er den Protokoll-Durchlauf abbrechen und MUSS die enthalten Schlüssel ("<256-Bit-AES-Schlüssel-in-Hexform>" aus A_18031-*) verwerfen, d. h. sie nicht für eine Ver-oder Entschlüsselung verwenden."
          BR (&93834774908840)
          text " "
          BR (&93834774909144)
          text "Es gibt 3 Arten von Ableitungsregeln, die ein Client bei der Operation KeyDerivation an ein SGD-HSM senden kann. Jeweils gibt es eine "initiale" Variante bspw. "r1:<KVNR>" und eine Variante für spätere Aufrufe bspw. ""r1:<256-Bit-RND-in-Hexform>:<KVNR>:<Ableitungsschlüsselbezeichner>"."
          BR (&93834774909448)
          text "Bei den drei Varianten für spätere Aufrufe ("
          BR (&93834774909752)
          text ""r1:<256-Bit-RND-in-Hexform>:<KVNR>:<Ableitungsschlüsselbezeichner>""
          BR (&93834774910056)
          text ""r2:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter oder Telematik-ID>:<Ableitungsschlüsselbezeichner>""
          BR (&93834774910360)
          text ""r3:<256-Bit-RND-in-Hexform>:<KVNR-Kontoinhaber>:<KVNR-Vertreter>:<Telematik-ID>:<Ableitungsschlüsselbezeichner>")"
          BR (&93834774910664)
          text "erwartet ein Client genau diese Ableitungsregel im Ableitungsvektor in der Antwort des SGD-HSMs. D. h. ein Client führt einfach einen Bitvergleich Gesendete-Ableitungsregel == Empfangene-Ableitungsregel durch."
          BR (&93834774910968)
          text "Bei den initialen Varianten ("
          BR (&93834774911272)
          text ""r1:<KVNR>""
          BR (&93834774911576)
          text ""r2:<KVNR-Vertreter oder Telematik-ID>""
          BR (&93834774911880)
          text ""r3:<Telematik-ID>:<KVNR-Kontoinhaber>")"
          BR (&93834774912184)
          text "erwartet der Client die entsprechend mit "<256-Bit-RND-in-Hexform>" und "<aktueller Ableitungsschlüsselbezeichner>" erweiterten Formen. In diesen erweiterten Formen müssen die korrekten Daten aus der initialen Variante -- die der Client initial dem SGD-HSM geschickt hat -- enthalten sein."
          B (&93834774912488)
            text "[<=]"
        text " "
      text " "
      H3 (&93834774913032)
        attr id "6.7"
        text "6.7 Fehlermeldungen"
      text " "
      DIV (&93834774913632)
        attr id "A_18987"
        text " "
        P (&93834774914112)
          B (&93834774914296)
            text "A_18987 - SGD, RVE, Fehlermeldungen"
        text " "
        P (&93834774914720)
          SPAN (&93834774914904)
            attr style "font-size: 10pt;line-height: 1.5;"
            text "Ein SGD ePA MUSS Folgendes sicherstellen: Die RVE MUSS bei Fehlerfällen die in Tabelle ”Tab_Fehlerfälle_und_Fehlermeldungen” aufgeführten Fehlermeldungen an einen SGD-Client senden. Diese Fehlermeldungen MUSS der SGD wie die anderen Nachrichten des SGD-Protokoll mit dem HTTP-Status-Code 200 (OK) übertragen (vgl. Erläuterung in Abschnitt 6.7.1)."
          text " "
          B (&93834774915504)
            text "[<=]"
        text " "
      text " "
      P (&93834774916048)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_161"
        text "Tabelle "
        SPAN (&93834774916704)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "10"
        text ": Tab_Fehlerfälle_und_Fehlermeldungen"
      text " "
      TABLE (&93834774917600)
        attr id "polarion_wiki macro name=table;params=width=99.87%|uid=112"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834774918256)
          text " "
          TR (&93834774918560)
            text " "
            TH (&93834774918864)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834774919224)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Fehlerfall"
              BR (&93834774919704)
              text " "
            text " "
            TH (&93834774920128)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              text "transient"
            text " "
            TH (&93834774920728)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834774921088)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "an den Client zu sendende Fehlernachricht"
              BR (&93834774921568)
              text " "
            text " "
          text " "
          TR (&93834774922112)
            text " "
            TD (&93834774922416)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783864000)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die Authentizität des Requests ist nicht gegeben (bspw. AES-GCM meldet FAIL) das SGD-HSM meldet FAIL."
                BR (&93834783864480)
                text " "
            text " "
            TD (&93834783864904)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834783865384)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783865744)
                attr style "font-size: 10pt;line-height: 1.5;"
                SPAN (&93834783866104)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "{ "Status" : "decryption FAIL" }"
                BR (&93834783866584)
                text " "
            text " "
          text " "
          TR (&93834783867128)
            text " "
            TD (&93834783867432)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783867792)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die Zertifikatsprüfung in der RVE oder im SGD-HSM ergab FAIL."
                BR (&93834783868272)
                text " "
            text " "
            TD (&93834783868696)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834783869176)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783869536)
                attr style "font-size: 10pt;line-height: 1.5;"
                SPAN (&93834783869896)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "{ "Status" : "certificate not valid" }"
                BR (&93834783870376)
                text " "
            text " "
          text " "
          TR (&93834783870920)
            text " "
            TD (&93834783871224)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783871584)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die Signatur des öffentlichen ephemeren ECIES-Client-Schlüssel ist nicht valide."
                BR (&93834783872064)
                text " "
            text " "
            TD (&93834783872488)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834783872968)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783873328)
                attr style "font-size: 10pt;line-height: 1.5;"
                SPAN (&93834783873688)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "{ "Status" : "signature not valid" }"
                BR (&93834783874168)
                text " "
            text " "
          text " "
          TR (&93834783874712)
            text " "
            TD (&93834783875016)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783875376)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Datenfelder im Request fehlen."
                BR (&93834783875856)
                text " "
            text " "
            TD (&93834783876280)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834783876760)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783877120)
                attr style "font-size: 10pt;line-height: 1.5;"
                SPAN (&93834783877480)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "{ "Status" : "request not valid" }"
                BR (&93834783877960)
                text " "
            text " "
          text " "
          TR (&93834783878504)
            text " "
            TD (&93834783878808)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783879168)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Request ist größer als 2 MiB ("
                SPAN (&93834783879648)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17893"
                  attr data-item-id "ML-94690"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
                BR (&93834783881184)
                text " "
            text " "
            TD (&93834783881608)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834783882088)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783882448)
                attr style "font-size: 10pt;line-height: 1.5;"
                SPAN (&93834783882808)
                  attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                  text "{ "Status" : "request not valid" }"
                BR (&93834783883288)
                text " "
            text " "
          text " "
          TR (&93834783883832)
            text " "
            TD (&93834783884136)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783884496)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die RVE stellt fest, dass das für einen Client (nach Protokoll-Nachricht 2) festgelegt SGD-HSM nicht mehr verfügbar ist (bspw. Hardware-Schaden). Der Client soll (MUSS) in diesem Falle den Protokollablauf neu starten (vgl."
                SPAN (&93834783884976)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18988"
                  attr data-item-id "ML-102144"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
            text " "
            TD (&93834783886632)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              text "Ja"
            text " "
            TD (&93834783887232)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783887592)
                attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "{ "Status" : "restart protocol" }"
            text " "
          text " "
          TR (&93834783888312)
            text " "
            TD (&93834783888616)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              text "Die RVE konnte keine gültigen OCSP-Auskunft für des EE-Zertifikat des Nutzers des Client erhalten, bspw. wenn der Verbindungsaufbau zum OCSP-Responder fehlschlug. Der Client soll es noch einmal versuchen in der Hoffnung, dass dann der OCSP-Responder wieder verfügbar ist."
            text " "
            TD (&93834783889216)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              text "Vielleicht"
            text " "
            TD (&93834783889816)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783890176)
                attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                text "{ "Status" : "OCSP-Response not available" }"
            text " "
          text " "
          TR (&93834783890896)
            text " "
            TD (&93834783891200)
              attr style "vertical-align: top;width: 250px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              text "Ein Client hat schon zu viele Anfragen pro Zeiteinheit gesendet (vgl. Hinweise nach"
              SPAN (&93834783891680)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17891"
                attr data-item-id "ML-94689"
                attr data-option-id "custom"
                attr data-scope "Mainline_OPB1"
                attr data-type "crossReference"
                attr id "fake"
              text " )."
            text " "
            TD (&93834783893336)
              attr style "vertical-align: top;width: 60px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834783893816)
              attr style "vertical-align: top;width: 404px;height: 9pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834783894176)
                attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
                text "{ "Status" : "rate limiting per user" }"
            text " "
          text " "
        text " "
      text " "
      DIV (&93834783895136)
        attr id "A_18988"
        text " "
        P (&93834783895616)
          B (&93834783895800)
            text "A_18988 - SGD-Client, Neustart des Protokolldurchlaufs"
        text " "
        P (&93834783896224)
          SPAN (&93834783896408)
            attr style "font-size: 10pt;line-height: 1.5;"
            text "Ein Client eines SGD ePA MUSS wenn er eine Fehlermeldung aus Tabelle [gemSpec_SGD_ePA#Tab_Fehlerfälle_und_Fehlermeldungen] vom SGD erhält, die als "transient" mit "Ja" oder "Vielleicht" in der Tabelle aufgeführt ist, den Protokollablauf neu starten (GetPublicKey etc.)."
            BR (&93834783896904)
            text "Er MUSS einen Fehler-Zähler führen. Wenn nach 5 Protokoll-Neustarts der Fehler immer noch auftritt, so KANN er abbrechen (Vermeidung von Endlosschleifen)."
          text " "
          B (&93834783897328)
            text "[<=]"
        text " "
      text " "
      DIV (&93834783897872)
        attr id "A_19000"
        text " "
        P (&93834783898352)
          B (&93834783898536)
            text "A_19000 - SGD, RVE, selbst definierte Fehlermeldungen und erweiterte Statusinformationen"
        text " "
        P (&93834783898960)
          text "Eine RVE eines SGD ePA KANN weitere Fehlermeldungen analog zu den in Tabelle [gemSpec_SGD_ePA#Tab_Fehlerfälle_und_Fehlermeldungen] aufgeführten Fehlermeldungen für sich definieren und an einen SGD-Client senden. Analog zu"
          SPAN (&93834783899264)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18987"
            attr data-item-id "ML-102143"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " MÜSSEN diese Fehlermeldungen mit dem HTTP-Status-Code 200 (OK) übertragen werden."
          BR (&93834783900624)
          text "Eine RVE KANN jede Fehlermeldungen ("
          SPAN (&93834783900928)
            attr class "polarion-rte-link"
            attr data-custom-label "A_18987"
            attr data-item-id "ML-102143"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " und "
          SPAN (&93834783902288)
            attr class "polarion-rte-link"
            attr data-custom-label "A_19000"
            attr data-item-id "ML-102181"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " ) mit beliebigen JSON-Format-konformen Statusinformationen anreichern. Dabei gilt die Größenbeschränkung aus"
          SPAN (&93834783903648)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17893"
            attr data-item-id "ML-94690"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text "."
          BR (&93834783905008)
          text "Beispiel:"
          BR (&93834783905312)
          text " "
          SPAN (&93834783905616)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            SPAN (&93834783905976)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "{"
            BR (&93834783906456)
            text " "
            SPAN (&93834783906760)
              attr style "font-size: 10pt;line-height: 1.5;"
              text " "Status": "decryption FAIL","
            BR (&93834783907240)
            text " "
            SPAN (&93834783907544)
              attr style "font-size: 10pt;line-height: 1.5;"
              text " "Error": {"
            BR (&93834783908024)
            text " "
            SPAN (&93834783908328)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "  "Timestamp": "2019-01-15T13:37:42.123Z","
            BR (&93834783908808)
            text " "
            SPAN (&93834783909112)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "  "Trace": {"
            BR (&93834783909592)
            text " "
            SPAN (&93834783909896)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "   "LogReference": "550e8400-e29b-11d4-4ffe-446655440000""
            BR (&93834783910376)
            text " "
            SPAN (&93834783910680)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "  }"
            BR (&93834783911160)
            text " "
            SPAN (&93834783911464)
              attr style "font-size: 10pt;line-height: 1.5;"
              text " }"
            BR (&93834783911944)
            text " "
            SPAN (&93834783912248)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "}"
          text " "
          B (&93834783912848)
            text "[<=]"
        text " "
      text " "
      P (&93834783913392)
        attr id "polarion_242"
        text "Hinweis zu"
        SPAN (&93834783913872)
          attr class "polarion-rte-link"
          attr data-custom-label "A_19000"
          attr data-item-id "ML-102181"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " : In Bezug auf einen Client vgl."
        SPAN (&93834783915408)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17892"
          attr data-item-id "ML-94691"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "  ("
        SPAN (&93834783916944)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Aufwärtskompatibilität JSON-Requests und -Responses)."
        text " "
      text " "
      H4 (&93834783917664)
        attr id "6.7.1"
        text "6.7.1 Fehlermeldungen und HTTP-Status-Code (informativ)"
      text " "
      P (&93834783918264)
        attr id "polarion_88"
        text " "
        SPAN (&93834783918744)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Ein SGD besitzt keine RESTful-Schnittstelle. Demnach resultieren Applikationsfehler nicht in Fehlermeldungen des HTTP-Protokolls bei der Applikationsdatenübermittlung. Applikationsfehler erzeugen keine HTTP-Fehler-Codes. Die Applikationsschicht und die darunterliegende HTTP-Schicht werden als separate Sichten im OSI-Schichtenmodell betrachtet."
        text " "
      text " "
      P (&93834783919464)
        attr id "polarion_171"
        text " "
        SPAN (&93834783919944)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Dies erleichtert das Tunneln der SGD-Protokollnachrichten (Applikationsebene) bspw. über das Zugangsgateway des Versicherten. "
        text " "
      text " "
      P (&93834783920664)
        attr id "polarion_81"
        text " "
        SPAN (&93834783921144)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Die SGD-Schnittstelle hat mit einer RESTful-Schnittstelle die Gemeinsamkeit, dass über HTTP hauptsächlich JSON-Datenstrukturen übertragen werden. Ansonsten gibt es kaum Gemeinsamkeiten."
        BR (&93834783921624)
        text " "
        BR (&93834783921928)
        text " "
        SPAN (&93834783922232)
          attr style "text-decoration: underline;font-size: 10pt;line-height: 1.5;"
          text "Beispiel 1, Bit-Flip im Chiffrat im GetAuthenticationToken-Request:"
        BR (&93834783922712)
        text " "
        SPAN (&93834783923016)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Die RVE erreicht ein GetAuthenticationToken-Request (Nachricht 3 im SGD-Protokoll). Als konstruiertes Beispiel ist dort im Chiffrat ein Bitflip aufgetreten. Dies kann die RVE nicht erkennen. Das für den Client ausgewählte SGD-HSM erkennt dies (AES-GCM als Authenticated Enryption erzeugt ein FAIL bei der Entschlüsselung). Das SGD-HSM übermittelt diese Information an die RVE (Innen-Interface). Die RVE erzeugt dann als Antwort "
        text " "
      text " "
      P (&93834783923736)
        attr id "polarion_238"
        attr style "margin-left: 40px;"
        text " "
        SPAN (&93834783924392)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "{ "Status" : "decryption FAIL" }"
        text " "
      text " "
      P (&93834783925112)
        attr id "polarion_239"
        text " "
        SPAN (&93834783925592)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "gemäß Tabelle Tab_Fehlerfälle_und_Fehlermeldungen  und zwar als Teil der HTTP-Response mit HTTP-Status-Code 200 (OK)."
        BR (&93834783926072)
        text " "
        BR (&93834783926376)
        text " "
        SPAN (&93834783926680)
          attr style "text-decoration: underline;font-size: 10pt;line-height: 1.5;"
          text "Beispiel 2, ungültige HTTP-Methode verwendet: "
        BR (&93834783927160)
        text " "
        SPAN (&93834783927464)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Aus der TI (also ohne Beteiligung des Zugangsgateway des Versicherten) wird ein HTTP-Request an den SGD2 gesendet. Der Client sendet als konstruiertes Beispiel nicht "POST /SGD2 HTTP/1.1" sondern "OST /SGD2 HTTP/1.1" als erste Zeile des HTTP-Requests. Darauf hin antwortet das Webinterface der SGD2 gemäß des HTTP-Protokolls mit HTTP-Status-Code 400 (Bad Request), weil es die Methode „OST“ innerhalb des HTTP-Protokolls nicht gibt."
        BR (&93834783927944)
        text " "
        BR (&93834783928248)
        text " "
      text " "
      H2 (&93834783928672)
        attr id "7"
        text "7 Clientspezifische Festlegungen"
      text " "
      P (&93834783929416)
        attr id "polarion_75"
        text "Ein ePA-FdV, ein FM ePA und ein KTR-Consumer sind Clients eines SGD."
      text " "
      DIV (&93834783929992)
        attr id "A_17847"
        text " "
        P (&93834783930472)
          B (&93834783930656)
            text "A_17847 - Prüfung eines SGD-HSM-Zertifikats (1/2)"
        text " "
        P (&93834783931080)
          text "Ein Client eines SGD MUSS bei Prüfung eines SGD-HSM-Zertifikats bei bzw. vor der Erzeugung eines Requests an den SGD prüfen, ob das Zertifikat in der TSL innerhalb eines "TSPService"-Eintrags mit dem ServiceTypeIdentifier "http://uri.etsi.org/TrstSvc/Svctype/unspecified" aufgeführt ist und dieses zeitlich aktuell gültig ist."
          BR (&93834783931384)
          text "Falls nein, so MUSS das Zertifikat abgelehnt werden und die Verarbeitung des Zertifikats abgebrochen werden."
          B (&93834783931688)
            text "[<=]"
        text " "
      text " "
      DIV (&93834783932232)
        attr id "A_17848"
        text " "
        P (&93834783932712)
          B (&93834783932896)
            text "A_17848 - Prüfung eines SGD-HSM-Zertifikats (2/2)"
        text " "
        P (&93834783933320)
          text "Ein Client eines SGD ePA MUSS, falls bei der Prüfung eines SGD-HSM-Zertifikats ein SGD-1-Zertifikat erwartet wird, prüfen, ob die OID oid_sgd1_hsm [gemSpec_OID] im SGD-HSM-Zertifikat (Kontext Prüfung der Signatur der aktuellen SGD-HSM-ECIES-Schlüssel) aufgeführt ist."
          BR (&93834783933624)
          text "Falls nicht, so MUSS das Zertifikat abgelehnt werden."
          BR (&93834783933928)
          text "Analog SGD-2-Zertifikat und OID oid_sgd2_hsm."
          B (&93834783934232)
            text "[<=]"
        text " "
      text " "
      P (&93834783934776)
        attr id "polarion_130"
        text "Verständnishinweis: In "
        SPAN (&93834783935256)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_PKI#A_17700]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_PKI?selection=ML-94225"
          attr id "fake"
        text " wird die generelle Auswertbarkeit solcher TSL-Einträge auch thematisiert."
      text " "
      DIV (&93834783936736)
        attr id "A_17925"
        text " "
        P (&93834783937216)
          B (&93834783937400)
            text "A_17925 - SGD-Client, Parallele Anfrage SGD1 und SGD2"
        text " "
        P (&93834783937824)
          text "Ein Client eines SGD MUSS, um eine höhere Performanz zu erreichen, im Rahmen der Schlüsselableitungsfunktionalität den SGD 1 und den SGD 2 parallel anfragen."
          BR (&93834783938128)
          text " "
          B (&93834783938432)
            text "[<=]"
        text " "
      text " "
      DIV (&93834783938976)
        attr id "A_17990"
        text " "
        P (&93834783939456)
          B (&93834783939640)
            text "A_17990 - ePA-FdV: Parallele Anfrage SGD1 und SGD2"
        text " "
        P (&93834783940064)
          text "Ein ePA-FdV MUSS bei der Umsetzung von "
          SPAN (&93834783940368)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17925"
            attr data-item-id "ML-94728"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " die aktuell bestehende TLS-Verbindung zum Zugangsgateway des Versicherten per TLS-Resumption "clonen" (vgl. „third option“ [RFC-5246, S. 40, erster Abschnitt]). Auf einer TLS-Verbindung MUSS das ePA-FdV den SGD 1 anfragen auf der anderen den SGD 2."
          BR (&93834783941728)
          text "Sollte das Zugangsgateway eine TLS-Resumption ablehnen, so MUSS der Client, so wie im TLS-Protokoll vorgesehen, einen "full handshake" für den Aufbau der zusätzlichen TLS-Verbindung durchführen."
          B (&93834783942032)
            text "[<=]"
        text " "
      text " "
      P (&93834783942576)
        attr id "polarion_194"
        text "Hinweis: Für die Vereinfachung der Parallelisierung für ein ePA-FdV gibt es"
        SPAN (&93834783943056)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Zugangsgateway_Vers#A_17495]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Zugangsgateway_Vers?selection=ML-93901"
          attr id "fake"
        text " ."
      text " "
      DIV (&93834783944536)
        attr id "A_22494"
        text " "
        P (&93834783945016)
          B (&93834783945200)
            text "A_22494 - SGD-Client, HTTP-Variable SGD-Userpseudonym"
        text " "
        P (&93834783945624)
          text "Ein Client eines SGD ePA MUSS bei Erhalt einer SGD-Protokoll-Nachricht prüfen, ob im HTTP-Response-Header eine HTTP-Variable Namens "SGD-Userpseudonym" existiert. Falls ja so MUSS der SGD-Client diese Variable inkl. Wert unverändert im nächsten Request an den SGD im HTTP-Request-Header aufführen."
          SPAN (&93834783945928)
            attr style "background-color: #FFFF99;"
          text " "
          B (&93834783946408)
            text "[<=]"
        text " "
      text " "
      P (&93834783946952)
        attr id "polarion_343"
        text "Erläuterung: A_22494 wird es in einer zukünftigen Ausbaustufe des SGDs einem SGD erleichtern den DoS-Schutz effizienter umzusetzen (analog zu gemSpec_Krypt#A_20162)."
      text " "
      DIV (&93834783947552)
        attr id "A_18003"
        text " "
        P (&93834783948032)
          B (&93834783948216)
            text "A_18003 - SGD-Client, Prüfung der Telematik-ID bei Berechtigungsvergabe"
        text " "
        P (&93834783948640)
          text "Ein Client eines SGD ePA MUSS folgende Vorgaben umsetzen."
          BR (&93834783948944)
          text "Im Rahmen einer Berechtigungsvergabe (vgl. [gemSpec_SGD_ePA#Abschnitt"
          SPAN (&93834783949248)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94494"
            attr data-option-id "shortoutline"
            attr data-type "crossReference"
            attr id "fake"
          text " und"
          SPAN (&93834783950432)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94738"
            attr data-option-id "shortoutline"
            attr data-type "crossReference"
            attr id "fake"
          text "]) kann ein Versicherter oder ein Vertreter eine LEI berechtigen. Dabei muss der Client einen Ableitungsvektor erzeugen, bei dem die Telematik-ID der LEI in den Ableitungsvektor mit einfließen. Dabei MUSS der Client die Telematik-ID der LEI wie folgt prüfen."
          BR (&93834783951616)
          text "Falls in der Telematik-ID ein Doppelpunkt ("
          SPAN (&93834783951920)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text "":""
          text ", Character 58) enthalten ist, so MUSS der Client die Telematik-ID in Hexadezimalschreibweise (ohne führendes "0x") kodieren und davor ein"
          SPAN (&93834783952520)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""*""
          text " (Character 42) setzen."
          BR (&93834783953120)
          text "Beispiel:"
          BR (&93834783953424)
          text " "
          SPAN (&93834783953728)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""2-20a1201-001:AAB::112""
          text " wird zu "
          SPAN (&93834783954328)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""*"
            SPAN (&93834783954808)
              attr style "font-size: 10pt;line-height: 1.5;"
              text "322d323061313230312d3030313a4141423a3a313132""
          BR (&93834783955288)
          text "Diese Kodierung MUSS der Client bei der Erzeugung der Ableitungsvektoren jeweils bei"
          SPAN (&93834783955592)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""<TELEMATIK_ID>""
          text "verwenden."
          B (&93834783956192)
            text "[<=]"
        text " "
      text " "
      P (&93834783956736)
        attr id "polarion_262"
        text "Verständnishinweis: Die Vergabe der Telematik-IDs erfolgt durch die LE- und LEI-Organisationen. Nur die ersten drei Zeichen werden durch die Vorgaben aus [gemSpec_PKI#"
        SPAN (&93834783957216)
          attr class "polarion-rte-link"
          attr data-custom-label "Telematik-ID"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_PKI?selection=ML-6894"
          attr id "fake"
        text "] festgelegt. Damit kann es theoretisch vorkommen, dass dort nach der 3-ten Stelle der Telematik-ID ein ":" vorkommen könnte, was i. d. R. nicht der Fall ist."
      text " "
      DIV (&93834783958696)
        attr id "A_18032"
        text " "
        P (&93834783959176)
          B (&93834783959360)
            text "A_18032 - SGD-Client, kurzlebigen ECIES-Client-Schlüsselpaar"
        text " "
        P (&93834783959784)
          text "Ein Client eines SGD MUSS für die parallele Anfrage an beide SGD ein kurzlebiges ECIES-Client-Schlüsselpaar gemäß [gemSpec_Krypt#"
          SPAN (&93834783960088)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17874"
            attr data-type "polarion"
            attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94671"
            attr id "fake"
          text "] erzeugen. (Der Client verwendet dasselbe Schlüsselpaar für beide SGD)."
          B (&93834783961272)
            text "[<=]"
        text " "
      text " "
      DIV (&93834783961816)
        attr id "A_18005"
        text " "
        P (&93834781531552)
          B (&93834781531736)
            text "A_18005 - SGD-Client, nur Einmalverwendung des kurzlebigen ECIES-Client-Schlüsselpaars"
        text " "
        P (&93834781532160)
          text "Ein Client eines SGD DARF sein kurzlebiges ECIES-Client-Schlüsselpaar NICHT für mehr als eine Nutzung der Schlüsselableitungsfunktionalität ePA, also die parallele Anfrage an SGD 1 und SGD 2, nutzen. Für die nächste Nutzung MUSS der Client ein neues ECIES-Client-Schlüsselpaar erzeugen."
          B (&93834781532464)
            text "[<=]"
        text " "
      text " "
      P (&93834781533008)
        attr id "polarion_284"
        text "Verständnishinweis: sollte der Client keine Antwort (timeout) bspw. vom ZdGV bekommen u. Ä. so darf er die Anfrage mit dem gleichen Schlüsselpaar noch einmal wiederholen. Es geht um die kryptographische Nutzung des Schlüsselpaars, diese darf nur einmal innerhalb eines Protokollablaufs erfolgen. Bei einem folgenden Protokolldurchlauf muss der Client ein neues ECIES-Client-Schlüsselpaar verwenden."
      text " "
      DIV (&93834781533608)
        attr id "A_18006"
        text " "
        P (&93834781534088)
          B (&93834781534272)
            text "A_18006 - SGD-Client, KVNR"
        text " "
        P (&93834781534696)
          text "Ein Client eines SGD ePA MUSS bei einer Erstellung einer Anfrage für eine Schlüsselableitung (vgl. Abschnitte "
          SPAN (&93834781535000)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94494"
            attr data-option-id "shortoutline"
            attr data-type "crossReference"
            attr id "fake"
          text " und "
          SPAN (&93834781536184)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94738"
            attr data-option-id "shortoutline"
            attr data-type "crossReference"
            attr id "fake"
          text " ), im Falle dass dort vom Client initial eine KVNR eingetragen wird (KVNR eines Vertreters, KVNR eines Kontoinhabers im Vertretungsfall), die Variable KVNR bei der Konstruktion der Anfrage gemäß "
          SPAN (&93834781537368)
            attr class "polarion-rte-link"
            attr data-custom-label "A_17926"
            attr data-item-id "ML-94729"
            attr data-option-id "custom"
            attr data-type "crossReference"
            attr id "fake"
          text " verstehen."
          B (&93834781538728)
            text "[<=]"
        text " "
      text " "
      H3 (&93834781539272)
        attr id "7.1"
        text "7.1 Mehrfachableitung"
      text " "
      P (&93834781539872)
        attr id "polarion_344"
        text "Es gibt Anwendungsfälle bei denen ein SGD-Client mehrere Schlüsselableitungen durch einen SGD direkt nacheinander anfordert."
      text " "
      P (&93834781540472)
        attr id "polarion_345"
        text "Beispiele:"
      text " "
      UL (&93834781541072)
        attr id "polarion_346"
        text " "
        LI (&93834781541552)
          text "Ein ePA-FdV führt eine Umschlüsselung einer Akte mit anschließender Neuberechtigung durch (und damit auch Neuverschlüsselung von Kontext- und Aktenschlüssel für alle Berechtigten)."
        text " "
        LI (&93834781541976)
          text "Ein ePA-FdV führt einen Aktenumzug mit anschließender Neuberechtigung durch."
        text " "
        LI (&93834781542400)
          text "Ein KTR-Consumer möchte zum Quartalsende vielen Versicherten, die den KTR-Consumer zuvor dafür berechtigt haben, Abrechnungsinformationen zukommen lassen (in die Akte einstellen)."
        text " "
      text " "
      P (&93834781542944)
        attr id "polarion_347"
        text "Die Anforderung "A_18005, SGD-Client, nur Einmalverwendung des kurzlebigen ECIES-Client-Schlüsselpaars" hat die fachliche Motivation die Frage nach dem Lebenszyklus von sicherheitskritischen Datenobjekten (private kurzlebiger ECIES-Client-Schlüssel und damit verbundenen AuthenticationToken) zu klären und die Implementierung im SGD-Client zu vereinfachen. Das ECIES-Client-Schlüsselpaar wird einmal verwendet und anschließend sofort gelöscht."
      text " "
      P (&93834781543544)
        attr id "polarion_348"
        text "In den o. g. Anwendungsfällen ist es jedoch aus Performanz-Sicht wünschenswert die Mehrfachverwendung zuzulassen und damit die Kosten des erhöhten Aufwands bezüglich der Überwachung des Lebenszyklus der sicherheitskritischen Datenobjekte im Client zu tragen (wann wurden sie erzeugt, wie lange sind sie noch gültig, wann müssen neue Schlüssel erzeugt werden ...)."
      text " "
      DIV (&93834781544144)
        attr id "A_22497"
        text " "
        P (&93834781544624)
          B (&93834781544808)
            text "A_22497 - SGD-Client, Mehrfachableitung (kurzlebiges ECIES-Client-Schlüsselpaar)"
        text " "
        P (&93834781545232)
          text "Ein Client eines SGD ePA KANN auf die Umsetzung von A_18005-* verzichten, wenn er die sicherheitskritischen Datenobjekte (private kurzlebiger ECIES-Client-Schlüssel und damit verbundenen AuthenticationToken) innerhalb seiner Applikation schützt (sie dürfen in der Applikation nicht zwischen einzelnen Bestandteilen der Applikation transportiert werden) und diese Objekte vor Ablauf deren Gültigkeit (15 Minuten) im Client löscht."
          SPAN (&93834781545536)
            attr style "background-color: #FFFF99;"
          text " "
          B (&93834781546016)
            text "[<=]"
        text " "
      text " "
      P (&93834781546560)
        attr id "polarion_349"
        text "Durch die Mehrfachableitung sind für einen SGD-Client nach A_22497-* nicht mehr 6 * (Anzahl der abzuleitenden Schlüssel) SGD-Nachrichten notwendig, sondern nur noch 4 + 2*(Anzahl der abzuleitenden Schlüssel) SGD-Nachrichten."
      text " "
      H2 (&93834781547160)
        attr id "8"
        text "8 Interoperables Austauschformat"
      text " "
      P (&93834781547760)
        attr id "polarion_49"
        text "Damit die Interoperabilität zwischen Clienten eines SGD (ePA-FdV, FM ePA etc.) sichergestellt ist, wird nachfolgend ein interoperables Austauschformat definiert. Zunächst wird mit PHRKey [PHR_Common.xsd] eine Datenstruktur für die Klartextrepräsentation von Kontextschlüssel (ContextKey) und Aktenschlüssel (RecordKey) definiert. Daran folgt die Definition der Datenstruktur EncryptedKeyContainer [AuthorizationService.xsd]."
      text " "
      P (&93834781548360)
        attr class "polarion-rte-caption-paragraph"
        attr id "polarion_165"
        text "Tabelle "
        SPAN (&93834781549016)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "11"
        text ": Tab_Austauschformat_Akten-_und_Kontextschlüssel"
      text " "
      TABLE (&93834781549912)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=6"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834781550744)
          text " "
          TR (&93834781551048)
            text " "
            TD (&93834781551352)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 178.444px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834781551712)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<?xml version="1.0" encoding="UTF-8"?> "
              BR (&93834781552192)
              text " "
              SPAN (&93834781552496)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<epa:PHRKey insurant="[OwnerKVNR]">"
              BR (&93834781552976)
              text " "
              SPAN (&93834781553280)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "    <RecordKey algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm">"
              BR (&93834781553760)
              text " "
              SPAN (&93834781554064)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "        S2V5MS0yNTZCaXQtQUVTLUdDTS0xMjM0NTY3ODkwYWI="
              BR (&93834781554544)
              text " "
              SPAN (&93834781554848)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "    </RecordKey>"
              BR (&93834781555328)
              text " "
              SPAN (&93834781555632)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "    <ContextKey algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm">"
              BR (&93834781556112)
              text " "
              SPAN (&93834781556416)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "        S2V5Mi0yNTZCaXQtQUVTLUdDTS1iYTA5ODc2NTQzMjE=    "
              BR (&93834781556896)
              text " "
              SPAN (&93834781557200)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "    </ContextKey>"
              BR (&93834781557680)
              text " "
              SPAN (&93834781557984)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "</epa:PHRKey>"
              BR (&93834781558464)
              text " "
            text " "
          text " "
        text " "
      text " "
      P (&93834781559248)
        attr id "polarion_65"
        text "Vergleiche auch [PHR_Common.xsd]"
      text " "
      P (&93834781559848)
        attr id "polarion_137"
        text "Diese XML-Datenstruktur muss nun mittels des vom SGD 1 abgeleiteten spezifischen Schlüssels verschlüsselt werden (vgl."
        SPAN (&93834781560328)
          attr class "polarion-rte-link"
          attr data-custom-label "[gemSpec_Krypt#A_17872]"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94669"
          attr id "fake"
        text " ) und zusätzlich muss noch der Rückgabewert nach"
        SPAN (&93834781561688)
          attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
          text ""OK-Derivation ""
        text "als "associated data" mit in die MAC-Berechnung bei der AES-GCM-Verschlüsselung und GMAC-Berechnung einfließen. Das Ergebnis muss in einer EncryptedKeyContainer-XML-Datenstruktur kodiert werden, die folgende Form besitzt (vgl. auch Schemadatei  [AuthorizationService.xsd]):"
      text " "
      P (&93834781562408)
        attr class "polarion-rte-caption-paragraph"
        attr data-keep-next "true"
        attr id "polarion_168"
        text "Tabelle "
        SPAN (&93834781563240)
          attr class "polarion-rte-caption"
          attr data-sequence "Tabelle"
          text "12"
        text ": Tab_erste_Verschlüsselungsschicht"
      text " "
      TABLE (&93834781564216)
        attr class "polarion-Document-table"
        attr id "polarion_wiki macro name=table;params=header=no|width=100%|padding=2px|uid=7"
        attr style "width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834781565024)
          text " "
          TR (&93834781565328)
            text " "
            TD (&93834781565632)
              attr style "text-align: left;vertical-align: top;width: 742px;height: 198.889px;border: 1px solid #CCCCCC;padding: 2px;"
              SPAN (&93834781565992)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<?xml version="1.0" encoding="UTF-8"?>"
              BR (&93834781566472)
              text " "
              SPAN (&93834781566776)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<epa:EncryptedKeyContainer Algorithm="http://www.w3.org/2009/xmlenc#aes256-gcm">"
              BR (&93834781567256)
              text " "
              SPAN (&93834781567560)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<epa:Ciphertext>"
              BR (&93834781568040)
              text " "
              SPAN (&93834781568344)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text " <!--Base64-Kodiertes Ciphertext mit len(IV)=12 Byte und TagLen=16 Byte, vgl. [XMLEnc#5.2.4 AES-GCM] und [gemSpec_Krypt#"
              SPAN (&93834781568824)
                attr class "polarion-rte-link"
                attr data-custom-label "A_17872"
                attr data-scope "Mainline_OPB1"
                attr data-type "polarion"
                attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94669"
                attr id "fake"
              SPAN (&93834781570064)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text " ] -->"
              BR (&93834781570544)
              text " "
              SPAN (&93834781570848)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "</epa:Ciphertext>"
              BR (&93834781571328)
              text " "
              SPAN (&93834781571632)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<epa:AssociatedData>"
              BR (&93834781572112)
              text " "
              SPAN (&93834781572416)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "<!-- Base64-kodierte associated data (Ableitungsinformationen) -->"
              BR (&93834781572896)
              text " "
              SPAN (&93834781573200)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "</epa:AssociatedData>"
              BR (&93834781573680)
              text " "
              SPAN (&93834781573984)
                attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
                text "</epa:EncryptedKeyContainer>"
              BR (&93834781574464)
              text " "
            text " "
          text " "
        text " "
      text " "
      P (&93834781575248)
        attr id "polarion_240"
        text "Diese Daten werden dann mit dem zweiten AES-256-Schlüssel (erhalten von SGD 2) verschlüsselt und es muss wieder eine derartige Datenstruktur erzeugt werden. Jedoch müssen bei den AD nun die AD aus der ersten Verschlüsselungsschicht  (AD1) mit einbezogen werden. Dafür werden die AD1 (Base64-dekodiert) vor die Ableitungsinformationen, die durch SGD 2 hinzukommen, vorangestellt und damit zusammengefügt. Die MAC-Berechnung basiert dann auf dieser zusammengesetzten Zeichenkette. Im "<epa:AssociatedData>"-Feld werden die beiden Teile (Ableitungsinformationen von SGD 1 und Ableitungsinformationen von SGD 2) jeweils einzeln Base64-kodiert und durch Leerzeichen getrennt aufgeführt."
      text " "
      P (&93834781575848)
        attr id "polarion_138"
        text "Beispiel für ein AssociatedData einer zweiten Verschlüsselungsschicht:"
      text " "
      P (&93834781576448)
        attr id "polarion_269"
        text " "
        SPAN (&93834781576928)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "<epa:AssociatedData>"
        BR (&93834781577408)
        text " "
        SPAN (&93834781577712)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "cjI6N2Y4Zjc3MDAzZGJhYjQ5YzNhNGUzMmY0NDcyNmY5MjMyNGQyOTJmYTY2OGZkZTVlYmMzNDI0Mzk3OTg2YmU5OTpBMTIzNDU2Nzg5OjItMjBhMTIwMS0wMDE6QWt0ZW5zeXN0ZW0gYSwgU0dEMSwgQmV6ZWljaG5lciAyMDIwLTE= "
        BR (&93834781578192)
        text " "
        SPAN (&93834781578496)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "cjI6NWQ2MWQyZTExNTJiNjcxMWJlOTg0OTZjZDZmMGM5YWJkZTRjYzNiMzIwYjRiYWYxMjc2ZTU1MmFhZGU4MDkxMzpBMTIzNDU2Nzg5OjItMjBhMTIwMS0wMDE6U0dEMiBNYXN0ZXJrZXkgMjAyMC0x"
        BR (&93834781578976)
        text " "
        SPAN (&93834781579280)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "</epa:AssociatedData>"
        text " "
      text " "
      P (&93834781580000)
        attr id "polarion_270"
        text "Damit kann ein Client die Ableitungsinformationen von SGD 1 (erster Teil) und von SGD 2 (zweiter Teil) unterscheiden."
      text " "
      DIV (&93834781580600)
        attr id "A_17930"
        text " "
        P (&93834781581080)
          B (&93834781581264)
            text "A_17930 - interoperables Austauschformat Schlüsselableitungsfunktionalität ePA"
        text " "
        P (&93834781581688)
          text "Ein Client eines SGD ePA MUSS bei einer Kodierung von Akten- und Kontextschlüssel bzw. der Ver-und Entschlüsselung dieses im Kontext der Schlüsselableitungsfunktionalität ePA die in [gemSpec_SGD_ePA#"
          SPAN (&93834781581992)
            attr class "polarion-rte-link"
            attr data-item-id "ML-94583"
            attr data-option-id "longoutline"
            attr data-type "crossReference"
            attr id "fake"
          text " ] spezifizierten Formate epa:PHRKey [PHR_Common.xsd] und epa:EncryptedKeyContainer [AuthorizationService.xsd] verwenden."
          BR (&93834781583176)
          text "Der Client MUSS bei der zweiten Verschlüsselungsschicht die AD der ersten Schicht (AD 1) im AD der zweiten Schicht (AD 2) mit aufnehmen. Der Client MUSS zunächst AD 1 und dann AD 2 aufführen und beide durch mindestens ein Leerzeichen trennen. Die GMAC-Berechnung MUSS bei der zweiten Verschlüsselung über beide AD (AD1 und AD2) erfolgen (AD1 + AD2 bilden die AD für den AES-GCM)."
          B (&93834781583480)
            text "[<=]"
        text " "
      text " "
      P (&93834781584024)
        attr id "polarion_163"
        text "Beispiel: Schritt 1, im Client (bspw. ePA-FdV) liegen zufällig lokal erzeugte Akten- und Kontextschlüssel vor, welche in einer PHRKey-Datenstruktur kodiert werden. Der Versicherte habe die KVNR "A123456789"."
      text " "
      P (&93834781584624)
        attr id "polarion_182"
        text " "
        SPAN (&93834781585104)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "<?xml version="1.0" encoding="UTF-8">"
          BR (&93834781585584)
          text "<epa:PHRKey insurant="A123456789">"
          BR (&93834781585888)
          text " "
          BR (&93834781586192)
          text "    <!-- Aktenschlüssel -->"
          BR (&93834781586496)
          text "    <RecordKey algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm">"
          BR (&93834781586800)
          text "        Nj9OixvhO2JKjtYEbQe8oetiQaiennKFJmQEJXsQVQo="
          BR (&93834781587104)
          text "    </RecordKey>"
          BR (&93834781587408)
          text " "
          BR (&93834781587712)
          text "    <!-- Kontextschlüssel -->"
          BR (&93834781588016)
          text "    <ContextKey algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm">"
          BR (&93834781588320)
          text "        qyVQMtj3MwXRt8NOuQrNj3g5IPl49Ieami/+QVLzTkc="
          BR (&93834781588624)
          text "    </ContextKey>"
          BR (&93834781588928)
          text " "
          BR (&93834781589232)
          text "</epa:PHRKey>"
          BR (&93834781589536)
          text " "
        text " "
      text " "
      P (&93834781590080)
        attr id "polarion_279"
      text " "
      P (&93834781590560)
        attr id "polarion_271"
        text " "
        SPAN (&93834781591040)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Beispiel: Schritt 2, Erzeugung der ersten Verschlüsselungsschicht"
        text " "
      text " "
      P (&93834781591760)
        attr id "polarion_272"
        text " "
        SPAN (&93834781592240)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "Sei"
        text " "
      text " "
      P (&93834781592960)
        attr id "polarion_85"
        text " "
        SPAN (&93834781593440)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "3132333435363738393031323334353637383930313233343536373839303132"
        text " "
      text " "
      P (&93834781594160)
        attr id "polarion_191"
        text " "
        SPAN (&93834781594640)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "der von dem SGD 1 erhaltene hexadezimal-kodierte 256-Bit AES/GCM-Schlüssel und der verwendete Ableitungsvektor des SGD 1 sei ""
        SPAN (&93834781595120)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "r2:7f8f77003dbab49c3a4e32f44726f92324d292fa668fde5ebc3424397986be99:A123456789:2-20a1201-001:Aktensystem a, SGD1, Bezeichner 2020-1","
        text " "
        SPAN (&93834781595720)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "dann würde folgende EncryptedKeyContainer-Datenstruktur entstehen."
        text " "
      text " "
      P (&93834781596440)
        attr id "polarion_162"
        text " "
        SPAN (&93834781597000)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "<?xml version="1.0" encoding="UTF-8">"
          BR (&93834781597456)
          text "<epa:EnryptedKeyContainer algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm">"
          BR (&93834781597760)
          text "    <epa:Ciphertext>        n9G9sp+Sw1KTbKGjmugnqVyC82pUSlE8GJMq4I316zNqHPZy6/nIgXpJcZ7EI2jmHYjrLm/FyWUtbocYYUm8JQCmsWHWU+76gvJyDMwi1XsAj4fgbn/pH0/9XgDcXK905gH4IGD18Z54A3iChuwj6gGvhX5HpS54YH4QuAGiE5ZPFhlKWx2GkYvn4h5kFzM/Z0n7Lg3Txw/dpb6yp4mTGKX1KTWqt3aRUkdSQ05GR4i1PvZB8A4MDaLGo3Tgs1rD2n7ay7D3ZErulsMKK7CDjyHEWmADLBLmT+FDmu9micg+JI4jSaYXsYZYMn99HYi47D0DCUPS7fDDh1iNpkignczP44pHGbnujgnqcr/e42itRWISt0A0d2guNYAXPrrmtJTiOkYfr9Lhx9ttGRHWwcmH8j5+c+RGJdYFW55pSrGWlJ1n5DBsHqf6B+aWp6FWjH+SsQ5OBjkqGWAEggxaZlJMH8oFP+Yk5d0Zdt+TDQgA2UQynxZ/dLqthTjb67vRzWbTtbUGhxOpvdoc6APJZVuB0zjcLMpgKmF6A8SuS4UkaTvzjA40iJXDV3S2xgDmT08UfmWYwsRstifbTNcWNiKNCCFm0I8kqNZIKujv/Ws="
          BR (&93834781598064)
          text "    </epa:Ciphertext>"
          BR (&93834781598368)
          text "    <epa:AssociatedData>        cjI6N2Y4Zjc3MDAzZGJhYjQ5YzNhNGUzMmY0NDcyNmY5MjMyNGQyOTJmYTY2OGZkZTVlYmMzNDI0Mzk3OTg2YmU5OTpBMTIzNDU2Nzg5OjItMjBhMTIwMS0wMDE6QWt0ZW5zeXN0ZW0gYSwgU0dEMSwgQmV6ZWljaG5lciAyMDIwLTE="
          BR (&93834781598672)
          text "    </epa:AssociatedData>"
          BR (&93834781598976)
          text "</epa:EncryptedKeyContainer>"
          BR (&93834781599280)
          text " "
        text " "
      text " "
      P (&93834781599824)
        attr id "polarion_280"
      text " "
      P (&93834781600304)
        attr id "polarion_125"
        text "Beispiel: Schritt 3, Erzeugung der zweiten Verschlüsselungsschicht"
      text " "
      P (&93834781600904)
        attr id "polarion_273"
        text "Sei"
      text " "
      P (&93834781601504)
        attr id "polarion_287"
        text " "
        SPAN (&93834781601984)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "4132333435363738393031323334353637383930313233343536373839303132"
        text " "
      text " "
      P (&93834781602704)
        attr id "polarion_288"
        text "der v"
        SPAN (&93834781603184)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "on dem SGD 2 erhaltene hexadezimal-kodierte 256-Bit AES/GCM-Schlüssel und der verwendete Ableitungsvektor des SGD 2 sei"
          SPAN (&93834781603664)
            attr style "font-family: 'Courier New', Courier, monospace, HanWangKanTan;"
            text ""r2:5d61d2e1152b6711be98496cd6f0c9abde4cc3b320b4baf1276e552aade80913:A123456789:2-20a1201-001:SGD2 Masterkey 2020-1""
        SPAN (&93834781604144)
          attr style "font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text ","
        text " "
        SPAN (&93834781604744)
          attr style "font-size: 10pt;line-height: 1.5;"
          text "dann würde folgende EncryptedKeyContainer-Datenstruktur der zweiten Verschlüsselungsschicht entstehen."
        text " "
      text " "
      P (&93834781605464)
        attr id "polarion_52"
        text " "
        SPAN (&93834781605944)
          attr style "font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"
          text "<?xml version="1.0" encoding="UTF-8">"
          BR (&93834781606424)
          text "<epa:EnryptedKeyContainer algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm">"
          BR (&93834781606728)
          text "    <epa:Ciphertext>        wQgFhfzTeeTAYsR2JHChPoqO0In5QCa+ZnH2+0cPYtO+MAi4jfqUrHAHsj1RLqjDoEF6QdN8gjQq8x03dpsx6EJJZzwg0I8Y+c/ck+vANMNxxNclU2s5DJZQ52wGKnQVtMOIQPtNiRKv3c+YV8nMXJKKZrF+laG+4bdmeWhT9BIi1dhev+Sm9vvZQQ9/lI+o18qKWYgBje/L5f7EQEQJzG2t+zWDpPVmPZtCo+0/MKa/rZo6a20iXSeWov6FGe/7S60D4HaaYp66z9IveWH1qd80KUz8wGaI4c/ZO5qGwQBv8puBFNxm6mYPCarGsIeltwunmsh4L+bQmbIf/X/AFEfq+hu9lN7B/v3mgyk7Za+vPpTKuf9EeaC/RDr8nfQVO46Evtqj04vqPlmAI9SsCUpgiR5JwXwQwWtLABJBDr9+us1LfWq4tlIFwslllUZP1B+oSaO59bK//Hu7097mKVI4tIsA5D1/a9de9BgBZ1RblK/roKUe38cbuSFYPHNrPhScycIX3fyd6lOqX56vkvOOsS+E2rbQXUw/JipRGdoS1mhu5pQMJKgAojYm6JKHmKb0ydDopUxltX5Gsv2KMTDyRFaxcGDvavlgVV088bs8dc6UyOjWZRGtKbyNavMLCl3vClwfKyc6rsD9Wc4G4Mp2KadF63icOfePy0F234ktbDUXFiiB391to2x2u4VvTOsDBlD9A7zJYm7Xf+cK3S3J0/RgwdbabxV/eGtKcH12Xmi2RUDuIEHjF4u1CnQFREC2DAq+1gtA6Q7iVCRbESH6toNwMtd2Z/hssv+moM1NEuE3ONb+pf7z26ScTGDVKuN6WmldSi/2CvkD3j4aY38Uzu5sGGDXG0mZrDCzmPH8WntGnrInibVBRRXz0IuQIMgB56tNcPjgvBOhlWCXL92PcrbuJyhRA1mKqLYsAOkfLsXjC1es6NS7EUYb1RACVqNa8bZGqHY6snou2xa6jReH4uC7Qvx4Yr1rkTEnlahNUYUHMYGyhObef/seNxz36Ppv7+BVURe0jaD8WFA9zeQ2X3rDKPU6eU4urmgBtCVOZ1Jxd2z2twOlAx7oQQMq5wsRM2Q4RKOk28aJFcLBhIquNaXUHs6pVuHPEfUVQiyU1cGQ0Hgizj800f18sTiyX8lgFv0/WIw0ol4MUZ8jQhZ+o29bV5OBH36ebDERZJl1eRhe5nPDPJfSIvo+/LiTmlmgEIiTYtaEcWH+7Z9xrxCuE75+RLJfv5GydCsFETpMcpWcyYPP/XHj5O3jL7urpgXxYsAap8UXOkIrcsV+qhRsQG+pe3lqvGodhtkm4i7mbu3Rm9noAKB34DWUO9Sg14JGl4CxhGzhlN4bUqnVd8GYirDinqGot9MQ40tKD3sQ8d1A2qdW4weIKAeKopJ6X4t7iRAFp4ka6vqgmb1KxCXLl2hO3J1bhY8FZ1Q="
          BR (&93834781607032)
          text "    </epa:Ciphertext>"
          BR (&93834781607336)
          text "    <epa:AssociatedData>        cjI6N2Y4Zjc3MDAzZGJhYjQ5YzNhNGUzMmY0NDcyNmY5MjMyNGQyOTJmYTY2OGZkZTVlYmMzNDI0Mzk3OTg2YmU5OTpBMTIzNDU2Nzg5OjItMjBhMTIwMS0wMDE6QWt0ZW5zeXN0ZW0gYSwgU0dEMSwgQmV6ZWljaG5lciAyMDIwLTE= cjI6NWQ2MWQyZTExNTJiNjcxMWJlOTg0OTZjZDZmMGM5YWJkZTRjYzNiMzIwYjRiYWYxMjc2ZTU1MmFhZGU4MDkxMzpBMTIzNDU2Nzg5OjItMjBhMTIwMS0wMDE6U0dEMiBNYXN0ZXJrZXkgMjAyMC0x"
          BR (&93834781607640)
          text "    </epa:AssociatedData>"
          BR (&93834781607944)
          text "</epa:EncryptedKeyContainer>"
          BR (&93834781608248)
          text " "
        text " "
      text " "
      P (&93834781608792)
        attr id "polarion_281"
      text " "
      P (&93834781609272)
        attr id "polarion_289"
        text "Hinweis: in der Beispiel-Implementierung der Außenschnittstelle (vgl. Abschnitt"
        SPAN (&93834781609752)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94553"
          attr data-option-id "shortoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") gibt es auch Beispiel-Code für das interoperable Austauschformat."
      text " "
      H2 (&93834781611232)
        attr id "9"
        text "9 Datenkanal zwischen Client und SGD (informativ)"
      text " "
      P (&93834781611832)
        attr id "polarion_176"
        text "Wie in Abschnitt ""
        SPAN (&93834781612312)
          attr class "polarion-rte-link"
          attr data-item-id "ML-94707"
          attr data-option-id "longoutline"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text "" erwähnt, ist es notwendig, die fachlichen Abläufe für das SGD-HSM so einfach wie möglich zu gestalten. Einerseits kann man so die notwendige Performanz erreichen und andererseits wird damit der zeitliche Aufwand für die Entwicklung und Sicherheitsüberprüfung ("
        SPAN (&93834781613672)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17907"
          attr data-item-id "ML-94708"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") des SGD-HSM-Firmwaremoduls deutlich reduziert."
      text " "
      P (&93834781615328)
        attr id "polarion_274"
        text "Das SGD-HSM erbringt den Hauptteil der Sicherheitsleistung, wobei eine unbemerkte Manipulation des Betreibers mit hoher Sicherheit ausgeschlossen werden kann. "
      text " "
      P (&93834781615928)
        attr id "polarion_275"
        text "Ziel der Datenübertragung zwischen Client und SGD ist es, einen beidseitig authentisierten Ende-zu-Ende-verschlüsselten Kanal zwischen Client und SGD-HSM zu erzeugen. Auf diesem Kanal wird dann die authentisierte Anfrage nach einer Schlüsselableitung vom Client an das SGD-HSM gesendet."
      text " "
      P (&93834781616528)
        attr id "polarion_203"
        text "Weil ein SGD-HSM alle 15 Minuten ein neues ECIES-Schlüsselpaar erzeugt (und per Signatur bestätigt"
        SPAN (&93834781617008)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17910-01"
          attr data-item-id "ML-109449"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text "  (S1)) und der Hashwert des öffentlichen Schlüssels des ECIES-Schlüssels des SGD-HSMs in die Client-Signatur für den öffentlichen ECIES-Client-Schlüssel nach "
        SPAN (&93834781618544)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17900"
          attr data-item-id "ML-94700"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " mit eingeht, kann ein SGD-HSM sich über eine ausreichende Frische (vgl. [Boyd-Mathuria-2003#Abschnitt "1.5 Freshness"]) der Client-Anfrage sicher sein. Insbesondere kann ein SGD-HSM davon ausgehen, dass die für die Signatur mittels des AUT-Materials beim Client notwendige Kontrolle über den privaten AUT-Schlüssel im Client vorhanden war."
      text " "
      H3 (&93834781620200)
        attr id "9.1"
        text "9.1 Ablauf Kommunikation zwischen Client und SGD-HSM"
      text " "
      P (&93834781620800)
        attr id "polarion_212"
        text "Ein Client sendet über das HTTPS-Interface des SGD Requests an einen SGD. Falls der Client ein ePA-FdV ist, werden die (in den wesentlichen Teilen verschlüsselten) Request über das ZGdV getunnelt. Zwischen Client und SGD-HSM gibt es auf Applikationsebene eine beidseitig authentisierte und verschlüsselte Datenverbindung. Um dies zu erreichen, führt ein Client die in diesem Abschnitt aufgeführten Schritte durch."
      text " "
      P (&93834781621400)
        attr id "polarion_295"
        text "Zunächst erfragt der Client den aktuellen signierten öffentlichen ECIES-Schlüssel bei SGD 1."
      text " "
      P (&93834781622000)
        attr id "polarion_296"
        text "Ein SGD-HSM generiert unabhängig vom konkreten Request alle 15 Minuten ein neues ECIES-Schlüsselpaar ("
        SPAN (&93834781622480)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17914-01"
          attr data-item-id "ML-109450"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ) für die Absicherung der späteren Transportverschlüsselung zwischen Client und SGD-HSM. Der öffentliche ECIES-Schlüssel wird vom SGD-HSM signiert ("
        SPAN (&93834781624016)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17914-01"
          attr data-item-id "ML-109450"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " ) und an die RVE übergeben ("
        SPAN (&93834781625552)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17914-01"
          attr data-item-id "ML-109450"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "workItem"
          attr id "fake"
        text " )."
      text " "
      TABLE (&93834781627208)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=295"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834781627864)
          text " "
          TR (&93834781628168)
            text " "
            TH (&93834781628472)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 17px;height: 33px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834781628832)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Nr."
            text " "
            TH (&93834781629432)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 226px;height: 33px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789588352)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Client"
            text " "
            TH (&93834789588952)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 426px;height: 33px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789589312)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "RVE des SGD"
            text " "
            TH (&93834789589912)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 32px;height: 33px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789590272)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "SGD-HSM"
              BR (&93834789590752)
              text " "
            text " "
          text " "
          TR (&93834789591296)
            text " "
            TD (&93834789591600)
              attr style "vertical-align: top;width: 17px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789591960)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "1"
            text " "
            TD (&93834789592560)
              attr style "vertical-align: top;width: 226px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789592920)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Aufruf von Operation GetPublicKey bei dem der Client das AUT-Zertifikats des Nutzers mitliefert ("
                SPAN (&93834789593400)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17897"
                  attr data-item-id "ML-94694"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ). "
              BR (&93834789594936)
              text " "
            text " "
            TD (&93834789595360)
              attr style "vertical-align: top;width: 426px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789595720)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die RVE wählt ein SGD-HSM für den Client/Nutzer aus und liefert dafür den aktuellen signierten SGD-HSM-ECIES-Schlüssel (A_17895-*). Die RVE prüft unabhängig davon das AUT-Zertifikat des Nutzers ("
                SPAN (&93834789596200)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17896"
                  attr data-item-id "ML-94695"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ), das Ergebnis wird später verwendet."
              BR (&93834789597736)
              text " "
            text " "
            TD (&93834789598160)
              attr style "vertical-align: top;width: 32px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834789598760)
            text " "
            TD (&93834789599064)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789599424)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "2"
            text " "
            TD (&93834789600024)
              attr style "vertical-align: top;width: 226px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789600384)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client prüft den erhaltenen signierten SGD-HSM-ECIES-Schlüssel: Zertifikatsprüfung und Signaturprüfung ("
                SPAN (&93834789600864)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18024"
                  attr data-item-id "ML-96280"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")"
            text " "
            TD (&93834789602520)
              attr style "vertical-align: top;width: 426px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834789603000)
              attr style "vertical-align: top;width: 32px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
        text " "
      text " "
      P (&93834789603840)
        attr id "polarion_297"
        text "Der Client erfragt parallel ("
        SPAN (&93834789604320)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17925"
          attr data-item-id "ML-94728"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") analog bei SDG 2 den aktuellen ECIES-Schlüssel des für ihn avisierten SGD-HSMs innerhalb von SGD 2. Sind beide ECIES-Schlüssel erfolgreich geprüft ("
        SPAN (&93834789605856)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18024"
          attr data-item-id "ML-96280"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ), kann der Client fortfahren. Er fragt beide SGD, parallel ("
        SPAN (&93834789607392)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17925"
          attr data-item-id "ML-94728"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text ") wie folgt an."
      text " "
      P (&93834789609048)
        attr id "polarion_294"
        text "Der Client erzeugt ein ECIES-Schlüsselpaar, das er für die Request an beide SDG verwendet ("
        SPAN (&93834789609528)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18032"
          attr data-item-id "ML-96291"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " )."
      text " "
      TABLE (&93834789611184)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=298"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834789611840)
          text " "
          TR (&93834789612144)
            text " "
            TH (&93834789612448)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 17px;height: 10px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789612808)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Nr."
            text " "
            TH (&93834789613408)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 208px;height: 10px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789613768)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Client"
            text " "
            TH (&93834789614368)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 330px;height: 10px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789614728)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "RVE SGD"
            text " "
            TH (&93834789615328)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 146px;height: 10px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789615688)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SGD-HSM"
            text " "
          text " "
          TR (&93834789616408)
            text " "
            TD (&93834789616712)
              attr style "vertical-align: top;width: 17px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789617072)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "3"
              BR (&93834789617552)
              text " "
            text " "
            TD (&93834789617976)
              attr style "vertical-align: top;width: 208px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789618336)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client berechnet die Hashwerte der beiden öffentlichen SGD-HSM-Schlüssel (notwendig für "
                SPAN (&93834789618816)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17901"
                  attr data-item-id "ML-94728"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " und  "
                SPAN (&93834789620352)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17900"
                  attr data-item-id "ML-94700"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
              BR (&93834789671080)
              text " "
            text " "
            TD (&93834789671504)
              attr style "vertical-align: top;width: 330px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834789671984)
              attr style "vertical-align: top;width: 146px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834789672584)
            text " "
            TD (&93834789672888)
              attr style "vertical-align: top;width: 17px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789673248)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "4"
              BR (&93834789673728)
              text " "
            text " "
            TD (&93834789674152)
              attr style "vertical-align: top;width: 208px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789674512)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client erzeugt mittels des öffentlichen Schlüssels seines Client-ECIES-Schlüsselpaares ("
                SPAN (&93834789674992)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18032"
                  attr data-item-id "ML-96291"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ) und den zwei Hashwerten aus Schritt 3 eine Kodierung nach "
                SPAN (&93834789676528)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17900"
                  attr data-item-id "ML-94700"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " und signiert diese Kodierung ("
                SPAN (&93834789678064)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17901"
                  attr data-item-id "ML-94701"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
              BR (&93834789679600)
              text " "
            text " "
            TD (&93834789680024)
              attr style "vertical-align: top;width: 330px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834789680504)
              attr style "vertical-align: top;width: 146px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834789681104)
            text " "
            TD (&93834789681408)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789681768)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "5"
              BR (&93834789682248)
              text " "
            text " "
            TD (&93834789682672)
              attr style "vertical-align: top;width: 208px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789683032)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client erzeugt einen Request (A_18025-*) für die Operation GetAuthenticationToken ("
                SPAN (&93834789683512)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")."
                BR (&93834789685048)
                text "Dafür muss der Client einen 256-Zufallswert (als Challenge für das SGD-HSM) erzeugen (A_18025-*)."
            text " "
            TD (&93834789685472)
              attr style "vertical-align: top;width: 330px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789685832)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die RVE nimmt den Request entgehen ("
                SPAN (&93834789686312)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "), prüft das Client-Zertifikat ("
                SPAN (&93834789687848)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")  und den ECIES-Clientschlüssel (inkl. Signaturprüfung) ("
                SPAN (&93834789689384)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und verwendet ggf. Ergebnisse aus der Zertifikatsprüfung aus dem GetPublicKey-Request ("
                SPAN (&93834789690920)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17896"
                  attr data-item-id "ML-94695"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ). Die RVE prüft die Client-Signatur ("
                SPAN (&93834789692456)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")  und bereitet den Request für das SGD-HSM (Innenschnittstelle) auf ("
                SPAN (&93834789693992)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17908-01"
                  attr data-item-id "ML-109359"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text " ) und übergibt den Request an das SGD-HSM ("
                SPAN (&93834789695528)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "und A_18026-*)."
                BR (&93834789697064)
                text "Weil die RVE den Client-ECIES-Schlüssel, inkl. Signatur und das AUT-Zertifikat im Klartext sieht, kann die RVE DoS-Gegenmaßnahmen umsetzen ("
                SPAN (&93834789697368)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17891"
                  attr data-item-id "ML-94689"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
            text " "
            TD (&93834789699024)
              attr style "vertical-align: top;width: 146px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834789699384)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das SGD-HSM prüft den Request (A_18026-*). Dann das Client-Zertifikat (A_18026-* und "
                SPAN (&93834789699864)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17919-01"
                  attr data-item-id "ML-109357"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text " )."
                BR (&93834789701400)
                text "Dann die Signatur des öffentlichen ECIES-Schlüssels des Clients ("
                SPAN (&93834789701704)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18027"
                  attr data-item-id "ML-96284"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
                BR (&93834778214872)
                text "Es entschlüsselt das Chiffrat. Dort prüft es, ob eine Challenge vorliegt, also ein 256-Bit Wert vom Client."
            text " "
          text " "
        text " "
      text " "
      P (&93834778215656)
        attr id "polarion_299"
        text "Ein Client kann sich sicher sein, dass nur das angefragte SGD-HSM seine Nachricht und damit die Challenge entschlüsseln kann (gemeinsames Geheimnis). Das SGD-HSM entschlüsselt die Nachricht. An dieser Stelle weiß das SGD-HSM noch nicht, ob die Challenge auch von dem im Request (dort im AUT-Zertifikat) behaupteten Kommunikationspartner kommt – mit wem er genau also dieses gemeinsame Geheimnis teilt. Das SGD-HSM nimmt zunächst an, dass die Angaben stimmen. Es erzeugt ein Authentisierungstoken (A_18026-*). Das Authentisierungstoken ist spezifisch für das AUT-Zertifikat und den öffentlichen Client-ECIES-Schlüssel inkl. Hashwerte (Kodierung nach"
        SPAN (&93834778216136)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17900"
          attr data-item-id "ML-94700"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " ). Das SGD-HSM bildet den Hashwert aus der Kodierung und dem präsentierten AUT-Zertifikat. Das SGD-HSM bildet die Antwort gemäß A_18026-*  "
      text " "
      OL (&93834778217792)
        attr id "polarion_66"
        text " "
        LI (&93834778218272)
          text "mit dem Challenge-Wert (gemeinsames Geheimnis),"
        text " "
        LI (&93834778218696)
          text "dem eben erzeugten Hashwert und"
        text " "
        LI (&93834778219120)
          text "dem Authentisierungstoken."
        text " "
      text " "
      P (&93834778219664)
        attr id "polarion_172"
        text "Diese Antwort verschlüsselt das SGD-HSM für den Client-ECIES-Schlüssel. Das SGD-HSM kann sich sicher sein, dass nur der Empfänger, also derjenige der privaten Client-ECIES-Schlüssel besitzt, die Nachricht entschlüsseln kann."
      text " "
      P (&93834778220264)
        attr id "polarion_135"
        text "Der Client kann als einziger diese Antwort entschlüsseln. Er prüft, ob seine Challenge (gemeinsames Geheimnis) in der Antwort enthalten ist. Falls ja kann die Antwort nur vom SGD-HSM kommen. Der Client fügt den kodierten Client-ECIES-Schlüssel (vgl. in der Antwort aufgeführten Wert übereinstimmt (Hashwert,   ). Falls alle Prüfungen erfolgreich waren, kann der Client das in der Antwort aufgeführte Authentisierungstoken verwenden."
      text " "
      P (&93834778220864)
        attr id "polarion_302"
      text " "
      TABLE (&93834778221344)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=302"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834778222000)
          text " "
          TR (&93834778222304)
            text " "
            TH (&93834778222608)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 17px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778222968)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Nr."
              BR (&93834778223448)
              text " "
            text " "
            TH (&93834778223872)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 195px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778224232)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Client"
              BR (&93834778224712)
              text " "
            text " "
            TH (&93834778225136)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 260px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778225496)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "RVE SGD"
              BR (&93834778225976)
              text " "
            text " "
            TH (&93834778226400)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 229px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778226760)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SGD-HSM"
              BR (&93834778227240)
              text " "
            text " "
          text " "
          TR (&93834778227784)
            text " "
            TD (&93834778228088)
              attr style "vertical-align: top;width: 17px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778228448)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "6"
              BR (&93834778228928)
              text " "
            text " "
            TD (&93834778229352)
              attr style "vertical-align: top;width: 195px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778229832)
              attr style "vertical-align: top;width: 260px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778230312)
              attr style "vertical-align: top;width: 229px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778230672)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "(Fortsetzung von Schritt 5)"
                BR (&93834778231152)
                text "Das SGD-HSM erzeugt den Hashwert aus dem öffentlichen Client-ECIES-Schlüssel (Kodierung nach "
                SPAN (&93834778231456)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17900"
                  attr data-item-id "ML-94700"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und dem AUT-Zertifikat des Nutzers des Clients. Das SGD-HSM erzeugt ein Authentisierungstoken, das für den Client-Schlüssel und das AUT-Zertifikat spezifisch ist."
              BR (&93834778232992)
              text " "
            text " "
          text " "
          TR (&93834778233536)
            text " "
            TD (&93834778233840)
              attr style "vertical-align: top;width: 17px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778234200)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "7"
              BR (&93834778234680)
              text " "
            text " "
            TD (&93834778235104)
              attr style "vertical-align: top;width: 195px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778235584)
              attr style "vertical-align: top;width: 260px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778236064)
              attr style "vertical-align: top;width: 229px;height: 38pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778236424)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das SGD-HSM erzeugt eine Antwort mit dem Zufallswert (Challenge) des Clients, mit Hashwert aus Client-ECIES-Schlüssel und AUT-Zertifikat und Authentisierungstoken. Es verschlüsselt diese Antwort für den öffentlichen Client-ECIES-Schlüssel ( A_18026-*, [gemSpec_Krypt#"
                SPAN (&93834778236904)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17875"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
                  attr id "fake"
                text "]) und übergibt das Chiffrat an die RVE zur Weiterleitung."
              BR (&93834778238264)
              text " "
            text " "
          text " "
          TR (&93834778238808)
            text " "
            TD (&93834778239112)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778239472)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "8"
              BR (&93834778239952)
              text " "
            text " "
            TD (&93834778240376)
              attr style "vertical-align: top;width: 195px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778240856)
              attr style "vertical-align: top;width: 260px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778241216)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die RVE nimmt die Antwort vom SGD-HSM entgegen und kodiert das Chiffrat gemäß"
                SPAN (&93834778241696)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17902"
                  attr data-item-id "ML-94703"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ("
                SPAN (&93834778243232)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und schickt es als Response an den Client."
              BR (&93834778244768)
              text " "
            text " "
            TD (&93834778245192)
              attr style "vertical-align: top;width: 229px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834778245792)
            text " "
            TD (&93834778246096)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778246456)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "9"
              BR (&93834778246936)
              text " "
            text " "
            TD (&93834778247384)
              attr style "vertical-align: top;width: 195px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778247744)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client nimmt die Response entgegen und entschlüsselt die verschlüsselte Nachricht vom SGD-HSM ("
                SPAN (&93834778248224)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18028"
                  attr data-item-id "ML-96285"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ", [gemSpec_Krypt#"
                SPAN (&93834778249760)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17875"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "polarion"
                  attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
                  attr id "fake"
                text "])."
                BR (&93834778251120)
                text "Er prüft, ob in der entschlüsselten Response sein Zufallswert (Challenge) aufgeführt ist. Falls ja kann sich der Client nun sicher sein, dass die Antwort vom SGD-HSM kommt."
                BR (&93834778251424)
                text "Er prüft, ob der in der Nachricht aufgeführter Hashwert aus öffentlichen Client-ECIES-Schlüssel gemäß "
                SPAN (&93834778251728)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17900"
                  attr data-item-id "ML-94700"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "  und AUT-Zertifikat mit seinen lokal selbst erzeugten Hashwert übereinstimmt."
                BR (&93834778253264)
                text "Falls alle Prüfungen erfolgreich waren kann er das in der Nachricht aufgeführte Authentisierungstoken weiter verwenden ("
                SPAN (&93834778253568)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18028"
                  attr data-item-id "ML-96285"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")."
              BR (&93834778255104)
              text " "
            text " "
            TD (&93834778255528)
              attr style "vertical-align: top;width: 260px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778256008)
              attr style "vertical-align: top;width: 229px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834778256608)
            text " "
            TD (&93834778256912)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778257272)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "10"
              BR (&93834778257752)
              text " "
            text " "
            TD (&93834778258176)
              attr style "vertical-align: top;width: 195px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778258536)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client erzeugt eine Anfrage für eine Schlüsselableitung und verwendet dabei das erhaltene Authentisierungstoken ("
                SPAN (&93834778259016)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18029"
                  attr data-item-id "ML-96286"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und eine pro Anfrage zufällig erzeugte Request-ID. Er sendet diese Anfrage an den SGD."
            text " "
            TD (&93834778260672)
              attr style "vertical-align: top;width: 260px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778261032)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die RVE nimmt den Request entgehen ("
                SPAN (&93834778261512)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17898"
                  attr data-item-id "ML-94696"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ), prüft das Client-Zertifikat ("
                SPAN (&93834778263048)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17898"
                  attr data-item-id "ML-94696"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und den Client-ECIES-Schlüssel inkl. Signaturprüfung ("
                SPAN (&93834778264584)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17898"
                  attr data-item-id "ML-94696"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und verwendet ggf. Ergebnisse aus der Zertifikatsprüfung aus dem GetPublicKey-Request ("
                SPAN (&93834778266120)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17896"
                  attr data-item-id "ML-94695"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "). Die RVE prüft die Client-Signatur ("
                SPAN (&93834778267656)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17898"
                  attr data-item-id "ML-94696"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")  und bereitet den Request für das SGD-HSM (Innenschnittstelle) auf ("
                SPAN (&93834778269192)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17908-01"
                  attr data-item-id "ML-109359"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text " ) und übergibt den Request an das SGD-HSM ("
                SPAN (&93834778270728)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18021"
                  attr data-item-id "ML-96275"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "und A_18026-*)."
                BR (&93834778272264)
                text "Weil die RVE den Client-ECIES-Schlüssel, inkl. Signatur und das AUT-Zertifikat im Klartext sieht, kann die RVE DoS-Gegenmaßnahmen umsetzen ("
                SPAN (&93834778272568)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17891"
                  attr data-item-id "ML-94689"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ")."
            text " "
            TD (&93834778274224)
              attr style "vertical-align: top;width: 229px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778274584)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Das SGD-HSM führt Client-ECIES-Schlüssel und AUT-Zertifikat in einer Schlüsselableitung mit seinem aktuellen spezifischen geheimen Ableitungsschlüssel ("
                SPAN (&93834778275064)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17910-01"
                  attr data-item-id "ML-109449"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "workItem"
                  attr id "fake"
                text "  (S5)) zusammen ("
                SPAN (&93834778276600)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18030"
                  attr data-item-id "ML-96287"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und prüft ("
                SPAN (&93834778278136)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18030"
                  attr data-item-id "ML-96287"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "), ob der in der Nachricht des Clients präsentierte Authentisierungstoken korrekt ist."
            text " "
          text " "
          TR (&93834778279912)
            text " "
            TD (&93834778280288)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778280624)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "11"
              BR (&93834778281104)
              text " "
            text " "
            TD (&93834778281528)
              attr style "vertical-align: top;width: 195px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778282008)
              attr style "vertical-align: top;width: 260px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778282488)
              attr style "vertical-align: top;width: 229px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778282848)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Wenn das Authentisierungstoken korrekt ist, dann analysiert das SGD-HSM die Ableitungsanfrage ("
                SPAN (&93834778283328)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17922"
                  attr data-item-id "ML-94727"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und führt sie je nach Ableitungsregel aus (ggf. auch nicht)."
                BR (&93834778284864)
                text "Im Positivfall erzeugt das SGD-HSM eine für den Client verschlüsselte Nachricht mit dem Ergebnis der Ableitung ("
                SPAN (&93834778285168)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17922"
                  attr data-item-id "ML-94727"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text "), inkl. Authentisierungstoken und Request-ID."
            text " "
          text " "
          TR (&93834778286944)
            text " "
            TD (&93834778287248)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778287608)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "12"
              BR (&93834778288088)
              text " "
            text " "
            TD (&93834778288512)
              attr style "vertical-align: top;width: 195px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778288992)
              attr style "vertical-align: top;width: 260px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778289352)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Die RVE nimmt die Antwort vom SGD-HSM entgegen und kodiert das Chiffrat gemäß"
                SPAN (&93834778289832)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17902"
                  attr data-item-id "ML-94703"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ("
                SPAN (&93834778291368)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_17898"
                  attr data-item-id "ML-94696"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text ") und schickt es als Response an den Client."
            text " "
            TD (&93834778293024)
              attr style "vertical-align: top;width: 229px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
          TR (&93834778293624)
            text " "
            TD (&93834778293928)
              attr style "vertical-align: top;width: 17px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778294288)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "13"
              BR (&93834778294768)
              text " "
            text " "
            TD (&93834778295192)
              attr style "vertical-align: top;width: 195px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778295552)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Der Client entschlüsselt die Antwort ("
                SPAN (&93834778296032)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18031-01"
                  attr data-item-id "ML-102757"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " ). Er prüft, ob der in das Antwort aufgeführte Authentisierungstoken und die Request-ID mit beiden in dem Request verwendeten Werten übereinstimmt. Falls nein, so muss der Client die erhaltenen Schlüssel verwerfen ("
                SPAN (&93834778297568)
                  attr class "polarion-rte-link"
                  attr data-custom-label "A_18031-01"
                  attr data-item-id "ML-102757"
                  attr data-option-id "custom"
                  attr data-scope "Mainline_OPB1"
                  attr data-type "crossReference"
                  attr id "fake"
                text " )."
            text " "
            TD (&93834778299224)
              attr style "vertical-align: top;width: 260px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
            TD (&93834778299704)
              attr style "vertical-align: top;width: 229px;height: 12pt;border: 1px solid #CCCCCC;padding: 4pt;"
            text " "
          text " "
        text " "
      text " "
      P (&93834778300544)
        attr id "polarion_303"
        text "Die Schritte 3 bis 13 führt ein Client dann parallel für beide SGD aus."
      text " "
      H3 (&93834778301144)
        attr id "9.2"
        text "9.2 ECIES-Verfahren"
      text " "
      P (&93834778301744)
        attr id "polarion_147"
        text "Das "Elliptic Curve Integrated Encryption Scheme (ECIES)" ist ein auf [ABR-1999] basierendes hybrides Verschlüsselungsverfahren (vgl. auch [SEC1-2009], [TR-02102-1]). Das Verfahren liefert eine einseitig authentisierte Verschlüsselung. Eine Änderung am Chiffrat wird vom Empfänger sicher erkannt (CCA2-sicher). Der Empfänger kann auf Grundlage des ECIES-Verfahrens allein nicht erkennen von wem das Chiffrat erzeugt wurde, nur dass es beim Transport nicht verändert wurde. Der Sender kann sich sicher sein, dass nur der Empfänger das Chiffrat entschlüsseln kann. Für das ECIES-Verfahren gilt die kryptographische Sicherheitsbetrachtung (Sicherheitsbeweis) aus [ABR-1999]."
      text " "
      P (&93834778302344)
        attr id "polarion_300"
        text "Der Sender muss ein ECC-Schlüsselpaar besitzen, dessen Authentizität der Empfänger prüfen kann ("
        SPAN (&93834778302824)
          attr class "polarion-rte-link"
          attr data-custom-label "A_18024"
          attr data-item-id "ML-96280"
          attr data-option-id "custom"
          attr data-scope "Mainline_OPB1"
          attr data-type "crossReference"
          attr id "fake"
        text " und A_18026-*"
      text " "
      P (&93834778304480)
        attr id "polarion_277"
        text "). Der Empfänger erzeugt für jede Nachricht ein ephemeres ECC-Schlüsselpaar ([gemSpec_Krypt#"
        SPAN (&93834778304960)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17875"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
          attr id "fake"
        text "Punkt 1]) . Mit dem Schlüsselpaar und den authentischen öffentlichen ECC-Punkts des Empfänger führt der Sender einen einseitig authentisierten ECDH durch [gemSpec_Krypt#"
        SPAN (&93834778306320)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17875"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
          attr id "fake"
        text "Punkt 2]. Aus dem erzeugten ECDH-Geheimnis leitet der Sender über eine KDF gemäß [gemSpec_Krypt#"
        SPAN (&93834778307680)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17875"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
          attr id "fake"
        text "Punkt 3] einen 256-Schlüssel ab. Diesen Schlüssel verwendet der Sender mittels AES-GCM gemäß [gemSpec_Krypt#"
        SPAN (&93834778309040)
          attr class "polarion-rte-link"
          attr data-custom-label "A_17875"
          attr data-scope "Mainline_OPB1"
          attr data-type "polarion"
          attr data-url "/wiki/Spezifikation/gemSpec_Krypt?selection=ML-94672"
          attr id "fake"
        text "Punkt 4] um die Nachricht zu verschlüsseln. Da AES-GCM ein authentisiertes Verschlüsselungsverfahren ist, kann man Änderungen beim Transport des Chiffrats (ICV-Wert) sicher erkennen. Ob ein aktiver Angreifer auf der Transportstrecken das Chiffrat verworfen und selbst ein neues erzeugt hat, kann das Verfahren nicht feststellen."
      text " "
      P (&93834778310520)
        attr id "polarion_301"
        text "Das ECIES-Verfahren wird üblicherweise bei der ECC-basierten E-Mail-Verschlüsselung eingesetzt, so dass man aus kryptographischer Sicht formulieren könnte: Client und SGD-HSM senden sich im Rahmen der Schlüsselableitungsfunktionalität ePA vier verschlüsselte E-Mails pro Schlüsselableitung."
      text " "
      H2 (&93834778311120)
        attr id "10"
        text "10 Anhang – Verzeichnisse"
      text " "
      H3 (&93834778311720)
        attr id "10.1"
        text "10.1 Abkürzungen"
      text " "
      TABLE (&93834778312320)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=1"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834778313072)
          text " "
          TR (&93834778313376)
            text " "
            TH (&93834778313680)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 71pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778314016)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Kürzel"
            text " "
            TH (&93834778314616)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 365pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778314976)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Erläuterung"
            text " "
          text " "
          TR (&93834778315696)
            text " "
            TD (&93834778316000)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778316360)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "AD"
              BR (&93834778316840)
              text " "
            text " "
            TD (&93834778317264)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778317624)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Associated Data (vgl. [RFC-5116])"
              BR (&93834778318104)
              text " "
            text " "
          text " "
          TR (&93834778318648)
            text " "
            TD (&93834778318952)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778319312)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "AAD"
              BR (&93834778319792)
              text " "
            text " "
            TD (&93834778320216)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778320576)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Additional Authenticated Data (vgl. [NIST-SP-800-38D]), fachlich identisch zu "AD" (s. o.)"
              BR (&93834778321056)
              text " "
            text " "
          text " "
          TR (&93834778321600)
            text " "
            TD (&93834778321904)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778322264)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "AEAD"
              BR (&93834778322744)
              text " "
            text " "
            TD (&93834778323168)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778323528)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Authenticated Encryption with Associated Data (AEAD)"
              BR (&93834778324008)
              text " "
            text " "
          text " "
          TR (&93834778324552)
            text " "
            TD (&93834778324856)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778325216)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "AES"
              BR (&93834778325696)
              text " "
            text " "
            TD (&93834778326120)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778326480)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Advanced Encryption Standard"
              BR (&93834778326960)
              text " "
            text " "
          text " "
          TR (&93834778327504)
            text " "
            TD (&93834778327808)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778328168)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "AES-256"
              BR (&93834778328648)
              text " "
            text " "
            TD (&93834778329072)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778329432)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "AES mit 256 Bit Schlüssellänge"
              BR (&93834778329912)
              text " "
            text " "
          text " "
          TR (&93834778330456)
            text " "
            TD (&93834778330760)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778331120)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ECC"
              BR (&93834778331600)
              text " "
            text " "
            TD (&93834778332024)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778332384)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Elliptic Curve Cryptography"
              BR (&93834778332864)
              text " "
            text " "
          text " "
          TR (&93834778333408)
            text " "
            TD (&93834778333712)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778334072)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ECDH"
              BR (&93834778334552)
              text " "
            text " "
            TD (&93834778334976)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778335336)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Elliptic Curve Diffie Hellman (key exchange)"
              BR (&93834778335816)
              text " "
            text " "
          text " "
          TR (&93834778336360)
            text " "
            TD (&93834778336664)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778337024)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA"
              BR (&93834778337504)
              text " "
            text " "
            TD (&93834778337928)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778338288)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "elektronische Patientenakte"
              BR (&93834778338768)
              text " "
            text " "
          text " "
          TR (&93834778339312)
            text " "
            TD (&93834778339616)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778339976)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA-FdV"
              BR (&93834778340456)
              text " "
            text " "
            TD (&93834778340880)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778341240)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ePA-Frontend des Versicherten"
              BR (&93834778341720)
              text " "
            text " "
          text " "
          TR (&93834778342264)
            text " "
            TD (&93834778342568)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778342928)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "FAD"
              BR (&93834778343408)
              text " "
            text " "
            TD (&93834778343832)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834778344192)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Fachanwendungsspezifischer Dienst"
              BR (&93834778344672)
              text " "
            text " "
          text " "
          TR (&93834778345216)
            text " "
            TD (&93834778345520)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802436384)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "FM ePA"
              BR (&93834802436864)
              text " "
            text " "
            TD (&93834802437288)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802437648)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Fachmodul ePA"
              BR (&93834802438128)
              text " "
            text " "
          text " "
          TR (&93834802438672)
            text " "
            TD (&93834802438976)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802439336)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "GCM"
              BR (&93834802439816)
              text " "
            text " "
            TD (&93834802440240)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802440600)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Galois/Counter Mode"
              BR (&93834802441080)
              text " "
            text " "
          text " "
          TR (&93834802441624)
            text " "
            TD (&93834802441928)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802442288)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "HKDF"
              BR (&93834802442768)
              text " "
            text " "
            TD (&93834802443192)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802443552)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "HMAC-based Key Derivation Function"
              BR (&93834802444032)
              text " "
            text " "
          text " "
          TR (&93834802444576)
            text " "
            TD (&93834802444880)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802445240)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "HMAC"
              BR (&93834802445720)
              text " "
            text " "
            TD (&93834802446144)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802446504)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Hash-based Message Authentication Code"
              BR (&93834802446984)
              text " "
            text " "
          text " "
          TR (&93834802447528)
            text " "
            TD (&93834802447832)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802448192)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "HSM"
              BR (&93834802448672)
              text " "
            text " "
            TD (&93834802449096)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802449456)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Hardware Security Module"
              BR (&93834802449936)
              text " "
            text " "
          text " "
          TR (&93834802450480)
            text " "
            TD (&93834802450784)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802451144)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "HTTPS"
              BR (&93834802451624)
              text " "
            text " "
            TD (&93834802452048)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802452408)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Hypertext Transfer Protocol Secure (HTTP über TLS)"
              BR (&93834802452888)
              text " "
            text " "
          text " "
          TR (&93834802453432)
            text " "
            TD (&93834802453736)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802454096)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ICV"
              BR (&93834802454576)
              text " "
            text " "
            TD (&93834802455000)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802455360)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Integrity Check Value"
              BR (&93834802455840)
              text " "
            text " "
          text " "
          TR (&93834802456384)
            text " "
            TD (&93834802456688)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802457048)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "IV"
              BR (&93834802457528)
              text " "
            text " "
            TD (&93834802457952)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802458312)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Initialization Vector"
              BR (&93834802458792)
              text " "
            text " "
          text " "
          TR (&93834802459336)
            text " "
            TD (&93834802459640)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802460000)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "KVNR"
              BR (&93834802460480)
              text " "
            text " "
            TD (&93834802460904)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802461264)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Krankenversichertennummer"
              BR (&93834802461744)
              text " "
            text " "
          text " "
          TR (&93834802462288)
            text " "
            TD (&93834802462592)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802462952)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "LEI"
              BR (&93834802463432)
              text " "
            text " "
            TD (&93834802463856)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802464216)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Leistungserbringerinstitution"
              BR (&93834802464696)
              text " "
            text " "
          text " "
          TR (&93834802465240)
            text " "
            TD (&93834802465544)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802465904)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "PCRE"
              BR (&93834802466384)
              text " "
            text " "
            TD (&93834802466808)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802467168)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Perl Compatible Regular Expressions"
              BR (&93834802467648)
              text " "
            text " "
          text " "
          TR (&93834802468192)
            text " "
            TD (&93834802468496)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802469016)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "RSA"
              BR (&93834802469344)
              text " "
            text " "
            TD (&93834802469768)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802470128)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Rivest-Shamir-Adleman (asymmetrisches Kryptoverfahren)"
              BR (&93834802470608)
              text " "
            text " "
          text " "
          TR (&93834802471152)
            text " "
            TD (&93834802471456)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802471816)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "RVE"
              BR (&93834802472296)
              text " "
            text " "
            TD (&93834802472720)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802473080)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Request verarbeitende Einheit"
              BR (&93834802473560)
              text " "
            text " "
          text " "
          TR (&93834802474104)
            text " "
            TD (&93834802474408)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802474768)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SGD"
              BR (&93834802475248)
              text " "
            text " "
            TD (&93834802475672)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802476032)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Schlüsselgenerierungsdienst"
              BR (&93834802476512)
              text " "
            text " "
          text " "
          TR (&93834802477056)
            text " "
            TD (&93834802477360)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802477720)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SHA"
              BR (&93834802478200)
              text " "
            text " "
            TD (&93834802478624)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802478984)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Secure Hash Algorithm"
              BR (&93834802479464)
              text " "
            text " "
          text " "
          TR (&93834802480008)
            text " "
            TD (&93834802480312)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802480672)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SHA-256"
              BR (&93834802481152)
              text " "
            text " "
            TD (&93834802481576)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802481936)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "SHA mit 256 Bit Hashwert"
              BR (&93834802482416)
              text " "
            text " "
          text " "
          TR (&93834802482960)
            text " "
            TD (&93834802483264)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802483624)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "TI"
              BR (&93834802484104)
              text " "
            text " "
            TD (&93834802484528)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802484888)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Telematikinfrastruktur"
              BR (&93834802485368)
              text " "
            text " "
          text " "
          TR (&93834802485912)
            text " "
            TD (&93834802486216)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802486576)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "TIP"
              BR (&93834802487056)
              text " "
            text " "
            TD (&93834802487480)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802487840)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Telematikinfrastruktur-Plattform"
              BR (&93834802488320)
              text " "
            text " "
          text " "
          TR (&93834802488864)
            text " "
            TD (&93834802489168)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802489528)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "TLS"
              BR (&93834802490008)
              text " "
            text " "
            TD (&93834802490432)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802490792)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Transport Layer Security"
              BR (&93834802491272)
              text " "
            text " "
          text " "
          TR (&93834802491816)
            text " "
            TD (&93834802492120)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802492480)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "TSL"
              BR (&93834802492960)
              text " "
            text " "
            TD (&93834802493384)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802493744)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Trust-service Status List"
              BR (&93834802494224)
              text " "
            text " "
          text " "
          TR (&93834802494768)
            text " "
            TD (&93834802495072)
              attr style "vertical-align: top;width: 71pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802495432)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ZGdV"
              BR (&93834802495912)
              text " "
            text " "
            TD (&93834802496336)
              attr style "vertical-align: top;width: 365pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802496696)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Zugangsgateway des Versicherten"
              BR (&93834802497176)
              text " "
            text " "
          text " "
        text " "
      text " "
      H3 (&93834802497960)
        attr id "10.2"
        text "10.2 Glossar"
      text " "
      TABLE (&93834802498560)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=2"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834802499216)
          text " "
          TR (&93834802499520)
            text " "
            TH (&93834802499824)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 116pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802500184)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Begriff"
            text " "
            TH (&93834802500784)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 320pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834802501144)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Erläuterung"
            text " "
          text " "
          TR (&93834799048784)
            text " "
            TD (&93834799049088)
              attr style "vertical-align: top;width: 116pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799049424)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Schlüsselableitungsfunktionalität ePA"
              BR (&93834799049904)
              text " "
            text " "
            TD (&93834799050328)
              attr style "vertical-align: top;width: 320pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799050688)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Als Schlüsselableitungsfunktionalität wird die Gesamtheit des Ablaufs der Ver- und Entschlüsselung des Akten- und Kontextschlüssels durch einen Client verstanden. Dies beinhaltet als die parallele Anfrage an beide SGD."
            text " "
          text " "
        text " "
      text " "
      P (&93834799051648)
        attr id "polarion_77"
        text "Das Glossar wird als eigenständiges Dokument (vgl. [gemGlossar]) zur Verfügung gestellt."
      text " "
      H3 (&93834799052248)
        attr id "10.3"
        text "10.3 Abbildungsverzeichnis"
      text " "
      DIV (&93834799052848)
        attr data-sequence "Abbildung"
        attr id "polarion_wiki macro name=tof;params=uid=1"
      text " "
      DIV (&93834799053504)
        attr id "toc_container"
        text " "
        P (&93834799053984)
          attr class "toc_title"
        H1 (&93834799054344)
        P (&93834799054528)
        text " "
        LI (&93834799054832)
          A (&93834799055016)
            attr href "#polarion_27"
            text "Abbildung 1: Überblick Zwiebelschalenprinzip bei der Ver- und Entschlüsselung"
        text " "
        LI (&93834799055616)
          A (&93834799055800)
            attr href "#polarion_64"
            text "Abbildung 2: beteiligte Komponenten und Dienste im Kontext der Schlüsselableitungsfunktionalität ePA"
        text " "
        LI (&93834799056400)
          A (&93834799056584)
            attr href "#polarion_80"
            text "Abbildung 3: Initiale Schlüsselableitung für den Kontoinhaber"
        text " "
        LI (&93834799057184)
          A (&93834799057368)
            attr href "#polarion_87"
            text "Abbildung 4: Schlüsselableitung durch den Kontoinhaber"
        text " "
        LI (&93834799057968)
          A (&93834799058152)
            attr href "#polarion_90"
            text "Abbildung 5: Schlüsselableitung für einen Berechtigungsempfänger"
        text " "
        LI (&93834799058752)
          A (&93834799058936)
            attr href "#polarion_91"
            text "Abbildung 6: Schlüsselableitung durch einen Berechtigten"
        text " "
        LI (&93834799059536)
          A (&93834799059720)
            attr href "#polarion_92"
            text "Abbildung 7: Schlüsselableitung für einen Berechtigungsempfänger durch einen Vertreter"
        text " "
        LI (&93834799060320)
          A (&93834799060504)
            attr href "#polarion_96"
            text "Abbildung 8: Schlüsselableitung für einen durch einen Vertreter berechtigten Berechtigten"
        text " "
        LI (&93834799061104)
          A (&93834799061288)
            attr href "#polarion_123"
            text "Abbildung 9: Strukturelemente eines SGD"
        text " "
      text " "
      H3 (&93834799062008)
        attr id "10.4"
        text "10.4 Tabellenverzeichnis"
      text " "
      DIV (&93834799062608)
        attr data-sequence "Tabelle"
        attr id "polarion_wiki macro name=tof;params=uid=2"
      text " "
      DIV (&93834799063264)
        attr id "toc_container"
        text " "
        P (&93834799063744)
          attr class "toc_title"
        H1 (&93834799064104)
        P (&93834799064288)
        text " "
        LI (&93834799064592)
          A (&93834799064776)
            attr href "#polarion_51"
            text "Tabelle 1: beteiligte Akteure im Kontext Schlüsselableitungsfunktionalität"
        text " "
        LI (&93834799065376)
          A (&93834799065560)
            attr href "#polarion_258"
            text "Tabelle 2: beteiligte Komponenten und Dienste im Kontext Schlüsselableitungsfunktionalität"
        text " "
        LI (&93834799066160)
          A (&93834799066344)
            attr href "#polarion_71"
            text "Tabelle 3: Tab_Übersicht_der_Kommunikationsschritte_eines_SGD-Clients"
        text " "
        LI (&93834799066944)
          A (&93834799067128)
            attr href "#polarion_132"
            text "Tabelle 4: Tab_Kommandoabarbeitung_im_SGD-HSM"
        text " "
        LI (&93834799067728)
          A (&93834799067912)
            attr href "#polarion_133"
            text "Tabelle 5: Beispiel zu A_17894"
        text " "
        LI (&93834799068512)
          A (&93834799068696)
            attr href "#polarion_143"
            text "Tabelle 6: Beispiel zu A_17900"
        text " "
        LI (&93834799069296)
          A (&93834799069480)
            attr href "#polarion_145"
            text "Tabelle 7: Tab_GetPublicKey-Request"
        text " "
        LI (&93834799070080)
          A (&93834799070264)
            attr href "#polarion_150"
            text "Tabelle 8: Tab_GetAuthenticationToken-Request"
        text " "
        LI (&93834799070864)
          A (&93834799071048)
            attr href "#polarion_153"
            text "Tabelle 9: Tab_KeyDerivation-Request"
        text " "
        LI (&93834799071648)
          A (&93834799071832)
            attr href "#polarion_161"
            text "Tabelle 10: Tab_Fehlerfälle_und_Fehlermeldungen"
        text " "
        LI (&93834799072432)
          A (&93834799072616)
            attr href "#polarion_165"
            text "Tabelle 11: Tab_Austauschformat_Akten-_und_Kontextschlüssel"
        text " "
        LI (&93834799073216)
          A (&93834799073400)
            attr href "#polarion_168"
            text "Tabelle 12: Tab_erste_Verschlüsselungsschicht"
        text " "
      text " "
      H3 (&93834799074120)
        attr id "10.5"
        text "10.5 Referenzierte Dokumente"
      text " "
      H4 (&93834799074720)
        attr id "10.5.1"
        text "10.5.1 – Dokumente der gematik"
      text " "
      P (&93834799075320)
        attr id "polarion_82"
        text "Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur. Der mit der vorliegenden Version korrelierende Entwicklungsstand dieser Konzepte und Spezifikationen wird pro Release in einer Dokumentenlandkarte definiert; Version und Stand der referenzierten Dokumente sind daher in der nachfolgenden Tabelle nicht aufgeführt. Deren zu diesem Dokument jeweils gültige Versionsnummer entnehmen Sie der aktuellen, von der gematik veröffentlichten Dokumentenlandkarte, in der die vorliegende Version aufgeführt wird."
      text " "
      P (&93834799075920)
        attr id "polarion_83"
      text " "
      TABLE (&93834799076400)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=3"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834799077056)
          text " "
          TR (&93834799077360)
            text " "
            TH (&93834799077664)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 206px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799078024)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "[Quelle]"
              text " "
            text " "
            TH (&93834799078744)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 521px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799079104)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Herausgeber: Titel"
            text " "
          text " "
          TR (&93834799079824)
            text " "
            TD (&93834799080128)
              attr style "vertical-align: top;width: 206px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799080488)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_DS_Anbieter]"
              BR (&93834799080968)
              text " "
            text " "
            TD (&93834799081448)
              attr style "vertical-align: top;width: 521px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799081784)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Spezifikation Datenschutz- und Sicherheitsanforderungen der TI an Anbieter"
              BR (&93834799082264)
              text " "
            text " "
          text " "
          TR (&93834799082808)
            text " "
            TD (&93834799083112)
              attr style "vertical-align: top;width: 206px;height: 0px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799083472)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemGlossar]"
              BR (&93834799083952)
              text " "
            text " "
            TD (&93834799084376)
              attr style "vertical-align: top;width: 521px;height: 0px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799084736)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Glossar der Telematikinfrastruktur"
              BR (&93834799085216)
              text " "
            text " "
          text " "
          TR (&93834799085760)
            text " "
            TD (&93834799086064)
              attr style "vertical-align: top;width: 206px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799086424)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_Krypt]"
              BR (&93834799086904)
              text " "
            text " "
            TD (&93834799087328)
              attr style "vertical-align: top;width: 521px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799087688)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Übergreifende Spezifikation, Verwendung kryptographischer Algorithmen in der Telematikinfrastruktur"
              BR (&93834799088168)
              text " "
            text " "
          text " "
          TR (&93834799088712)
            text " "
            TD (&93834799089016)
              attr style "vertical-align: top;width: 206px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799089376)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_OID]"
              BR (&93834799089856)
              text " "
            text " "
            TD (&93834799090280)
              attr style "vertical-align: top;width: 521px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799090640)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Spezifikation Festlegung von OIDs"
              BR (&93834799091120)
              text " "
            text " "
          text " "
          TR (&93834799091664)
            text " "
            TD (&93834799091968)
              attr style "vertical-align: top;width: 206px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799092328)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_Perf]"
              BR (&93834799092808)
              text " "
            text " "
            TD (&93834799093232)
              attr style "vertical-align: top;width: 521px;height: 7px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799093592)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Übergreifende Spezifikation, Performance und Mengengerüst TI-Plattform"
              BR (&93834799094072)
              text " "
            text " "
          text " "
          TR (&93834799094616)
            text " "
            TD (&93834799094920)
              attr style "vertical-align: top;width: 206px;height: 3px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799095280)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_PKI]"
              BR (&93834799095760)
              text " "
            text " "
            TD (&93834799096184)
              attr style "vertical-align: top;width: 521px;height: 3px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799096544)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Übergreifende Spezifikation, Spezifikation PKI"
              BR (&93834799097024)
              text " "
            text " "
          text " "
          TR (&93834799097568)
            text " "
            TD (&93834799097872)
              attr style "vertical-align: top;width: 206px;height: 8px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799098232)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_Zugangsgateway_Vers]"
              BR (&93834799098712)
              text " "
            text " "
            TD (&93834799099136)
              attr style "vertical-align: top;width: 521px;height: 8px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799099496)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Spezifikation Zugangsgateway des Versicherten ePA"
              BR (&93834799099976)
              text " "
            text " "
          text " "
          TR (&93834799100520)
            text " "
            TD (&93834799100824)
              attr style "vertical-align: top;width: 206px;height: 10px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799101184)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[gemSpec_X.509_TSP]"
              BR (&93834799101664)
              text " "
            text " "
            TD (&93834799102088)
              attr style "vertical-align: top;width: 521px;height: 10px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799102448)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "gematik: Spezifikation Trust Service Provider X.509"
              BR (&93834799102928)
              text " "
            text " "
          text " "
        text " "
      text " "
      H4 (&93834799103712)
        attr id "10.5.2"
        text "10.5.2 – Weitere Dokumente"
      text " "
      TABLE (&93834799104312)
        attr id "polarion_wiki macro name=table;params=width=100%|uid=4"
        attr style "width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"
        text " "
        TBODY (&93834799104968)
          text " "
          TR (&93834799105272)
            text " "
            TH (&93834799105576)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799105936)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "[Quelle]"
            text " "
            TH (&93834799106536)
              attr style "background-color: #F0F0F0;text-align: left;vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799106896)
                attr style "font-weight: bold;font-size: 10pt;line-height: 1.5;"
                text "Herausgeber (Erscheinungsdatum): Titel"
            text " "
          text " "
          TR (&93834799107616)
            text " "
            TD (&93834799107920)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799108280)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[ABR-1999]"
            text " "
            TD (&93834799108880)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799109240)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "DHIES: An Encryption Scheme Based on the Diffie–Hellman Problem"
                BR (&93834799109720)
                text " "
                SPAN (&93834799110024)
                  attr style "color: #222222;"
                  text "Abdalla, Michel and Bellare, Mihir and Rogaway, Phillip, 1999"
                BR (&93834799110504)
                text " "
                A (&93834799110808)
                  attr class "descriptionLink"
                  attr href "http://web.cs.ucdavis.edu/~rogaway/papers/dhies.pdf"
                  attr target "_blank"
                  text "http://web.cs.ucdavis.edu/~rogaway/papers/dhies.pdf"
                text " "
            text " "
          text " "
          TR (&93834799112000)
            text " "
            TD (&93834799112304)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799112664)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[Boyd-Mathuria-2003]"
                BR (&93834799113144)
                text " "
            text " "
            TD (&93834799113568)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799113928)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Protocols for Authentication and Key Establishment, Colin Boyd and Anish Mathuria, 2003"
                BR (&93834799114504)
                text " "
            text " "
          text " "
          TR (&93834799115048)
            text " "
            TD (&93834799115352)
              attr style "vertical-align: top;width: 164px;height: 75px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799115712)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[BSI-TR-02102-1]"
            text " "
            TD (&93834799116312)
              attr style "vertical-align: top;width: 563px;height: 75px;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799116672)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "BSI TR-02102-1 Technische Richtlinie „Kryptographische Verfahren:"
                BR (&93834799117152)
                text "Empfehlungen und Schlüssellängen“"
                BR (&93834799117456)
                text "Version 2019-01, Stand 22.02.2019"
                BR (&93834799117760)
                text " "
                A (&93834799118064)
                  attr class "descriptionLink"
                  attr href "https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr02102/index_htm.html"
                  attr target "_blank"
                  text "https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr02102/index_htm.html"
                BR (&93834799118896)
                text " "
            text " "
          text " "
          TR (&93834799119440)
            text " "
            TD (&93834799119744)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799120104)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[ETSI_TS_102_231_v3.1.2]"
            text " "
            TD (&93834799120704)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799121064)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "ETSI (Dezember 2009): ETSI Technical Specification TS 102 231 (‘Provision of harmonized Trust Service Provider (TSP) status information’) – Version 3.1.2"
            text " "
          text " "
          TR (&93834799121784)
            text " "
            TD (&93834799122088)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799122448)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[FIPS-140-2]"
            text " "
            TD (&93834799123048)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799123408)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "NIST: Security Requirements for Cryptographic Modules, May 25, 2001 (Change Notice 2, 12/3/2002),"
                A (&93834799123888)
                  attr class "descriptionLink"
                  attr href "https://csrc.nist.gov/publications/detail/fips/140/2/final"
                  attr target "_blank"
                  text "https://csrc.nist.gov/publications/detail/fips/140/2/final"
                text " "
            text " "
          text " "
          TR (&93834799125080)
            text " "
            TD (&93834799125384)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799125744)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[NIST-SP-800-38D]"
            text " "
            TD (&93834799126344)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799126704)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "NIST SP 800-38D, Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC, November 2007"
                BR (&93834799127184)
                text " "
                A (&93834799127488)
                  attr class "descriptionLink"
                  attr href "https://csrc.nist.gov/publications/detail/sp/800-38d/final"
                  attr target "_blank"
                  text "https://csrc.nist.gov/publications/detail/sp/800-38d/final"
            text " "
          text " "
          TR (&93834799128560)
            text " "
            TD (&93834799128864)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799129224)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[PCRE]"
            text " "
            TD (&93834799129824)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799130184)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "PCRE - Perl Compatible Regular Expressions, "
                A (&93834799130664)
                  attr class "descriptionLink"
                  attr href "https://www.pcre.org/"
                  attr target "_blank"
                  text "https://www.pcre.org/"
                text " "
            text " "
          text " "
          TR (&93834799131856)
            text " "
            TD (&93834799132160)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799132520)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[RFC-5116]"
            text " "
            TD (&93834799133120)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799133480)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "RFC-5116: An Interface and Algorithms for Authenticated Encryption, January 2008, "
                BR (&93834799133960)
                text " "
                A (&93834799134264)
                  attr class "descriptionLink"
                  attr href "https://tools.ietf.org/html/rfc5116"
                  attr target "_blank"
                  text "https://tools.ietf.org/html/rfc5116"
                text " "
            text " "
          text " "
          TR (&93834799135456)
            text " "
            TD (&93834799135760)
              attr style "vertical-align: top;width: 164px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799136120)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "[SEC1-2009]"
            text " "
            TD (&93834799136720)
              attr style "vertical-align: top;width: 563px;height: 14pt;border: 1px solid #CCCCCC;padding: 4pt;"
              SPAN (&93834799137080)
                attr style "font-size: 10pt;line-height: 1.5;"
                text "Standards for Efficient Cryptography, SEC 1: Elliptic Curve Cryptography, Certicom Research, Contact: Daniel R. L. Brown (dbrown@certicom.com), May 21, 2009, Version 2.0"
                BR (&93834799137560)
                text " "
                A (&93834799137864)
                  attr class "descriptionLink"
                  attr href "https://www.secg.org/sec1-v2.pdf"
                  attr target "_blank"
                  text "https://www.secg.org/sec1-v2.pdf"
                text " "
            text " "
          text " "
        text " "
      text " "
      P (&93834799139296)
        attr id "polarion_89"
      text " "


   ====================
   ATTRIBUTE STATISTICS
   ====================

   charset:: utf-8
   class:: MsoNormal; descriptionLink; polarion-Document-table; polarion-dle-wiki-block; polarion-dle-wiki-block-source; polarion-rte-caption; polarion-rte-caption-paragraph; polarion-rte-link; toc_title
   content::  charset=UTF-8; HTML Tidy for Java (vers. 26 Sep 2004), see www.w3.org; text/html
   contenteditable:: false
   data-custom-label:: A17910-01; A_17694; A_17846-01; A_17847; A_17848; A_17872; A_17873; A_17874; A_17875; A_17876; A_17881; A_17884; A_17889; A_17891; A_17892; A_17893; A_17894-01; A_17896; A_17897; A_17898; A_17898 (KeyDerivation); A_17898, Tab_KeyDerivation-Request; A_17900; A_17901; A_17902; A_17903; A_17907; A_17908-01; A_17910-01; A_17912-01; A_17914-01; A_17915-01; A_17916; A_17917; A_17918-01; A_17919-01; A_17920-02; A_17922; A_17924-01; A_17925; A_17926; A_17930; A_17952-01; A_17953; A_17965; A_18003; A_18021; A_18023; A_18024; A_18025; A_18027; A_18028; A_18029; A_18030; A_18031-01; A_18032; A_18987; A_18988; A_19000; GetPublicKey; KeyDerivation; RVE; SGD-HSM – Schlüsselgenerierungsdienst-HSM; TIP1-A_3894; Telematik-ID; [gemKPT_Arch_TIP#4.7 Langfristige Verschlüsselung]; [gemSpec_Krypt#A_17872]; [gemSpec_Krypt#A_17874]; [gemSpec_Krypt#A_17876]; [gemSpec_PKI#A_17700]; [gemSpec_Perf#Produkttyp Schlüsselgenerierungsdienst]; [gemSpec_Zugangsgateway_Vers#A_17495]; [gemSpec_Zugangsgateway_Vers#Proxy Schlüsselgenerierungsdienst]
   data-item-id:: ML-102143; ML-102144; ML-102181; ML-102756; ML-102757; ML-109357; ML-109359; ML-109378; ML-109449; ML-109450; ML-109454; ML-109456; ML-109457; ML-109458; ML-109460; ML-92802; ML-93580; ML-93990; ML-94070; ML-94489; ML-94490; ML-94491; ML-94492; ML-94493; ML-94494; ML-94496; ML-94498; ML-94516; ML-94519; ML-94533; ML-94534; ML-94553; ML-94563; ML-94567; ML-94577; ML-94583; ML-94621; ML-94622; ML-94626; ML-94679; ML-94682; ML-94687; ML-94689; ML-94690; ML-94691; ML-94694; ML-94695; ML-94696; ML-94700; ML-94701; ML-94702; ML-94703; ML-94707; ML-94708; ML-94716; ML-94719; ML-94727; ML-94728; ML-94729; ML-94737; ML-94738; ML-94739; ML-94741; ML-94770; ML-94787; ML-94790; ML-94843; ML-95024; ML-96275; ML-96277; ML-96280; ML-96284; ML-96285; ML-96286; ML-96287; ML-96291
   data-keep-next:: true
   data-option-id:: custom; longoutline; shortoutline
   data-scope:: Mainline_OPB1
   data-sequence:: Abbildung; Tabelle
   data-type:: crossReference; polarion; workItem
   http-equiv:: Content-Type
   linkid:: 189
   name:: generator
   style:background-color: #F0F0F0; #FFFF99
   style:border: 1px solid #CCCCCC
   style:border-bottom: 1px solid #CCCCCC
   style:border-collapse: collapse
   style:border-left: 1px solid #CCCCCC
   style:border-right: 1px solid #CCCCCC
   style:border-top: 1px solid #CCCCCC
   style:color: #0000FF; #202020; #222222
   style:empty-cells: show
   style:font-family: 'Courier New', Courier, monospace, HanWangKanTan; Arial, Helvetica
   style:font-size: 10pt; 11pt; 12pt; 28pt; 9pt
   style:font-style: italic
   style:font-weight: bold
   style:height: 0px; 102pt; 10px; 117.111px; 121.556px; 125px; 12pt; 14pt; 15pt; 16pt; 174.889px; 174px; 178.444px; 18.4444px; 194px; 198.889px; 217px; 26px; 29pt; 29px; 317px; 33px; 37.1111px; 380px; 38pt; 3px; 453px; 503px; 50px; 552px; 560px; 574px; 628px; 62px; 642px; 668px; 69pt; 73px; 75px; 7px; 83pt; 8px; 92px; 96.6667px; 9pt
   style:line-height: 1.2; 1.5
   style:margin-left: 40px; auto
   style:margin-right: auto
   style:padding: 2px; 4pt; 5px
   style:text-align: center; left
   style:text-decoration: line-through; underline
   style:vertical-align: top
   style:width: 100%; 116pt; 146px; 164px; 17px; 195px; 206px; 208px; 210px; 215px; 226px; 229px; 250px; 260px; 280pt; 320pt; 32px; 330px; 365pt; 400px; 404px; 426px; 44pt; 512px; 517px; 521px; 53pt; 563px; 582px; 60px; 70pt; 71pt; 742px; 748px; 77pt
   target:: _blank; _top


   ================
   CHILD STATISTICS
   ================

   A
    _TEXT: 97 (&93834803301632)
   B
    _TEXT: 170 (&93834810831264)
   BODY
    DIV: 92 (&93834802619024)
    H1: 2 (&93834802630432)
    H2: 10 (&93834802394424)
    H3: 43 (&93834802395024)
    H4: 12 (&93834783654256)
    OL: 10 (&93834802418304)
    P: 336 (&93834802603752)
    TABLE: 20 (&93834775008104)
    UL: 3 (&93834802407888)
   DIV
    B: 28 (&93834783663376)
    BR: 49 (&93834772287464)
    DIV: 1 (&93834802619680)
    H1: 3 (&93834803300600)
    LI: 88 (&93834803301088)
    OL: 30 (&93834783657152)
    P: 205 (&93834803300240)
    PRE: 1 (&93834802620336)
    SPAN: 27 (&93834783662896)
    _TEXT: 60 (&93834783662776)
   H1
    _TEXT: 2 (&93834802630792)
   H2
    _TEXT: 10 (&93834802394784)
   H3
    _TEXT: 43 (&93834802395384)
   H4
    _TEXT: 12 (&93834783654616)
   HEAD
    META: 1 (&93834802602848)
    STYLE: 1 (&93834802602416)
   HTML
    BODY: 1 (&93834802603448)
    HEAD: 1 (&93834802602112)
   LI
    A: 88 (&93834803301272)
    BR: 21 (&93834810824752)
    SPAN: 66 (&93834775379544)
    _TEXT: 276 (&93834803302840)
   OL
    LI: 138 (&93834802418784)
   P
    A: 2 (&93834768821616)
    B: 142 (&93834810831080)
    BR: 159 (&93834802604232)
    IMG: 9 (&93834775382824)
    META: 2 (&93834803138432)
    SPAN: 350 (&93834802607848)
    TITLE: 1 (&93834803139624)
    _TEXT: 597 (&93834802632592)
   PRE
    TABLE: 1 (&93834802621168)
   SPAN
    A: 7 (&93834799110808)
    BR: 243 (&93834775404792)
    SPAN: 154 (&93834811837128)
    _TEXT: 824 (&93834802608208)
   STYLE
    _TEXT: 1 (&93834802602608)
   TABLE
    TBODY: 21 (&93834802621472)
   TBODY
    TR: 145 (&93834802621656)
   TD
    BR: 168 (&93834776400664)
    DIV: 1 (&93834776423352)
    SPAN: 288 (&93834775396320)
    _TEXT: 65 (&93834802622144)
   TH
    BR: 7 (&93834774919704)
    SPAN: 30 (&93834775393976)
    _TEXT: 6 (&93834775009728)
   THEAD
   TR
    TD: 353 (&93834802621960)
    TH: 36 (&93834775009368)
   UL
    LI: 9 (&93834802408368)
   _DOCUMENT
    HTML: 1 (&93834802601928)

   --> consistency checked.


   ===============
   NODE STATISTICS
   ===============

   P       title nodes:       2
   DIV     toc nodes:         3
   TR      meta data nodes:   6
   H1..H6  header nodes:      67
   DIV/TR  requirement nodes: 0
   IMG     image nodes:       9
   TABLE   table nodes:       12


